<!-- Written by Paul Clevett -->
<!-- (C)Copyright Wolf Software Systems Ltd -->
<!-- https://wolf.uk.com -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WolfStack ‚Äî Server Management</title>
    <meta name="description" content="WolfStack server management dashboard for the Wolf software suite">
    <link rel="icon" type="image/svg+xml" href="https://wolf.uk.com/wp-content/uploads/2026/01/Group-9.svg">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/xterm.min.css">
    <script src="/js/vendor/xterm.min.js"></script>
    <script src="/js/vendor/xterm-addon-fit.min.js"></script>
    <style>
        /* Map Styles */
        #world-map {
            background: var(--bg-card);
            border: 1px solid var(--border);
            z-index: 1;
        }

        .leaflet-container {
            background: var(--bg-card) !important;
            font-family: 'Inter', sans-serif;
        }

        .leaflet-popup-content-wrapper,
        .leaflet-popup-tip {
            background: var(--bg-secondary) !important;
            color: var(--text-primary) !important;
            box-shadow: var(--shadow-md) !important;
            border: 1px solid var(--border);
        }

        .leaflet-popup-close-button {
            color: var(--text-muted) !important;
        }
    </style>
</head>

<body>
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
        <div class="sidebar-logo">
            <div class="logo-icon"><img src="https://wolf.uk.com/wp-content/uploads/2026/01/Group-9.svg" alt="Wolf"
                    style="width:36px;height:36px;"></div>
            <div>
                <h1>WolfStack</h1>
                <span class="version">v10.1.0</span>
            </div>
        </div>
        <nav class="sidebar-nav">
            <div class="nav-section" style="display:flex; gap:4px; padding:8px 12px; justify-content:center;">
                <a class="nav-item active" data-page="datacenter" onclick="selectView('datacenter')" title="Datacenter"
                    style="display:flex;align-items:center;justify-content:center;width:40px;height:40px;padding:0;border-radius:10px;">
                    <span class="icon" style="margin:0;font-size:20px;">üè†</span>
                </a>
                <a class="nav-item" data-page="appstore" onclick="selectView('appstore')" title="App Store"
                    style="display:flex;align-items:center;justify-content:center;width:40px;height:40px;padding:0;border-radius:10px;">
                    <span class="icon" style="margin:0;font-size:20px;">üõçÔ∏è</span>
                </a>
                <a class="nav-item" data-page="issues" onclick="selectView('issues')" title="Issues"
                    style="display:flex;align-items:center;justify-content:center;width:40px;height:40px;padding:0;border-radius:10px;">
                    <span class="icon" style="margin:0;font-size:20px;">‚ö†Ô∏è</span>
                </a>
                <a class="nav-item" data-page="global-wolfnet" onclick="selectView('global-wolfnet')"
                    title="Global WolfNet"
                    style="display:flex;align-items:center;justify-content:center;width:40px;height:40px;padding:0;border-radius:10px;">
                    <span class="icon" style="margin:0;font-size:20px;">üåê</span>
                </a>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">Servers</div>
                <input type="text" id="sidebar-node-search" placeholder="üîç Search nodes..."
                    oninput="filterSidebarNodes()" style="
                    width: calc(100% - 24px); margin: 0 12px 8px; padding: 6px 10px;
                    background: rgba(220,38,38,0.06); border: 1px solid rgba(220,38,38,0.2);
                    border-radius: 6px; color: var(--text); font-size: 12px;
                    outline: none; font-family: inherit; transition: all 0.2s ease;
                " onfocus="this.style.borderColor='rgba(220,38,38,0.5)';this.style.boxShadow='0 0 8px rgba(220,38,38,0.15)';this.style.background='rgba(220,38,38,0.1)'"
                    onblur="this.style.borderColor='rgba(220,38,38,0.2)';this.style.boxShadow='none';this.style.background='rgba(220,38,38,0.06)'">
                <div id="server-tree">
                    <div style="padding: 8px 16px; color: var(--text-muted); font-size: 12px;">Loading...</div>
                </div>
            </div>
        </nav>
        <div class="sidebar-footer">
            <div id="update-banner" style="display:none;margin-bottom:8px;padding:8px 12px;border-radius:8px;
                 background:rgba(234,179,8,0.15);border:1px solid rgba(234,179,8,0.3);font-size:12px;
                 color:var(--text);text-align:center;cursor:pointer;" onclick="triggerUpgrade()">
                üîî <span id="update-banner-text">Update available</span>
            </div>
            <div class="sidebar-icon-buttons">
                <button class="btn btn-icon" onclick="selectView('settings')" title="Settings">‚öôÔ∏è</button>
                <button class="btn btn-icon" onclick="window.open('https://wolfscale.org', '_blank')"
                    title="Help & Docs">‚ùì</button>
                <button class="btn btn-icon" onclick="openAddServerModal()" title="Add Server">‚ûï</button>
                <button class="btn btn-icon" onclick="handleLogout()" title="Sign Out">üö™</button>
            </div>
            <div class="copyright">
                &copy; 2026 <a href="https://wolf.uk.com/" target="_blank" rel="noopener">Wolf Software Systems Ltd</a>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Top Bar -->
        <header class="top-bar">
            <h2 id="page-title">Dashboard</h2>
            <div class="top-bar-actions" style="display:flex; align-items:center; gap:12px;">
                <span id="hostname-display" style="color: var(--text-secondary); font-size: 13px;"></span>
                <div style="display:flex; gap:8px; align-items:center; margin-left:8px;">
                    <a href="https://www.youtube.com/@wolfsoftwaresystems" target="_blank" rel="noopener"
                        title="YouTube"
                        style="display:flex;align-items:center;justify-content:center;width:30px;height:30px;border-radius:6px;background:rgba(255,0,0,0.1);color:#ff0000;transition:all 0.2s ease;text-decoration:none;"
                        onmouseover="this.style.background='rgba(255,0,0,0.25)';this.style.transform='scale(1.1)'"
                        onmouseout="this.style.background='rgba(255,0,0,0.1)';this.style.transform='scale(1)'">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M23.5 6.2a3 3 0 0 0-2.1-2.1C19.5 3.5 12 3.5 12 3.5s-7.5 0-9.4.6A3 3 0 0 0 .5 6.2 31.4 31.4 0 0 0 0 12a31.4 31.4 0 0 0 .5 5.8 3 3 0 0 0 2.1 2.1c1.9.6 9.4.6 9.4.6s7.5 0 9.4-.6a3 3 0 0 0 2.1-2.1A31.4 31.4 0 0 0 24 12a31.4 31.4 0 0 0-.5-5.8zM9.6 15.6V8.4l6.3 3.6-6.3 3.6z" />
                        </svg>
                    </a>
                    <a href="https://discord.gg/q9qMjHjUQY" target="_blank" rel="noopener" title="Discord"
                        style="display:flex;align-items:center;justify-content:center;width:30px;height:30px;border-radius:6px;background:rgba(88,101,242,0.1);color:#5865f2;transition:all 0.2s ease;text-decoration:none;"
                        onmouseover="this.style.background='rgba(88,101,242,0.25)';this.style.transform='scale(1.1)'"
                        onmouseout="this.style.background='rgba(88,101,242,0.1)';this.style.transform='scale(1)'">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M20.3 4.4A19.6 19.6 0 0 0 15.5 3a14 14 0 0 0-.6 1.3 18.3 18.3 0 0 0-5.8 0A13.5 13.5 0 0 0 8.5 3 19.5 19.5 0 0 0 3.7 4.4 20.7 20.7 0 0 0 .2 17.7a19.7 19.7 0 0 0 6 3 14.6 14.6 0 0 0 1.3-2 12.7 12.7 0 0 1-2-.9l.5-.4a14 14 0 0 0 12 0l.5.4a12.9 12.9 0 0 1-2 .9 14.5 14.5 0 0 0 1.3 2 19.6 19.6 0 0 0 6-3A20.6 20.6 0 0 0 20.3 4.4zM8 15c-1.2 0-2.1-1-2.1-2.3S6.9 10.4 8 10.4s2.2 1 2.1 2.3S9.2 15 8 15zm8 0c-1.2 0-2.1-1-2.1-2.3s.9-2.3 2.1-2.3 2.2 1 2.1 2.3-.9 2.3-2.1 2.3z" />
                        </svg>
                    </a>
                    <a href="https://www.patreon.com/15362110/join" target="_blank" rel="noopener" title="Patreon"
                        style="display:flex;align-items:center;justify-content:center;width:30px;height:30px;border-radius:6px;background:rgba(255,66,77,0.1);color:#ff424d;transition:all 0.2s ease;text-decoration:none;"
                        onmouseover="this.style.background='rgba(255,66,77,0.25)';this.style.transform='scale(1.1)'"
                        onmouseout="this.style.background='rgba(255,66,77,0.1)';this.style.transform='scale(1)'">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15.4.5a8.6 8.6 0 1 0 0 17.2 8.6 8.6 0 0 0 0-17.2zM.5.5h3.4v23H.5z" />
                        </svg>
                    </a>
                    <a href="https://www.reddit.com/r/WolfStack/" target="_blank" rel="noopener" title="Reddit"
                        style="display:flex;align-items:center;justify-content:center;width:30px;height:30px;border-radius:6px;background:rgba(255,69,0,0.1);color:#ff4500;transition:all 0.2s ease;text-decoration:none;"
                        onmouseover="this.style.background='rgba(255,69,0,0.25)';this.style.transform='scale(1.1)'"
                        onmouseout="this.style.background='rgba(255,69,0,0.1)';this.style.transform='scale(1)'">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.74c.69 0 1.25.56 1.25 1.25a1.25 1.25 0 0 1-2.5 0c0-.69.56-1.25 1.25-1.25zM12 6.25c1.67 0 3.19.44 4.42 1.18a1.87 1.87 0 0 1 2.78 1.63c0 .7-.38 1.3-.95 1.63.03.18.05.36.05.55 0 2.81-3.27 5.09-7.3 5.09s-7.3-2.28-7.3-5.09c0-.19.02-.37.04-.55a1.87 1.87 0 0 1-.94-1.63c0-1.04.84-1.88 1.88-1.88.5 0 .95.19 1.29.51A10.22 10.22 0 0 1 12 6.25zM8.5 11.5a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5zm7 0a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5zm-6.47 3.82a.31.31 0 0 1 .44 0c.71.71 1.93 1.05 2.53 1.05.6 0 1.82-.34 2.53-1.05a.31.31 0 0 1 .44.44c-.84.84-2.2 1.23-2.97 1.23-.77 0-2.13-.39-2.97-1.23a.31.31 0 0 1 0-.44z" />
                        </svg>
                    </a>
                </div>
            </div>
        </header>

        <!-- Page Content -->
        <div class="page-content">
            <!-- ‚ïê‚ïê‚ïê Datacenter Overview ‚ïê‚ïê‚ïê -->
            <div id="page-datacenter" class="page-view">

                <!-- World Map -->
                <div class="card" style="margin-bottom: 24px; overflow: hidden;">
                    <div class="card-header">
                        <h3>üåç Global Infrastructure</h3>
                        <div style="font-size: 12px; color: var(--text-muted);">Live Server Locations</div>
                    </div>
                    <div id="world-map" style="height: 380px; width: 100%; border: none; border-radius: 0;"></div>
                </div>

                <div class="stats-grid" style="margin-bottom: 20px;">
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Total Servers</span>
                            <div class="stat-icon" style="background: var(--accent-glow); color: var(--accent-light);">
                                üñ•Ô∏è</div>
                        </div>
                        <div class="stat-value" id="dc-total-servers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Online</span>
                            <div class="stat-icon" style="background: var(--success-bg); color: var(--success);">‚úì</div>
                        </div>
                        <div class="stat-value" id="dc-online-servers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Offline</span>
                            <div class="stat-icon" style="background: var(--danger-bg); color: var(--danger);">‚úó</div>
                        </div>
                        <div class="stat-value" id="dc-offline-servers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Components</span>
                            <div class="stat-icon" style="background: var(--info-bg); color: var(--info);">üì¶</div>
                        </div>
                        <div class="stat-value" id="dc-total-components">0</div>
                    </div>
                </div>

                <!-- Server cards grid -->
                <div id="datacenter-servers" class="grid-2" style="gap: 20px;"></div>
            </div>

            <!-- ‚ïê‚ïê‚ïê Dashboard Page (per-server) ‚ïê‚ïê‚ïê -->
            <div id="page-dashboard" class="page-view" style="display:none;">

                <!-- System Details (Neofetch) -->
                <div class="card"
                    style="margin-bottom: 24px; background: linear-gradient(145deg, var(--card-bg), var(--bg-secondary)); border: 1px solid var(--border-color);">
                    <div style="display: flex; gap: 40px; align-items: flex-start; flex-wrap: wrap;">
                        <!-- Logo (ASCII-ish) -->
                        <!-- Logo (Text) -->
                        <div
                            style="flex-shrink: 0; display: flex; flex-direction: column; align-items: flex-start; justify-content: center; padding-right: 20px;">
                            <h1
                                style="color: var(--success); margin: 0; font-size: 32px; font-weight: 800; letter-spacing: -1px; line-height: 1; font-family: 'Inter', sans-serif;">
                                WolfStack</h1>
                            <div
                                style="color: var(--success); font-size: 16px; font-weight: 600; margin-top: 6px; opacity: 0.9; letter-spacing: 0.5px;">
                                v6.2.0</div>
                        </div>

                        <!-- Details -->
                        <div
                            style="flex-grow: 1; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;">
                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">os</span>
                                    <span id="neo-os" style="color: var(--text-primary);">...</span>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">host</span>
                                    <span id="neo-host" style="color: var(--text-primary);">...</span>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">kernel</span>
                                    <span id="neo-kernel" style="color: var(--text-primary);">...</span>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">uptime</span>
                                    <span id="neo-uptime" style="color: var(--text-primary);">...</span>
                                </div>
                            </div>

                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">cpu</span>
                                    <span id="neo-cpu"
                                        style="color: var(--text-primary); text-align: right; word-break: break-word;">...</span>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">memory</span>
                                    <span id="neo-memory" style="color: var(--text-primary);">...</span>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">shell</span>
                                    <span id="neo-shell" style="color: var(--text-primary);">wolf-agent</span>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">public ip</span>
                                    <span id="neo-ip" style="color: var(--text-primary);">...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Server Header -->
                <div class="card"
                    style="margin-bottom: 24px; background: linear-gradient(135deg, rgba(26,31,53,0.9), rgba(13,18,37,0.95)); border-color: var(--border-light);">
                    <div class="card-body"
                        style="display: flex; align-items: center; justify-content: space-between; padding: 24px 32px;">
                        <div style="display: flex; align-items: center; gap: 20px;">
                            <div
                                style="width: 64px; height: 64px; background: var(--gradient-main); border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 32px; box-shadow: var(--shadow-glow);">
                                üñ•Ô∏è
                            </div>
                            <div>
                                <h2 style="font-size: 24px; margin-bottom: 4px; color: var(--text-primary); font-weight: 700;"
                                    id="server-header-hostname">Server</h2>
                                <div style="display: flex; gap: 16px; font-size: 13px; color: var(--text-secondary);">
                                    <span id="server-header-ip">127.0.0.1</span>
                                    <span>‚Ä¢</span>
                                    <span id="server-header-os">Linux</span>
                                    <span>‚Ä¢</span>
                                    <span id="server-header-uptime">Up: ‚Äî</span>
                                </div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 12px;">
                            <button class="btn btn-primary" onclick="selectView('terminal')">
                                <span class="icon">üíª</span> Terminal
                            </button>
                            <button class="btn" onclick="location.reload()">
                                <span class="icon">üîÑ</span> Refresh
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Main Metrics Grid -->
                <div class="grid-2" style="margin-bottom: 24px;">
                    <!-- CPU Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3>CPU Usage</h3>
                            <div class="stat-icon" style="background: var(--accent-glow); color: var(--accent-light);">‚ö°
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="display: flex; align-items: baseline; gap: 8px; margin-bottom: 8px;">
                                <div class="stat-value" id="cpu-value">‚Äî</div>
                                <div class="stat-sub" style="font-size: 14px;">Total Load</div>
                            </div>
                            <div class="progress-bar" style="height: 12px; margin-bottom: 16px;">
                                <div class="fill accent" id="cpu-bar" style="width: 0%"></div>
                            </div>
                            <div
                                style="font-size: 12px; color: var(--text-muted); padding-top: 12px; border-top: 1px solid var(--border);">
                                <span id="cpu-model">Unknown CPU</span>
                            </div>
                        </div>
                    </div>

                    <!-- Memory Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3>Memory Usage</h3>
                            <div class="stat-icon" style="background: var(--success-bg); color: var(--success);">üß†
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="display: flex; align-items: baseline; gap: 8px; margin-bottom: 8px;">
                                <div class="stat-value" id="mem-value">‚Äî</div>
                                <div class="stat-sub" style="font-size: 14px;">Used</div>
                            </div>
                            <div class="progress-bar" style="height: 12px; margin-bottom: 16px;">
                                <div class="fill success" id="mem-bar" style="width: 0%"></div>
                            </div>
                            <div
                                style="font-size: 12px; color: var(--text-muted); padding-top: 12px; border-top: 1px solid var(--border);">
                                <span id="mem-detail">‚Äî / ‚Äî</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid-2" style="margin-bottom: 24px;">
                    <!-- Disk Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3>Disk Usage (Root)</h3>
                            <div class="stat-icon" style="background: var(--warning-bg); color: var(--warning);">üíæ
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="display: flex; align-items: baseline; gap: 8px; margin-bottom: 8px;">
                                <div class="stat-value" id="disk-value">‚Äî</div>
                                <div class="stat-sub" style="font-size: 14px;">Used</div>
                            </div>
                            <div class="progress-bar" style="height: 12px; margin-bottom: 16px;">
                                <div class="fill warning" id="disk-bar" style="width: 0%"></div>
                            </div>
                            <div
                                style="font-size: 12px; color: var(--text-muted); padding-top: 12px; border-top: 1px solid var(--border);">
                                <span id="disk-detail">‚Äî / ‚Äî</span>
                            </div>
                        </div>
                    </div>

                    <!-- Network Card (No Bar) -->
                    <div class="card">
                        <div class="card-header">
                            <h3>Network Traffic</h3>
                            <div class="stat-icon" style="background: var(--info-bg); color: var(--info);">üåê</div>
                        </div>
                        <div class="card-body">
                            <div style="display: flex; align-items: baseline; gap: 8px; margin-bottom: 8px;">
                                <div class="stat-value" id="net-value">‚Äî</div>
                                <div class="stat-sub" style="font-size: 14px;">Total I/O</div>
                            </div>
                            <div style="height: 12px; margin-bottom: 16px;"></div> <!-- Spacer -->
                            <div
                                style="font-size: 12px; color: var(--text-muted); padding-top: 12px; border-top: 1px solid var(--border);">
                                <span id="net-detail">Rx: ‚Äî | Tx: ‚Äî</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Storage Table -->
                <div class="card">
                    <div class="card-header">
                        <h3>Filesystems</h3>
                    </div>
                    <div class="card-body" style="overflow-x: auto;">
                        <!-- Performance History -->
                        <h3 style="margin-bottom: 16px; margin-top: 32px; font-size: 16px; font-weight: 600;">
                            Performance History</h3>
                        <!-- Time Range Selector -->
                        <div id="time-range-selector" style="display: flex; gap: 6px; margin-bottom: 16px;">
                            <button class="btn btn-sm time-range-btn active" data-range="150"
                                onclick="setTimeRange(150)">5m</button>
                            <button class="btn btn-sm time-range-btn" data-range="300"
                                onclick="setTimeRange(300)">10m</button>
                        </div>
                        <div style="display: grid; gap: 20px; margin-bottom: 32px;">
                            <!-- CPU History -->
                            <div class="card chart-card" id="cpu-chart-card">
                                <div class="card-header"
                                    style="display:flex; justify-content:space-between; align-items:center;">
                                    <h3>CPU History</h3>
                                    <span id="cpu-live-value" class="chart-live-value"
                                        style="font-size:20px; font-weight:700; color:rgba(99,102,241,1); font-family:'JetBrains Mono',monospace;">‚Äî</span>
                                </div>
                                <div class="card-body" style="padding: 0; min-height: 200px; position: relative;">
                                    <canvas id="cpu-chart-canvas"
                                        style="width: 100%; height: 100%; display: block;"></canvas>
                                </div>
                            </div>
                            <!-- Memory History -->
                            <div class="card chart-card" id="mem-chart-card">
                                <div class="card-header"
                                    style="display:flex; justify-content:space-between; align-items:center;">
                                    <h3>Memory History</h3>
                                    <span id="mem-live-value" class="chart-live-value"
                                        style="font-size:20px; font-weight:700; color:rgba(16,185,129,1); font-family:'JetBrains Mono',monospace;">‚Äî</span>
                                </div>
                                <div class="card-body" style="padding: 0; min-height: 200px; position: relative;">
                                    <canvas id="mem-chart-canvas"
                                        style="width: 100%; height: 100%; display: block;"></canvas>
                                </div>
                            </div>
                            <!-- Network I/O History -->
                            <div class="card chart-card" id="net-chart-card">
                                <div class="card-header"
                                    style="display:flex; justify-content:space-between; align-items:center;">
                                    <h3>Network I/O</h3>
                                    <span id="net-live-value" class="chart-live-value"
                                        style="font-size:16px; font-weight:600; color:var(--info); font-family:'JetBrains Mono',monospace;">‚Äî</span>
                                </div>
                                <div class="card-body" style="padding: 0; min-height: 200px; position: relative;">
                                    <canvas id="net-chart-canvas"
                                        style="width: 100%; height: 100%; display: block;"></canvas>
                                </div>
                            </div>
                            <!-- Disk/Net History -->
                            <div class="card chart-card" id="disk-chart-card">
                                <div class="card-header"
                                    style="display:flex; justify-content:space-between; align-items:center;">
                                    <h3>Disk I/O History</h3>
                                    <div id="disk-chart-legend" style="display: flex; gap: 10px; font-size: 11px;">
                                    </div>
                                </div>
                                <div class="card-body" style="padding: 0; min-height: 200px; position: relative;">
                                    <canvas id="disk-chart-canvas"
                                        style="width: 100%; height: 100%; display: block;"></canvas>
                                </div>
                            </div>
                        </div>
                        <!-- Chart Tooltip (shared) -->
                        <div id="chart-tooltip"
                            style="display:none; position:fixed; z-index:1000; pointer-events:none; background:rgba(10,14,26,0.92); border:1px solid var(--border-light); border-radius:8px; padding:8px 12px; font-size:12px; font-family:'JetBrains Mono',monospace; color:var(--text-primary); box-shadow:0 4px 20px rgba(0,0,0,0.5); backdrop-filter:blur(8px);">
                        </div>

                        <!-- Storage Table (Moved) -->
                        <h3 style="margin-bottom: 16px; font-size: 16px; font-weight: 600;">Storage Usage</h3>
                        <div class="card">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Mount</th>
                                        <th>Type</th>
                                        <th>Used</th>
                                        <th>Available</th>
                                        <th>Total</th>
                                        <th>Usage</th>
                                    </tr>
                                </thead>
                                <tbody id="disk-table"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>





        </div>

        <!-- ‚ïê‚ïê‚ïê Security Page (per-node) ‚ïê‚ïê‚ïê -->
        <div id="page-security" class="page-view" style="display:none;">
            <div id="security-node-content">
                <div style="padding:40px; text-align:center; color:var(--text-muted);">Loading security status...</div>
            </div>
        </div>

        <div id="page-appstore" class="page-view" style="display:none;">
            <!-- Header -->
            <div class="card"
                style="margin-bottom:20px; background:linear-gradient(135deg, rgba(220,38,38,0.12), rgba(59,130,246,0.08)); border-color:rgba(220,38,38,0.25);">
                <div class="card-body"
                    style="display:flex; align-items:center; justify-content:space-between; padding:28px 32px;">
                    <div style="display:flex; align-items:center; gap:20px;">
                        <div
                            style="width:64px; height:64px; background:linear-gradient(135deg,#dc2626,#ef4444); border-radius:16px; display:flex; align-items:center; justify-content:center; font-size:32px; box-shadow:0 4px 20px rgba(220,38,38,0.3);">
                            üõçÔ∏è</div>
                        <div>
                            <h2 style="font-size:24px; margin-bottom:4px; color:var(--text-primary); font-weight:700;">
                                App Store</h2>
                            <p style="color:var(--text-secondary); font-size:13px; margin:0;">One-click install popular
                                applications as Docker containers, LXC containers, or directly on the host.</p>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Browse Tab -->
            <div id="appstore-browse-tab">
                <!-- Search & Filter Bar -->
                <div style="display:flex; gap:12px; margin-bottom:20px; flex-wrap:wrap; align-items:center;">
                    <input type="text" id="appstore-search" placeholder="üîç Search apps..." oninput="filterAppStore()"
                        style="flex:1; min-width:200px; padding:10px 16px; background:var(--bg-secondary); border:1px solid var(--border); border-radius:10px; color:var(--text-primary); font-size:14px; outline:none; font-family:inherit; transition:border-color 0.2s;"
                        onfocus="this.style.borderColor='rgba(220,38,38,0.5)'"
                        onblur="this.style.borderColor='var(--border)'">
                    <div id="appstore-categories" style="display:flex; gap:6px; flex-wrap:wrap;">
                        <button class="appstore-cat-btn active" onclick="filterAppStoreCategory('All')">All</button>
                        <button class="appstore-cat-btn" onclick="filterAppStoreCategory('Web')">üåê Web</button>
                        <button class="appstore-cat-btn" onclick="filterAppStoreCategory('Database')">üóÑÔ∏è
                            Database</button>
                        <button class="appstore-cat-btn" onclick="filterAppStoreCategory('Monitoring')">üìä
                            Monitoring</button>
                        <button class="appstore-cat-btn" onclick="filterAppStoreCategory('Media')">üé¨ Media</button>
                        <button class="appstore-cat-btn" onclick="filterAppStoreCategory('Dev Tools')">üíª Dev
                            Tools</button>
                        <button class="appstore-cat-btn" onclick="filterAppStoreCategory('Networking')">üîÄ
                            Networking</button>
                        <button class="appstore-cat-btn" onclick="filterAppStoreCategory('Other')">üì¶ Other</button>
                        <button class="appstore-cat-btn" onclick="filterAppStoreCategory('Wolf')">üê∫ Wolf</button>
                    </div>
                </div>
                <!-- App Grid -->
                <div id="appstore-grid" class="appstore-grid">
                    <div style="padding:40px; text-align:center; color:var(--text-muted); grid-column:1/-1;">Loading
                        apps...</div>
                </div>
            </div>



            <!-- Install Modal -->
            <div id="appstore-install-modal" class="modal-overlay" style="display:none;">
                <div class="modal" style="max-width:520px; width:90%;">
                    <div class="modal-header">
                        <h3 id="appstore-install-title">Install App</h3>
                        <button class="modal-close" onclick="closeAppStoreInstallModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div style="margin-bottom:16px;">
                            <label style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">üñ•Ô∏è Deploy
                                To</label>
                            <select id="appstore-install-host" class="form-control" style="width:100%;">
                                <!-- Populated from allNodes by JS -->
                            </select>
                        </div>
                        <div style="margin-bottom:16px;">
                            <label style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">Container
                                Name</label>
                            <input type="text" id="appstore-install-name" class="form-control" placeholder="my-app">
                        </div>
                        <div style="margin-bottom:16px;">
                            <label style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">Install
                                Target</label>
                            <div style="display:flex; gap:8px;" id="appstore-install-targets">
                                <!-- Target buttons injected by JS -->
                            </div>
                        </div>
                        <div id="appstore-install-inputs">
                            <!-- Dynamic user inputs injected by JS -->
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn" onclick="closeAppStoreInstallModal()">Cancel</button>
                        <button class="btn btn-primary" id="appstore-install-btn" onclick="executeAppStoreInstall()">üöÄ
                            Install</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê WolfRun Orchestration Page ‚ïê‚ïê‚ïê -->
        <div id="page-wolfrun" class="page-view" style="display:none;">
            <!-- Header -->
            <div class="card"
                style="margin-bottom:20px; background:linear-gradient(135deg, rgba(16,185,129,0.12), rgba(99,102,241,0.08)); border-color:rgba(16,185,129,0.25);">
                <div class="card-body"
                    style="display:flex; align-items:center; justify-content:space-between; padding:28px 32px; flex-wrap:wrap; gap:16px;">
                    <div style="display:flex; align-items:center; gap:20px;">
                        <div
                            style="width:64px; height:64px; background:linear-gradient(135deg,#10b981,#6366f1); border-radius:16px; display:flex; align-items:center; justify-content:center; font-size:32px; box-shadow:0 4px 20px rgba(16,185,129,0.3);">
                            üèÉ</div>
                        <div>
                            <h2 style="font-size:24px; margin-bottom:4px; color:var(--text-primary); font-weight:700;">
                                WolfRun <span id="wolfrun-cluster-label"
                                    style="font-size:14px; font-weight:400; color:var(--text-secondary);"></span></h2>
                            <p style="color:var(--text-secondary); font-size:13px; margin:0;">Container orchestration ‚Äî
                                deploy, scale, and manage Docker & LXC services across your cluster.</p>
                        </div>
                    </div>
                    <div style="display:flex; gap:10px; align-items:center;">
                        <button class="btn btn-primary" onclick="openWolfRunDeployModal()" style="font-weight:600;">
                            üöÄ Deploy Service
                        </button>
                        <button class="btn" onclick="loadWolfRunServices()"
                            style="background:var(--bg-secondary); border:1px solid var(--border);">
                            üîÑ Refresh
                        </button>
                    </div>
                </div>
            </div>

            <!-- Summary Stats -->
            <div class="stats-grid" style="margin-bottom:20px;">
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Services</span>
                        <div class="stat-icon" style="background:rgba(99,102,241,0.15); color:#6366f1;">üìã</div>
                    </div>
                    <div class="stat-value" id="wolfrun-stat-services">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Running</span>
                        <div class="stat-icon" style="background:rgba(16,185,129,0.15); color:#10b981;">‚úÖ</div>
                    </div>
                    <div class="stat-value" id="wolfrun-stat-running" style="color:#10b981;">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Pending</span>
                        <div class="stat-icon" style="background:rgba(234,179,8,0.15); color:#eab308;">‚è≥</div>
                    </div>
                    <div class="stat-value" id="wolfrun-stat-pending" style="color:#eab308;">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Nodes Used</span>
                        <div class="stat-icon" style="background:rgba(59,130,246,0.15); color:#3b82f6;">üñ•Ô∏è</div>
                    </div>
                    <div class="stat-value" id="wolfrun-stat-nodes">0</div>
                </div>
            </div>

            <!-- Services Table -->
            <div class="card" style="margin-bottom:20px;">
                <div class="card-header">
                    <h3>üèÉ Deployed Services</h3>
                </div>
                <div class="card-body" style="overflow-x:auto;">
                    <table class="data-table" id="wolfrun-services-table">
                        <thead>
                            <tr>
                                <th>Service</th>
                                <th>Runtime</th>
                                <th>Image</th>
                                <th>Replicas</th>
                                <th>Status</th>
                                <th>Nodes</th>
                                <th>WolfNet IPs</th>
                                <th style="text-align:right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="wolfrun-services-tbody"></tbody>
                    </table>
                    <div id="wolfrun-empty"
                        style="display:none; padding:48px; text-align:center; color:var(--text-muted);">
                        <div style="font-size:48px; margin-bottom:12px;">üèÉ</div>
                        <p style="font-size:14px; margin:0;">No services deployed yet. Click <strong>Deploy
                                Service</strong> to get started.</p>
                    </div>
                </div>
            </div>

            <!-- Deploy Modal -->
            <div id="wolfrun-deploy-modal" class="modal-overlay">
                <div class="modal" style="max-width:600px; width:90%;">
                    <div class="modal-header">
                        <h3>üöÄ Deploy New Service</h3>
                        <button class="modal-close" onclick="closeWolfRunDeployModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:16px;">
                            <div>
                                <label
                                    style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">Service
                                    Name</label>
                                <input type="text" id="wolfrun-deploy-name" class="form-control"
                                    placeholder="my-service">
                            </div>
                            <div>
                                <label
                                    style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">Runtime</label>
                                <select id="wolfrun-deploy-runtime" class="form-control"
                                    onchange="wolfrunRuntimeChanged()">
                                    <option value="docker">üê≥ Docker</option>
                                    <option value="lxc">üì¶ LXC</option>
                                </select>
                            </div>
                        </div>
                        <!-- Docker fields -->
                        <div id="wolfrun-docker-fields">
                            <div style="margin-bottom:16px;">
                                <label style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">Docker
                                    Image</label>
                                <input type="text" id="wolfrun-deploy-image" class="form-control"
                                    placeholder="nginx:alpine">
                            </div>
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:16px;">
                                <div>
                                    <label
                                        style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">Ports
                                        <span style="font-weight:400; color:var(--text-muted);">(one per
                                            line)</span></label>
                                    <textarea id="wolfrun-deploy-ports" class="form-control" rows="2"
                                        placeholder="80:80&#10;443:443"
                                        style="font-family:'JetBrains Mono',monospace; font-size:12px;"></textarea>
                                </div>
                                <div>
                                    <label
                                        style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">Env
                                        Vars <span
                                            style="font-weight:400; color:var(--text-muted);">(KEY=VALUE)</span></label>
                                    <textarea id="wolfrun-deploy-env" class="form-control" rows="2"
                                        placeholder="NODE_ENV=production&#10;DB_HOST=db"
                                        style="font-family:'JetBrains Mono',monospace; font-size:12px;"></textarea>
                                </div>
                            </div>
                            <div style="margin-bottom:16px;">
                                <label
                                    style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">Volumes
                                    <span
                                        style="font-weight:400; color:var(--text-muted);">(host:container)</span></label>
                                <textarea id="wolfrun-deploy-volumes" class="form-control" rows="2"
                                    placeholder="/data/app:/app/data"
                                    style="font-family:'JetBrains Mono',monospace; font-size:12px;"></textarea>
                            </div>
                        </div>
                        <!-- LXC fields -->
                        <div id="wolfrun-lxc-fields" style="display:none;">
                            <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:16px; margin-bottom:16px;">
                                <div>
                                    <label
                                        style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">Distribution</label>
                                    <select id="wolfrun-deploy-lxc-distro" class="form-control">
                                        <option value="ubuntu">Ubuntu</option>
                                        <option value="debian">Debian</option>
                                        <option value="alpine">Alpine</option>
                                        <option value="centos">CentOS</option>
                                    </select>
                                </div>
                                <div>
                                    <label
                                        style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">Release</label>
                                    <input type="text" id="wolfrun-deploy-lxc-release" class="form-control"
                                        value="jammy">
                                </div>
                                <div>
                                    <label
                                        style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">Architecture</label>
                                    <select id="wolfrun-deploy-lxc-arch" class="form-control">
                                        <option value="amd64">amd64</option>
                                        <option value="arm64">arm64</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <!-- Common fields -->
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">
                            <div>
                                <label
                                    style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">Replicas</label>
                                <input type="number" id="wolfrun-deploy-replicas" class="form-control" value="1" min="1"
                                    max="20">
                            </div>
                            <div>
                                <label
                                    style="font-size:13px; font-weight:600; display:block; margin-bottom:6px;">Restart
                                    Policy</label>
                                <select id="wolfrun-deploy-restart" class="form-control">
                                    <option value="always">Always</option>
                                    <option value="on-failure">On Failure</option>
                                    <option value="never">Never</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn" onclick="closeWolfRunDeployModal()">Cancel</button>
                        <button class="btn btn-primary" id="wolfrun-deploy-btn" onclick="executeWolfRunDeploy()">üöÄ
                            Deploy</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Issues Page ‚ïê‚ïê‚ïê -->
        <div id="page-issues" class="page-view" style="display:none; padding-top:0;">
            <!-- Header -->
            <div class="card"
                style="margin-bottom:20px; background:linear-gradient(135deg, rgba(234,179,8,0.12), rgba(220,38,38,0.08)); border-color:rgba(234,179,8,0.25);">
                <div class="card-body"
                    style="display:flex; align-items:center; justify-content:space-between; padding:28px 32px; flex-wrap:wrap; gap:16px;">
                    <div style="display:flex; align-items:center; gap:20px;">
                        <div
                            style="width:64px; height:64px; background:linear-gradient(135deg,#eab308,#f59e0b); border-radius:16px; display:flex; align-items:center; justify-content:center; font-size:32px; box-shadow:0 4px 20px rgba(234,179,8,0.3);">
                            ‚ö†Ô∏è</div>
                        <div>
                            <h2 style="font-size:24px; margin-bottom:4px; color:var(--text-primary); font-weight:700;">
                                Issues Scanner</h2>
                            <p style="color:var(--text-secondary); font-size:13px; margin:0;">Scan all nodes for
                                potential problems ‚Äî CPU, memory, disk, services, and containers.</p>
                        </div>
                    </div>
                    <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
                        <span id="issues-ai-badge"
                            style="display:none; padding:4px 10px; border-radius:6px; font-size:11px; font-weight:600;
                            background:rgba(99,102,241,0.15); color:rgba(129,140,248,1); border:1px solid rgba(99,102,241,0.3);">
                            ü§ñ AI Enhanced</span>
                        <div
                            style="display:flex; align-items:center; gap:6px; background:var(--bg-input); border:1px solid var(--border); border-radius:8px; padding:4px 10px;">
                            <span style="font-size:11px; color:var(--text-muted); white-space:nowrap;">üîî Auto
                                Scan:</span>
                            <select id="issues-schedule-select" onchange="saveIssueSchedule(this.value)"
                                style="background:transparent; border:none; color:var(--text-primary); font-size:12px; font-weight:500; cursor:pointer; outline:none; font-family:inherit;">
                                <option value="off" style="background:var(--bg-card);">Off</option>
                                <option value="hourly" style="background:var(--bg-card);">Every Hour</option>
                                <option value="6h" style="background:var(--bg-card);">Every 6 Hours</option>
                                <option value="12h" style="background:var(--bg-card);">Every 12 Hours</option>
                                <option value="daily" style="background:var(--bg-card);">Daily</option>
                            </select>
                        </div>
                        <div
                            style="display:flex; align-items:center; gap:6px; background:var(--bg-input); border:1px solid var(--border); border-radius:8px; padding:4px 10px;">
                            <span style="font-size:11px; color:var(--text-muted); white-space:nowrap;">üì¶
                                Channel:</span>
                            <select id="issues-channel-select"
                                style="background:transparent; border:none; color:var(--text-primary); font-size:12px; font-weight:500; cursor:pointer; outline:none; font-family:inherit;">
                                <option value="master" style="background:var(--bg-card);">Stable (master)</option>
                                <option value="beta" style="background:var(--bg-card);">Beta</option>
                            </select>
                        </div>
                        <button class="btn" onclick="issuesUpgradeAll()" id="issues-upgrade-all-btn"
                            style="display:none; background:rgba(16,185,129,0.15); color:#10b981; border:1px solid rgba(16,185,129,0.3);">
                            ‚ö° Upgrade All
                        </button>
                        <button class="btn" onclick="cleanSystem()" id="issues-clean-btn"
                            style="background:rgba(59,130,246,0.15); color:#3b82f6; border:1px solid rgba(59,130,246,0.3);">
                            üßπ Clean
                        </button>
                        <button class="btn btn-primary" onclick="scanForIssues()" id="issues-scan-btn">
                            üîÑ Scan Now
                        </button>
                    </div>
                </div>
            </div>

            <!-- Summary Counters -->
            <div class="stats-grid" style="margin-bottom:20px;">
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Critical</span>
                        <div class="stat-icon" style="background:rgba(239,68,68,0.15); color:#ef4444;">üî¥</div>
                    </div>
                    <div class="stat-value" id="issues-count-critical" style="color:#ef4444;">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Warnings</span>
                        <div class="stat-icon" style="background:rgba(234,179,8,0.15); color:#eab308;">üü°</div>
                    </div>
                    <div class="stat-value" id="issues-count-warning" style="color:#eab308;">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Info</span>
                        <div class="stat-icon" style="background:rgba(59,130,246,0.15); color:#3b82f6;">üîµ</div>
                    </div>
                    <div class="stat-value" id="issues-count-info" style="color:#3b82f6;">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Nodes Scanned</span>
                        <div class="stat-icon" style="background:rgba(16,185,129,0.15); color:#10b981;">üñ•Ô∏è</div>
                    </div>
                    <div class="stat-value" id="issues-count-nodes">0</div>
                </div>
            </div>

            <!-- Scan Results -->
            <div id="issues-list">
                <div class="card">
                    <div class="card-body" style="padding:48px; text-align:center; color:var(--text-muted);">
                        <div style="font-size:48px; margin-bottom:12px;">üîç</div>
                        <p style="font-size:14px; margin:0;">Click <strong>Scan Now</strong> to check all nodes for
                            issues.</p>
                    </div>
                </div>
            </div>

            <!-- AI Analysis (populated after scan) -->
            <div id="issues-ai-section" style="display:none; margin-top:20px;">
                <div class="card" style="border-color:rgba(99,102,241,0.3);">
                    <div class="card-header">
                        <h3>ü§ñ AI Analysis</h3>
                    </div>
                    <div class="card-body">
                        <div id="issues-ai-content" style="font-size:13px; line-height:1.7; color:var(--text);"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Global WolfNet Page ‚ïê‚ïê‚ïê -->
        <div id="page-global-wolfnet" class="page-view" style="display:none;">
            <!-- Header -->
            <div class="card"
                style="margin-bottom:20px; background:linear-gradient(135deg, rgba(59,130,246,0.12), rgba(16,185,129,0.08)); border-color:rgba(59,130,246,0.25);">
                <div class="card-body"
                    style="display:flex; align-items:center; justify-content:space-between; padding:28px 32px; flex-wrap:wrap; gap:16px;">
                    <div style="display:flex; align-items:center; gap:20px;">
                        <div
                            style="width:64px; height:64px; background:linear-gradient(135deg,#3b82f6,#10b981); border-radius:16px; display:flex; align-items:center; justify-content:center; font-size:32px; box-shadow:0 4px 20px rgba(59,130,246,0.3);">
                            üåê</div>
                        <div>
                            <h2 style="font-size:24px; margin-bottom:4px; color:var(--text-primary); font-weight:700;">
                                Global WolfNet</h2>
                            <p style="color:var(--text-secondary); font-size:13px; margin:0;">All WolfNet IPs across
                                your fleet ‚Äî nodes, containers, Docker, and VMs.</p>
                        </div>
                    </div>
                    <div style="display:flex; gap:10px; align-items:center;">
                        <input type="text" id="gwn-filter" placeholder="üîç Filter..." oninput="filterGlobalWolfNet()"
                            style="padding:8px 14px; background:var(--bg-secondary); border:1px solid var(--border); border-radius:8px; color:var(--text-primary); font-size:13px; outline:none; font-family:inherit; width:200px;"
                            onfocus="this.style.borderColor='rgba(59,130,246,0.5)'"
                            onblur="this.style.borderColor='var(--border)'">
                        <button class="btn btn-primary" onclick="scanGlobalWolfNet()" id="gwn-scan-btn">üîç Scan</button>
                    </div>
                </div>
            </div>

            <!-- Stats -->
            <div class="stats-grid" style="margin-bottom:20px;">
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Nodes</span>
                        <div class="stat-icon" style="background:rgba(59,130,246,0.15); color:#3b82f6;">üñ•Ô∏è</div>
                    </div>
                    <div class="stat-value" id="gwn-count-nodes">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">WolfNet Peers</span>
                        <div class="stat-icon" style="background:rgba(16,185,129,0.15); color:#10b981;">üîó</div>
                    </div>
                    <div class="stat-value" id="gwn-count-peers">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">LXC</span>
                        <div class="stat-icon" style="background:rgba(234,179,8,0.15); color:#eab308;">üì¶</div>
                    </div>
                    <div class="stat-value" id="gwn-count-lxc">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Docker</span>
                        <div class="stat-icon" style="background:rgba(99,102,241,0.15); color:#6366f1;">üê≥</div>
                    </div>
                    <div class="stat-value" id="gwn-count-docker">0</div>
                </div>
            </div>

            <div id="gwn-content">
                <div class="card">
                    <div class="card-body" style="padding:48px; text-align:center; color:var(--text-muted);">
                        <div style="font-size:48px; margin-bottom:12px;">üîç</div>
                        <p style="font-size:14px; margin:0;">Click <strong>Scan</strong> to discover all IPs across your
                            fleet.</p>
                    </div>
                </div>
            </div>
            <p style="margin-top:12px; font-size:12px; color:var(--text-muted); text-align:center;">
                üí° If a cluster has no peers, go into the settings for the cluster and refresh the peers.
            </p>
        </div>

        <!-- ‚ïê‚ïê‚ïê Documentation Page ‚ïê‚ïê‚ïê -->
        <div id="page-components" class="page-view" style="display:none;">
            <div class="components-grid" id="components-grid"></div>

            <!-- Install Scripts Section -->
            <div class="card" style="margin-top: 24px;">
                <div class="card-header">
                    <h3>üì• Install Scripts</h3>
                </div>
                <div class="card-body">
                    <p style="color: var(--text-muted); font-size: 13px; margin-bottom: 16px;">
                        Run these commands on any server or inside a container to install Wolf components.
                    </p>
                    <div style="display: grid; gap: 10px;">
                        <div
                            style="display: flex; align-items: center; gap: 12px; padding: 10px 14px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px;">
                            <span style="font-size: 18px; width: 28px; text-align: center;">üåê</span>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 13px;">WolfNet</div>
                                <code
                                    style="font-size: 11px; color: var(--text-muted); word-break: break-all;">curl -sSL https://raw.githubusercontent.com/wolfsoftwaresystemsltd/WolfScale/main/wolfnet/setup.sh | sudo bash</code>
                            </div>
                            <button class="btn btn-sm" onclick="copyInstallCmd('wolfnet')"
                                title="Copy command">üìã</button>
                        </div>
                        <div
                            style="display: flex; align-items: center; gap: 12px; padding: 10px 14px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px;">
                            <span style="font-size: 18px; width: 28px; text-align: center;">üõ°Ô∏è</span>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 13px;">WolfProxy</div>
                                <code
                                    style="font-size: 11px; color: var(--text-muted); word-break: break-all;">curl -sSL https://raw.githubusercontent.com/wolfsoftwaresystemsltd/WolfProxy/main/setup.sh | sudo bash</code>
                            </div>
                            <button class="btn btn-sm" onclick="copyInstallCmd('wolfproxy')"
                                title="Copy command">üìã</button>
                        </div>
                        <div
                            style="display: flex; align-items: center; gap: 12px; padding: 10px 14px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px;">
                            <span style="font-size: 18px; width: 28px; text-align: center;">üì°</span>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 13px;">WolfServe</div>
                                <code
                                    style="font-size: 11px; color: var(--text-muted); word-break: break-all;">curl -sSL https://raw.githubusercontent.com/wolfsoftwaresystemsltd/WolfServe/main/setup.sh | sudo bash</code>
                            </div>
                            <button class="btn btn-sm" onclick="copyInstallCmd('wolfserve')"
                                title="Copy command">üìã</button>
                        </div>
                        <div
                            style="display: flex; align-items: center; gap: 12px; padding: 10px 14px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px;">
                            <span style="font-size: 18px; width: 28px; text-align: center;">üíæ</span>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 13px;">WolfDisk</div>
                                <code
                                    style="font-size: 11px; color: var(--text-muted); word-break: break-all;">curl -sSL https://raw.githubusercontent.com/wolfsoftwaresystemsltd/WolfScale/main/setup.sh | sudo bash</code>
                            </div>
                            <button class="btn btn-sm" onclick="copyInstallCmd('wolfdisk')"
                                title="Copy command">üìã</button>
                        </div>
                        <div
                            style="display: flex; align-items: center; gap: 12px; padding: 10px 14px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px;">
                            <span style="font-size: 18px; width: 28px; text-align: center;">‚öñÔ∏è</span>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 13px;">WolfScale</div>
                                <code
                                    style="font-size: 11px; color: var(--text-muted); word-break: break-all;">curl -sSL https://raw.githubusercontent.com/wolfsoftwaresystemsltd/WolfScale/main/setup_lb.sh | sudo bash</code>
                            </div>
                            <button class="btn btn-sm" onclick="copyInstallCmd('wolfscale')"
                                title="Copy command">üìã</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Component Detail Page ‚ïê‚ïê‚ïê -->
        <div id="page-component-detail" class="page-view" style="display:none;">
            <div style="margin-bottom: 16px;">
                <button class="btn btn-sm" onclick="navigateTo('components')" id="back-to-components">
                    ‚Üê Back to Components
                </button>
            </div>

            <div class="stats-grid" style="margin-bottom: 20px;">
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Status</span>
                        <div class="stat-icon" id="detail-status-icon"
                            style="background: var(--success-bg); color: var(--success);">‚óè</div>
                    </div>
                    <div class="stat-value" id="detail-status">‚Äî</div>
                    <div class="stat-sub" id="detail-active-since"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Memory</span>
                    </div>
                    <div class="stat-value" id="detail-memory">‚Äî</div>
                    <div class="stat-sub">current usage</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">PID</span>
                    </div>
                    <div class="stat-value" id="detail-pid">‚Äî</div>
                    <div class="stat-sub">main process ID</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Restarts</span>
                    </div>
                    <div class="stat-value" id="detail-restarts">‚Äî</div>
                    <div class="stat-sub">since last enable</div>
                </div>
            </div>

            <!-- Actions bar -->
            <div class="card" style="margin-bottom: 20px;">
                <div class="card-body" style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                    <span id="detail-component-icon" style="font-size: 24px;"></span>
                    <div style="flex: 1;">
                        <h3 id="detail-component-name" style="margin: 0;"></h3>
                        <div id="detail-component-desc" style="color: var(--text-muted); font-size: 13px;">
                        </div>
                    </div>
                    <button class="btn btn-success btn-sm" id="detail-btn-start"
                        onclick="detailServiceAction('start')">Start</button>
                    <button class="btn btn-sm" id="detail-btn-restart"
                        onclick="detailServiceAction('restart')">Restart</button>
                    <button class="btn btn-danger btn-sm" id="detail-btn-stop"
                        onclick="detailServiceAction('stop')">Stop</button>
                </div>
            </div>

            <!-- Config Editor -->
            <div class="card" style="margin-bottom: 20px;" id="detail-config-section">
                <div class="card-header">
                    <h3>Configuration</h3>
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <span id="detail-config-path"
                            style="font-size: 12px; color: var(--text-muted); font-family: 'JetBrains Mono', monospace;"></span>
                        <button class="btn btn-primary btn-sm" onclick="saveConfig()">üíæ Save</button>
                    </div>
                </div>
                <div class="card-body">
                    <textarea id="detail-config-editor" class="config-editor" spellcheck="false"></textarea>
                </div>
            </div>

            <!-- Logs -->
            <div class="card">
                <div class="card-header">
                    <h3>Journal Logs</h3>
                    <button class="btn btn-sm" onclick="refreshComponentDetail(currentComponent)">‚Üª
                        Refresh</button>
                </div>
                <div class="card-body">
                    <div id="detail-logs" class="log-viewer"></div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Services Page ‚ïê‚ïê‚ïê -->
        <div id="page-services" class="page-view" style="display:none;">
            <div class="card">
                <div class="card-header">
                    <h3>System Services</h3>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Service</th>
                                <th>Status</th>
                                <th>Enabled</th>
                                <th>Version</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="services-table"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Backups Page ‚ïê‚ïê‚ïê -->
        <div id="page-backups" class="page-view" style="display:none;">
            <!-- Backup Targets Card -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header"
                    style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px;">
                    <h3>üõ°Ô∏è Backup Manager</h3>
                    <div style="display:flex; gap:8px; align-items:center;">
                        <select id="backup-storage-select" class="form-control"
                            style="width:auto; min-width:220px; padding:5px 10px; font-size:12px;">
                            <option value="local:/var/lib/wolfstack/backups">üìÅ Local ‚Äî /var/lib/wolfstack/backups
                            </option>
                        </select>
                        <button class="btn btn-sm btn-primary" onclick="backupSelected()">‚ö° Backup Now</button>
                        <button class="btn btn-sm"
                            style="background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border);"
                            onclick="showScheduleSelectedModal()">üìÖ Schedule</button>
                    </div>
                </div>
                <div class="card-body">
                    <div style="margin-bottom:8px; display:flex; align-items:center; gap:12px;">
                        <label
                            style="font-size:13px; color:var(--text-secondary); cursor:pointer; display:flex; align-items:center; gap:6px;">
                            <input type="checkbox" id="backup-select-all"
                                onchange="toggleAllBackupTargets(this.checked)"> Select All
                        </label>
                        <span id="backup-selected-count" style="font-size:12px; color:var(--text-muted);">0
                            selected</span>
                    </div>
                    <div id="backup-targets-list"
                        style="display:grid; grid-template-columns:repeat(auto-fill, minmax(280px, 1fr)); gap:8px;">
                        <p style="text-align:center; padding:20px; color:var(--text-muted); grid-column:1/-1;">Loading
                            targets...</p>
                    </div>
                </div>
            </div>

            <!-- Backup History Card -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header">
                    <h3>üìã Backup History</h3>
                </div>
                <div class="card-body" style="overflow-x:auto;">
                    <table class="data-table" style="width:100%;">
                        <thead>
                            <tr>
                                <th>Target</th>
                                <th>Type</th>
                                <th>Storage</th>
                                <th>Size</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th style="text-align:right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="backups-table"></tbody>
                    </table>
                    <p id="backups-empty"
                        style="display:none; text-align:center; padding:20px; color: var(--text-muted);">
                        No backups yet. Select items above and click <strong>‚ö° Backup Now</strong>.
                    </p>
                </div>
            </div>

            <!-- Schedules Card -->
            <div class="card">
                <div class="card-header">
                    <h3>üìÖ Backup Schedules</h3>
                </div>
                <div class="card-body" style="overflow-x:auto;">
                    <table class="data-table" style="width:100%;">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Frequency</th>
                                <th>Time (UTC)</th>
                                <th>Targets</th>
                                <th>Storage</th>
                                <th>Retention</th>
                                <th>Enabled</th>
                                <th style="text-align:right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="schedules-table"></tbody>
                    </table>
                    <p id="schedules-empty"
                        style="display:none; text-align:center; padding:20px; color: var(--text-muted);">
                        No schedules configured. Select targets and click <strong>üìÖ Schedule</strong>.
                    </p>
                </div>
            </div>

            <!-- PBS Configuration Card -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>üì¶ Proxmox Backup Server</h3>
                    <div style="display:flex; gap:8px; align-items:center;">
                        <span id="pbs-status-badge" style="font-size:12px; padding:3px 10px; border-radius:10px;
                            background:var(--bg-tertiary); color:var(--text-muted);">Checking‚Ä¶</span>
                        <button class="btn btn-sm btn-primary" onclick="savePbsConfig()">üíæ Save</button>
                        <button class="btn btn-sm"
                            style="background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border);"
                            onclick="testPbsConnection()">üîå Test</button>
                    </div>
                </div>
                <div class="card-body">
                    <!-- Saved credentials summary (shown when config is saved) -->
                    <div id="pbs-config-saved" style="display:none;">
                        <div
                            style="display:grid; grid-template-columns:repeat(auto-fill, minmax(200px, 1fr)); gap:8px; margin-bottom:12px;">
                            <div><span style="font-size:11px; color:var(--text-muted);">Server</span><br><strong
                                    id="pbs-saved-server">‚Äî</strong></div>
                            <div><span style="font-size:11px; color:var(--text-muted);">Datastore</span><br><strong
                                    id="pbs-saved-datastore">‚Äî</strong></div>
                            <div><span style="font-size:11px; color:var(--text-muted);">User</span><br><strong
                                    id="pbs-saved-user">‚Äî</strong></div>
                            <div><span style="font-size:11px; color:var(--text-muted);">Auth</span><br><strong
                                    id="pbs-saved-auth">‚Äî</strong></div>
                        </div>
                        <button class="btn btn-sm" onclick="showPbsConfigForm()"
                            style="background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border);">‚úèÔ∏è
                            Edit Configuration</button>
                    </div>
                    <!-- Editable form (hidden after save) -->
                    <div id="pbs-config-form">
                        <div
                            style="display:grid; grid-template-columns:repeat(auto-fill, minmax(280px, 1fr)); gap:12px;">
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">Server</label>
                                <input type="text" id="pbs-server" class="form-control"
                                    placeholder="pbs.example.com:8007">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">Datastore</label>
                                <input type="text" id="pbs-datastore" class="form-control" placeholder="backups">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">Username</label>
                                <input type="text" id="pbs-user" class="form-control" placeholder="backup@pbs">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">Password <span
                                        style="color:var(--text-muted);">(or use API token below)</span></label>
                                <input type="password" id="pbs-password" class="form-control" placeholder="password">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">API Token Name <span
                                        style="color:var(--text-muted);">(optional)</span></label>
                                <input type="text" id="pbs-token-name" class="form-control" placeholder="wolfstack">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">API Token Secret <span
                                        style="color:var(--text-muted);">(optional)</span></label>
                                <input type="password" id="pbs-token-secret" class="form-control"
                                    placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">Namespace <span
                                        style="color:var(--text-muted);">(optional)</span></label>
                                <input type="text" id="pbs-namespace" class="form-control" placeholder="">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">Fingerprint <span
                                        style="color:var(--text-muted);">(optional, for self-signed
                                        certs)</span></label>
                                <input type="text" id="pbs-fingerprint" class="form-control"
                                    placeholder="SHA-256 fingerprint">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PBS Snapshots Browser -->
            <div class="card" id="pbs-snapshots-card" style="display:none;">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>üóÇÔ∏è PBS Snapshots</h3>
                    <button class="btn btn-sm"
                        style="background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border);"
                        onclick="loadPbsSnapshots()">üîÑ Refresh</button>
                </div>
                <div class="card-body" style="overflow-x:auto;">
                    <table class="data-table" style="width:100%;">
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Name</th>
                                <th>Date</th>
                                <th>Size</th>
                                <th style="text-align:right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="pbs-snapshots-table"></tbody>
                    </table>
                    <p id="pbs-snapshots-empty"
                        style="display:none; text-align:center; padding:20px; color:var(--text-muted);">
                        No snapshots found on PBS server.
                    </p>
                </div>
            </div>
        </div>

        <!-- Schedule Modal (only needs name, frequency, time, retention ‚Äî targets come from checked items) -->
        <div id="create-schedule-modal" class="modal-overlay">
            <div class="modal" style="max-width:480px;">
                <div class="modal-header">
                    <h3>üìÖ Schedule Backup</h3>
                    <button class="modal-close" onclick="closeModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Schedule Name</label>
                        <input type="text" id="schedule-name" class="form-control" placeholder="Nightly Backup">
                    </div>
                    <div class="form-group">
                        <label>Frequency</label>
                        <select id="schedule-frequency" class="form-control">
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly">Monthly</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Time (UTC, HH:MM)</label>
                        <input type="text" id="schedule-time" class="form-control" placeholder="02:00" value="02:00">
                    </div>
                    <div class="form-group">
                        <label>Retention (keep N backups, 0 = unlimited)</label>
                        <input type="number" id="schedule-retention" class="form-control" value="7" min="0">
                    </div>
                    <p id="schedule-selected-summary" style="font-size:12px; color:var(--text-muted);"></p>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="createSchedule()">üìÖ Create Schedule</button>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Certificates Page ‚ïê‚ïê‚ïê -->
        <div id="page-certificates" class="page-view" style="display:none;">
            <div class="card">
                <div class="card-header">
                    <h3>SSL Certificates</h3>
                </div>
                <div class="card-body">
                    <div class="form-group">
                        <label>Domain Name</label>
                        <input type="text" class="form-control" id="cert-domain" placeholder="example.com">
                    </div>
                    <div class="form-group" style="margin-top: 12px;">
                        <label>Email Address</label>
                        <input type="email" class="form-control" id="cert-email" placeholder="admin@example.com">
                    </div>
                    <button class="btn btn-primary" onclick="requestCertificate()" style="margin-top: 12px;">
                        üîí Request Certificate (Let's Encrypt)
                    </button>
                    <p style="margin-top: 12px; font-size: 13px; color: var(--text-muted);">
                        Uses Certbot to obtain a free SSL certificate from Let's Encrypt.
                        Port 80 must be accessible from the internet. Certbot will be installed automatically if needed.
                        After obtaining a certificate, restart WolfStack to enable HTTPS.
                    </p>
                </div>
            </div>
            <div class="card" style="margin-top: 20px;">
                <div class="card-header">
                    <h3>Installed Certificates</h3>
                </div>
                <div class="card-body">
                    <div id="cert-list" style="font-size: 14px; color: var(--text-muted);">Loading...</div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Cron Jobs Page ‚ïê‚ïê‚ïê -->
        <div id="page-cron" class="page-view" style="display:none;">
            <!-- Quick Add -->
            <div class="card">
                <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;">
                    <h3>‚ûï Add Cron Job</h3>
                </div>
                <div class="card-body">
                    <div style="display:grid; grid-template-columns:200px 1fr auto; gap:12px; align-items:end;">
                        <div class="form-group" style="margin:0;">
                            <label style="font-size:12px;">Schedule</label>
                            <select id="cron-schedule-preset" class="form-control" onchange="onCronPresetChange()">
                                <option value="0 * * * *">Every Hour</option>
                                <option value="*/5 * * * *">Every 5 Minutes</option>
                                <option value="*/15 * * * *">Every 15 Minutes</option>
                                <option value="0 0 * * *">Daily at Midnight</option>
                                <option value="0 3 * * *">Daily at 3 AM</option>
                                <option value="0 0 * * 0">Every Sunday</option>
                                <option value="0 0 * * 1">Every Monday</option>
                                <option value="0 0 1 * *">Monthly (1st)</option>
                                <option value="@reboot">On Reboot</option>
                                <option value="custom">Custom...</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin:0;" id="cron-custom-schedule-group" hidden>
                            <label style="font-size:12px;">Custom Schedule (5 fields)</label>
                            <input type="text" id="cron-custom-schedule" class="form-control" placeholder="* * * * *"
                                style="font-family:var(--font-mono);font-size:13px;">
                        </div>
                        <div class="form-group" style="margin:0; flex:1;">
                            <label style="font-size:12px;">Command</label>
                            <input type="text" id="cron-command" class="form-control"
                                placeholder="e.g. /usr/bin/backup.sh"
                                style="font-family:var(--font-mono);font-size:13px;">
                        </div>
                        <button class="btn btn-primary" onclick="addCronJob()" style="height:38px;white-space:nowrap;">
                            ‚ûï Add Job
                        </button>
                    </div>
                    <div class="form-group" style="margin-top:8px;">
                        <label style="font-size:12px;">Comment (optional)</label>
                        <input type="text" id="cron-comment" class="form-control" placeholder="Description of this job"
                            style="font-size:13px;">
                    </div>
                </div>
            </div>

            <!-- Premade Jobs -->
            <div class="card" style="margin-top:20px;">
                <div class="card-header">
                    <h3>‚ö° Quick Actions</h3>
                </div>
                <div class="card-body" style="display:flex; flex-wrap:wrap; gap:10px;">
                    <button class="btn" onclick="addPremadeCron('wolfstack-update')"
                        style="display:flex;align-items:center;gap:6px;">
                        üê∫ Auto-update WolfStack
                    </button>
                    <button class="btn" onclick="addPremadeCron('docker-prune')"
                        style="display:flex;align-items:center;gap:6px;">
                        üê≥ Clean Docker Images
                    </button>
                    <button class="btn" onclick="addPremadeCron('apt-update')"
                        style="display:flex;align-items:center;gap:6px;">
                        üì¶ System Updates (weekly)
                    </button>
                    <button class="btn" onclick="addPremadeCron('certbot-renew')"
                        style="display:flex;align-items:center;gap:6px;">
                        üîí Renew SSL Certs
                    </button>
                    <button class="btn" onclick="addPremadeCron('tmpclean')"
                        style="display:flex;align-items:center;gap:6px;">
                        üóëÔ∏è Clean /tmp
                    </button>
                </div>
            </div>

            <!-- Crontab Entries -->
            <div class="card" style="margin-top:20px;">
                <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;">
                    <h3>üìã Cron Entries</h3>
                    <button class="btn btn-sm" onclick="loadCronJobs()" title="Refresh">üîÑ Refresh</button>
                </div>
                <div class="card-body">
                    <div id="cron-entries-container" style="font-size:14px; color:var(--text-muted);">Loading...</div>
                </div>
            </div>

            <!-- Raw Crontab -->
            <div class="card" style="margin-top:20px;">
                <div class="card-header" style="cursor:pointer;" onclick="toggleRawCrontab()">
                    <h3 style="display:flex;align-items:center;gap:8px;">
                        <span id="raw-crontab-arrow" style="transition:transform 0.2s;">‚ñ∂</span>
                        Raw Crontab
                    </h3>
                </div>
                <div id="raw-crontab-body" class="card-body" style="display:none;">
                    <pre id="raw-crontab-content"
                        style="margin:0; padding:16px; background:var(--bg-primary,#0f0f1a); border-radius:8px; font-size:12px; font-family:var(--font-mono); color:var(--text); overflow-x:auto; white-space:pre-wrap; word-break:break-all;"></pre>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê MySQL Database Editor ‚ïê‚ïê‚ïê -->
        <div id="page-mysql-editor" class="page-view" style="display:none;">
            <!-- Connection Bar -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-body" style="padding:16px;">
                    <div style="display:flex; align-items:center; gap:8px; flex-wrap:wrap;">
                        <span style="font-size:20px;">üóÑÔ∏è</span>
                        <div style="display:flex; align-items:center; gap:6px; flex:1; min-width:0; flex-wrap:wrap;">
                            <select id="mysql-container-select" onchange="mysqlSelectContainer(this.value)"
                                style="display:none; font-size:13px; padding:6px 10px; border-radius:6px; border:1px solid var(--border); background:var(--bg-secondary); color:var(--text-primary); font-family:var(--font-mono); max-width:200px;">
                                <option value="">Manual connection</option>
                            </select>
                            <input type="text" class="form-control" id="mysql-host" placeholder="localhost" value=""
                                style="width:140px; font-size:13px; font-family:var(--font-mono);">
                            <span style="color:var(--text-muted);">:</span>
                            <input type="number" class="form-control" id="mysql-port" placeholder="3306" value="3306"
                                style="width:80px; font-size:13px; font-family:var(--font-mono);">
                            <input type="text" class="form-control" id="mysql-user" placeholder="root"
                                style="width:110px; font-size:13px;">
                            <input type="password" class="form-control" id="mysql-pass" placeholder="password"
                                style="width:130px; font-size:13px;">
                            <button class="btn btn-primary" id="mysql-connect-btn" onclick="mysqlConnect()"
                                style="white-space:nowrap; font-size:13px;">üîå Connect</button>
                            <button class="btn" id="mysql-disconnect-btn" onclick="mysqlDisconnect()"
                                style="display:none; white-space:nowrap; font-size:13px;">‚èè Disconnect</button>
                        </div>
                        <div id="mysql-status-badge"
                            style="font-size:12px; padding:4px 12px; border-radius:6px; background:var(--bg-tertiary); color:var(--text-muted);">
                            Not connected
                        </div>
                    </div>
                    <!-- Detection banner -->
                    <div id="mysql-detect-banner" style="margin-top:10px; display:none;"></div>
                </div>
            </div>

            <!-- Main Editor Layout -->
            <div id="mysql-editor-main" style="display:none; gap:16px; height:calc(100vh - 260px); min-height:400px;">
                <!-- Left Panel: Database Tree -->
                <div
                    style="width:260px; min-width:200px; display:flex; flex-direction:column; background:var(--bg-card); border:1px solid var(--border); border-radius:10px; overflow:hidden;">
                    <div
                        style="padding:10px 14px; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between;">
                        <span style="font-size:13px; font-weight:600; color:var(--text-primary);">üìÅ Databases</span>
                        <button class="btn-sm" onclick="mysqlLoadDatabases()"
                            style="padding:2px 8px; font-size:11px; background:var(--bg-tertiary); border:1px solid var(--border); border-radius:4px; color:var(--text-secondary); cursor:pointer;"
                            title="Refresh">üîÑ</button>
                    </div>
                    <div id="mysql-db-tree" style="flex:1; overflow-y:auto; padding:6px 0; font-size:13px;">
                        <div style="padding:16px; color:var(--text-muted); text-align:center; font-size:12px;">Connect
                            to see databases</div>
                    </div>
                </div>

                <!-- Right Panel: Content Area -->
                <div
                    style="flex:1; display:flex; flex-direction:column; background:var(--bg-card); border:1px solid var(--border); border-radius:10px; overflow:hidden; min-width:0;">
                    <!-- Tab Bar -->
                    <div style="display:flex; border-bottom:1px solid var(--border); background:var(--bg-secondary);">
                        <button class="mysql-tab active" data-tab="data" onclick="mysqlSwitchTab('data')"
                            style="padding:10px 20px; border:none; background:none; color:var(--text-primary); font-size:13px; font-weight:500; cursor:pointer; border-bottom:2px solid var(--accent-primary); transition:all 0.2s;">
                            üìä Data
                        </button>
                        <button class="mysql-tab" data-tab="structure" onclick="mysqlSwitchTab('structure')"
                            style="padding:10px 20px; border:none; background:none; color:var(--text-muted); font-size:13px; cursor:pointer; border-bottom:2px solid transparent; transition:all 0.2s;">
                            üèóÔ∏è Structure
                        </button>
                        <button class="mysql-tab" data-tab="query" onclick="mysqlSwitchTab('query')"
                            style="padding:10px 20px; border:none; background:none; color:var(--text-muted); font-size:13px; cursor:pointer; border-bottom:2px solid transparent; transition:all 0.2s;">
                            ‚ö° Query
                        </button>
                        <div style="flex:1;"></div>
                        <div id="mysql-table-info"
                            style="padding:10px 14px; font-size:12px; color:var(--text-muted); display:flex; align-items:center; gap:6px;">
                        </div>
                    </div>

                    <!-- Data Tab -->
                    <div id="mysql-tab-data" style="flex:1; display:flex; flex-direction:column; overflow:hidden;">
                        <div id="mysql-data-grid" style="flex:1; overflow:auto; font-size:12px;">
                            <div style="padding:40px; text-align:center; color:var(--text-muted);">
                                Select a table from the left panel to view data
                            </div>
                        </div>
                        <!-- Pagination -->
                        <div id="mysql-pagination"
                            style="display:none; padding:8px 14px; border-top:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; background:var(--bg-secondary); font-size:12px;">
                            <div style="color:var(--text-muted);">
                                <span id="mysql-row-info">0 rows</span>
                            </div>
                            <div style="display:flex; align-items:center; gap:8px;">
                                <button class="btn-sm" onclick="mysqlChangePage(-1)" id="mysql-prev-btn"
                                    style="padding:4px 10px; font-size:11px; background:var(--bg-tertiary); border:1px solid var(--border); border-radius:4px; color:var(--text-secondary); cursor:pointer;">‚óÄ
                                    Prev</button>
                                <span id="mysql-page-info"
                                    style="color:var(--text-secondary); min-width:80px; text-align:center;">Page
                                    1</span>
                                <button class="btn-sm" onclick="mysqlChangePage(1)" id="mysql-next-btn"
                                    style="padding:4px 10px; font-size:11px; background:var(--bg-tertiary); border:1px solid var(--border); border-radius:4px; color:var(--text-secondary); cursor:pointer;">Next
                                    ‚ñ∂</button>
                            </div>
                        </div>
                    </div>

                    <!-- Structure Tab -->
                    <div id="mysql-tab-structure" style="flex:1; overflow:auto; display:none; flex-direction:column;">
                        <!-- Structure Sub-tabs -->
                        <div
                            style="display:flex; border-bottom:1px solid var(--border); background:var(--bg-tertiary);">
                            <button class="mysql-struct-tab active" data-stab="columns"
                                onclick="mysqlStructSwitchTab('columns')"
                                style="padding:8px 16px; border:none; background:none; color:var(--text-primary); font-size:12px; font-weight:500; cursor:pointer; border-bottom:2px solid var(--accent-primary); transition:all 0.2s;">
                                üìã Columns
                            </button>
                            <button class="mysql-struct-tab" data-stab="indexes"
                                onclick="mysqlStructSwitchTab('indexes')"
                                style="padding:8px 16px; border:none; background:none; color:var(--text-muted); font-size:12px; cursor:pointer; border-bottom:2px solid transparent; transition:all 0.2s;">
                                üîë Indexes
                            </button>
                            <button class="mysql-struct-tab" data-stab="triggers"
                                onclick="mysqlStructSwitchTab('triggers')"
                                style="padding:8px 16px; border:none; background:none; color:var(--text-muted); font-size:12px; cursor:pointer; border-bottom:2px solid transparent; transition:all 0.2s;">
                                ‚ö° Triggers
                            </button>
                        </div>
                        <div id="mysql-struct-columns" style="flex:1; overflow:auto;">
                            <div style="padding:40px; text-align:center; color:var(--text-muted);">Select a table to
                                view its structure</div>
                        </div>
                        <div id="mysql-struct-indexes" style="flex:1; overflow:auto; display:none;"></div>
                        <div id="mysql-struct-triggers" style="flex:1; overflow:auto; display:none;"></div>
                    </div>

                    <!-- Query Tab -->
                    <div id="mysql-tab-query" style="flex:1; display:none; flex-direction:column;">
                        <div style="padding:10px 14px; border-bottom:1px solid var(--border);">
                            <div style="display:flex; align-items:center; gap:8px; margin-bottom:8px;">
                                <label
                                    style="font-size:12px; color:var(--text-secondary); white-space:nowrap;">Database:</label>
                                <select id="mysql-query-db" class="form-control"
                                    style="width:180px; font-size:12px; padding:4px 8px;"></select>
                                <div style="flex:1;"></div>
                                <button class="btn btn-primary" onclick="mysqlExecuteQuery()"
                                    style="font-size:12px; padding:6px 16px; white-space:nowrap;">‚ñ∂ Execute</button>
                            </div>
                            <textarea id="mysql-query-input"
                                placeholder="Enter SQL query here... (e.g. SELECT * FROM users LIMIT 10)"
                                style="width:100%; height:100px; font-family:var(--font-mono); font-size:13px; padding:10px; background:var(--bg-primary); color:var(--text-primary); border:1px solid var(--border); border-radius:6px; resize:vertical; outline:none;"></textarea>
                        </div>
                        <div id="mysql-query-result" style="flex:1; overflow:auto; font-size:12px;">
                            <div style="padding:30px; text-align:center; color:var(--text-muted);">
                                Write a query and click Execute
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Docker Containers Page ‚ïê‚ïê‚ïê -->
        <div id="page-containers" class="page-view" style="display:none;">
            <!-- Docker Runtime Status -->
            <div id="docker-runtime-banner" class="card" style="margin-bottom: 20px;">
                <div class="card-body" style="display: flex; align-items: center; justify-content: space-between;">
                    <div>
                        <span style="font-size: 20px;">üê≥</span>
                        <strong>Docker</strong>
                        <span id="docker-version" style="color: var(--text-muted); margin-left: 8px;"></span>
                        <span id="docker-status-badge" class="badge" style="margin-left: 8px;">Checking...</span>
                    </div>
                    <button id="docker-install-btn" class="btn btn-primary btn-sm" style="display:none;"
                        onclick="installRuntime('docker')">
                        Install Docker
                    </button>
                </div>
            </div>

            <!-- Docker Container Stats Summary -->
            <div id="docker-stats-summary" class="stats-grid" style="margin-bottom: 20px;"></div>

            <!-- Docker Containers List -->
            <div class="card">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>Docker Containers</h3>
                    <button class="btn btn-sm btn-primary" onclick="showDockerCreate()" style="font-size:12px;">+
                        Create Container</button>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Image</th>
                                <th>Status</th>
                                <th>IP Address</th>
                                <th>CPU</th>
                                <th>Memory</th>
                                <th>Ports</th>
                                <th>Autostart</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="docker-containers-table"></tbody>
                    </table>
                    <p id="docker-empty"
                        style="display:none; text-align:center; padding:20px; color: var(--text-muted);">
                        No containers found. Click <strong>+ Create Container</strong> to search Docker Hub and
                        deploy.
                    </p>
                </div>
            </div>

            <!-- Docker Images -->
            <div class="card" style="margin-top: 20px;">
                <div class="card-header">
                    <h3>Docker Images</h3>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Repository</th>
                                <th>Tag</th>
                                <th>ID</th>
                                <th>Size</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="docker-images-table"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê LXC Containers Page ‚ïê‚ïê‚ïê -->
        <div id="page-lxc" class="page-view" style="display:none;">
            <!-- LXC Runtime Status -->
            <div id="lxc-runtime-banner" class="card" style="margin-bottom: 20px;">
                <div class="card-body" style="display: flex; align-items: center; justify-content: space-between;">
                    <div>
                        <span style="font-size: 20px;">üì¶</span>
                        <strong>LXC</strong>
                        <span id="lxc-version" style="color: var(--text-muted); margin-left: 8px;"></span>
                        <span id="lxc-status-badge" class="badge" style="margin-left: 8px;">Checking...</span>
                    </div>
                    <button id="lxc-install-btn" class="btn btn-primary btn-sm" style="display:none;"
                        onclick="installRuntime('lxc')">
                        Install LXC
                    </button>
                </div>
            </div>

            <!-- LXC Containers List -->
            <div class="card">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>LXC Containers</h3>
                    <div style="display:flex; gap:8px;">
                        <button class="btn btn-sm" onclick="generateTransferToken()"
                            style="font-size:12px; background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border);">üîë
                            Import Token</button>
                        <button class="btn btn-sm btn-primary" onclick="showLxcCreate()" style="font-size:12px;">+
                            Create Container</button>
                    </div>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Version</th>
                                <th>State</th>
                                <th>IP Address</th>
                                <th>CPU</th>
                                <th>Memory</th>
                                <th>Autostart</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="lxc-containers-table"></tbody>
                    </table>
                    <p id="lxc-empty" style="display:none; text-align:center; padding:20px; color: var(--text-muted);">
                        No LXC containers found. Click <strong>+ Create Container</strong> to browse available
                        templates.
                    </p>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Inline Terminal Page ‚ïê‚ïê‚ïê -->
        <div id="page-terminal" class="page-view" style="display:none;">
            <div class="card" style="height: calc(100vh - 140px); display:flex; flex-direction:column;">
                <div class="card-header"
                    style="display:flex; justify-content:space-between; align-items:center; flex-shrink:0;">
                    <div style="display:flex; align-items:center; gap:10px;">
                        <h3>üíª Terminal</h3>
                        <span id="inline-term-name" style="color:var(--text-muted); font-size:13px;"></span>
                    </div>
                    <div style="display:flex; align-items:center; gap:8px;">
                        <span id="inline-term-status"
                            style="font-size:12px; padding:3px 10px; border-radius:12px; background:#333; color:#888;">Connecting...</span>
                        <button class="btn btn-sm" onclick="openConsole(inlineTermType || 'host', inlineTermName || '')"
                            title="Pop out to separate window">‚ÜóÔ∏è Pop Out</button>
                    </div>
                </div>
                <div id="inline-terminal-container"
                    style="flex:1; padding:4px; overflow:hidden; background:#0a0a0a; border-radius:0 0 8px 8px;"></div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Virtual Machines Page ‚ïê‚ïê‚ïê -->
        <div id="page-vms" class="page-view" style="display:none;">
            <div class="card">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>Virtual Machines (KVM/QEMU)</h3>
                    <button class="btn btn-sm btn-primary" onclick="showVmCreate()">+ Create VM</button>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Status</th>
                                <th>CPU/RAM</th>
                                <th>WolfNet IP</th>
                                <th>VNC</th>
                                <th>Autostart</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="vms-table"></tbody>
                    </table>
                    <p id="vms-empty" style="display:none; text-align:center; padding:20px; color: var(--text-muted);">
                        No virtual machines found. Click <strong>+ Create VM</strong> to start one.
                    </p>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê AI Agent Settings ‚ïê‚ïê‚ïê -->
        <!-- ‚ïê‚ïê‚ïê Settings Page (Tabbed) ‚ïê‚ïê‚ïê -->
        <div id="page-settings" class="page-view" style="display:none;">
            <div class="card">
                <div class="card-header" style="flex-direction:column; align-items:stretch; padding-bottom:0;">
                    <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:16px;">
                        <h3>‚öôÔ∏è Settings</h3>
                        <div style="font-size: 12px; color: var(--text-muted);">WolfStack configuration</div>
                    </div>
                    <div class="settings-tabs">
                        <button class="settings-tab-btn active" onclick="switchSettingsTab('appearance')">üé®
                            Appearance</button>
                        <button class="settings-tab-btn" onclick="switchSettingsTab('alerting')">üîî Alerting</button>
                        <button class="settings-tab-btn" onclick="switchSettingsTab('ai')">ü§ñ AI Agent</button>
                        <button class="settings-tab-btn" onclick="switchSettingsTab('backup')">üì¶ Config Backup</button>
                    </div>
                </div>
                <div class="card-body" style="padding:24px;">

                    <!-- ‚îÄ‚îÄ‚îÄ Appearance Tab ‚îÄ‚îÄ‚îÄ -->
                    <div id="settings-tab-appearance" class="settings-tab-panel active">
                        <h4 style="margin:0 0 8px 0; font-size:16px; font-weight:600;">Theme</h4>
                        <p style="font-size:13px; color:var(--text-muted); margin:0 0 20px 0;">Choose a visual theme for
                            the WolfStack dashboard. Your selection is saved locally.</p>
                        <div class="theme-grid" id="theme-grid">
                            <!-- Dark (Default) -->
                            <div class="theme-card active" onclick="applyTheme('dark')" data-theme-id="dark">
                                <div class="theme-preview">
                                    <div class="theme-preview-sidebar" style="background:#111827;"></div>
                                    <div class="theme-preview-main" style="background:#0a0e1a;">
                                        <div class="theme-preview-bar" style="background:#1a1f35;"></div>
                                        <div class="theme-preview-card" style="background:#1a1f35;">
                                            <div class="theme-preview-card-inner" style="background:#dc2626;"></div>
                                            <div class="theme-preview-card-inner" style="background:#10b981;"></div>
                                            <div class="theme-preview-card-inner" style="background:#f59e0b;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="theme-card-info">
                                    <div class="theme-card-name">WolfStack Dark</div>
                                    <div class="theme-card-desc">Default ‚Äî deep navy with red accents</div>
                                </div>
                            </div>
                            <!-- Light -->
                            <div class="theme-card" onclick="applyTheme('light')" data-theme-id="light">
                                <div class="theme-preview">
                                    <div class="theme-preview-sidebar"
                                        style="background:#ffffff; border-right:1px solid #e2e4ea;"></div>
                                    <div class="theme-preview-main" style="background:#f5f6fa;">
                                        <div class="theme-preview-bar" style="background:#ffffff;"></div>
                                        <div class="theme-preview-card" style="background:#ffffff;">
                                            <div class="theme-preview-card-inner" style="background:#dc2626;"></div>
                                            <div class="theme-preview-card-inner" style="background:#059669;"></div>
                                            <div class="theme-preview-card-inner" style="background:#d97706;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="theme-card-info">
                                    <div class="theme-card-name">Light</div>
                                    <div class="theme-card-desc">Clean white with red accents</div>
                                </div>
                            </div>
                            <!-- Midnight -->
                            <div class="theme-card" onclick="applyTheme('midnight')" data-theme-id="midnight">
                                <div class="theme-preview">
                                    <div class="theme-preview-sidebar" style="background:#0a0a0f;"></div>
                                    <div class="theme-preview-main" style="background:#000000;">
                                        <div class="theme-preview-bar" style="background:#111118;"></div>
                                        <div class="theme-preview-card" style="background:#111118;">
                                            <div class="theme-preview-card-inner" style="background:#06b6d4;"></div>
                                            <div class="theme-preview-card-inner" style="background:#818cf8;"></div>
                                            <div class="theme-preview-card-inner" style="background:#f43f5e;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="theme-card-info">
                                    <div class="theme-card-name">Midnight</div>
                                    <div class="theme-card-desc">Pure black OLED with cyan accents</div>
                                </div>
                            </div>
                            <!-- Datacenter -->
                            <div class="theme-card" onclick="applyTheme('datacenter')" data-theme-id="datacenter">
                                <div class="theme-preview">
                                    <div class="theme-preview-sidebar" style="background:#243040;"></div>
                                    <div class="theme-preview-main" style="background:#1d2733;">
                                        <div class="theme-preview-bar" style="background:#2a3849;"></div>
                                        <div class="theme-preview-card" style="background:#2a3849;">
                                            <div class="theme-preview-card-inner" style="background:#3ba4c4;"></div>
                                            <div class="theme-preview-card-inner" style="background:#2ea87e;"></div>
                                            <div class="theme-preview-card-inner" style="background:#e0a030;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="theme-card-info">
                                    <div class="theme-card-name">Datacenter</div>
                                    <div class="theme-card-desc">Utilitarian grey-blue with steel accents</div>
                                </div>
                            </div>
                            <!-- Forest -->
                            <div class="theme-card" onclick="applyTheme('forest')" data-theme-id="forest">
                                <div class="theme-preview">
                                    <div class="theme-preview-sidebar" style="background:#122218;"></div>
                                    <div class="theme-preview-main" style="background:#0c1a10;">
                                        <div class="theme-preview-bar" style="background:#1a3020;"></div>
                                        <div class="theme-preview-card" style="background:#1a3020;">
                                            <div class="theme-preview-card-inner" style="background:#22c55e;"></div>
                                            <div class="theme-preview-card-inner" style="background:#38bdf8;"></div>
                                            <div class="theme-preview-card-inner" style="background:#eab308;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="theme-card-info">
                                    <div class="theme-card-name">Forest</div>
                                    <div class="theme-card-desc">Dark green with emerald accents</div>
                                </div>
                            </div>
                            <!-- Amber Terminal -->
                            <div class="theme-card" onclick="applyTheme('amber')" data-theme-id="amber">
                                <div class="theme-preview">
                                    <div class="theme-preview-sidebar" style="background:#121008;"></div>
                                    <div class="theme-preview-main" style="background:#0a0800;">
                                        <div class="theme-preview-bar" style="background:#1a1610;"></div>
                                        <div class="theme-preview-card" style="background:#1a1610;">
                                            <div class="theme-preview-card-inner" style="background:#f0a000;"></div>
                                            <div class="theme-preview-card-inner" style="background:#88c020;"></div>
                                            <div class="theme-preview-card-inner" style="background:#e04020;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="theme-card-info">
                                    <div class="theme-card-name">Amber Terminal</div>
                                    <div class="theme-card-desc">Retro CRT hacker aesthetic</div>
                                </div>
                            </div>
                            <!-- Glass -->
                            <div class="theme-card" onclick="applyTheme('glass')" data-theme-id="glass">
                                <div class="theme-preview">
                                    <div class="theme-preview-sidebar" style="background:rgba(6,16,55,0.9);"></div>
                                    <div class="theme-preview-main"
                                        style="background:linear-gradient(135deg,rgba(20,80,220,0.7) 0%,rgba(10,40,160,0.8) 50%,rgba(5,20,100,0.9) 100%);">
                                        <div class="theme-preview-bar" style="background:rgba(60,130,255,0.3);"></div>
                                        <div class="theme-preview-card" style="background:rgba(10,25,75,0.6);">
                                            <div class="theme-preview-card-inner" style="background:#3b9eff;"></div>
                                            <div class="theme-preview-card-inner" style="background:#74c0ff;"></div>
                                            <div class="theme-preview-card-inner" style="background:#34d399;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="theme-card-info">
                                    <div class="theme-card-name">Glass</div>
                                    <div class="theme-card-desc">Dark blue glassmorphism with shimmer</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ‚îÄ‚îÄ‚îÄ Alerting Tab ‚îÄ‚îÄ‚îÄ -->
                    <div id="settings-tab-alerting" class="settings-tab-panel">
                        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;">
                            <div>
                                <h4 style="margin:0 0 4px 0;font-size:16px;font-weight:600;">Alerting & Notifications
                                </h4>
                                <p style="font-size:13px;color:var(--text-muted);margin:0;">Send alerts to Discord,
                                    Slack, or Telegram when system events occur.</p>
                            </div>
                            <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
                                <input type="checkbox" id="alerting-enabled"
                                    style="width:18px;height:18px;cursor:pointer;">
                                <span style="font-size:13px;font-weight:500;">Enable Alerting</span>
                            </label>
                        </div>

                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">
                            <!-- Left: Channels -->
                            <div>
                                <h4 style="margin:0 0 16px 0;font-size:14px;color:var(--accent-light);">üì° Notification
                                    Channels</h4>
                                <div class="form-group" style="margin-bottom:16px;">
                                    <label>Discord Webhook URL</label>
                                    <input type="text" id="alerting-discord" class="form-control"
                                        placeholder="https://discord.com/api/webhooks/...">
                                    <small style="color:var(--text-muted);">Server Settings ‚Üí Integrations ‚Üí
                                        Webhooks</small>
                                </div>
                                <div class="form-group" style="margin-bottom:16px;">
                                    <label>Slack Webhook URL</label>
                                    <input type="text" id="alerting-slack" class="form-control"
                                        placeholder="https://hooks.slack.com/services/...">
                                    <small style="color:var(--text-muted);">api.slack.com/apps ‚Üí Incoming
                                        Webhooks</small>
                                </div>
                                <div class="form-group" style="margin-bottom:12px;">
                                    <label>Telegram Bot Token</label>
                                    <input type="text" id="alerting-tg-token" class="form-control"
                                        placeholder="123456:ABC-DEF...">
                                </div>
                                <div class="form-group" style="margin-bottom:16px;">
                                    <label>Telegram Chat ID</label>
                                    <input type="text" id="alerting-tg-chat" class="form-control"
                                        placeholder="-1001234567890">
                                    <small style="color:var(--text-muted);">Talk to @BotFather, then @userinfobot for
                                        chat ID</small>
                                </div>

                                <div id="alerting-channel-status"
                                    style="font-size:12px;color:var(--text-muted);padding:8px 0;"></div>
                            </div>

                            <!-- Right: Thresholds & Events -->
                            <div>
                                <h4 style="margin:0 0 16px 0;font-size:14px;color:var(--accent-light);">‚ö° Alert Rules
                                </h4>
                                <div
                                    style="background:var(--bg-input);border:1px solid var(--border);border-radius:10px;padding:16px;margin-bottom:16px;">
                                    <div
                                        style="display:grid;grid-template-columns:1fr auto;gap:12px;align-items:center;">
                                        <label style="font-size:13px;">CPU Threshold</label>
                                        <div style="display:flex;align-items:center;gap:8px;">
                                            <input type="range" id="alerting-cpu" min="50" max="100" value="90"
                                                style="width:120px;"
                                                oninput="this.nextElementSibling.textContent=this.value+'%'">
                                            <span
                                                style="font-size:13px;font-family:'JetBrains Mono',monospace;min-width:40px;">90%</span>
                                        </div>
                                        <label style="font-size:13px;">Memory Threshold</label>
                                        <div style="display:flex;align-items:center;gap:8px;">
                                            <input type="range" id="alerting-memory" min="50" max="100" value="90"
                                                style="width:120px;"
                                                oninput="this.nextElementSibling.textContent=this.value+'%'">
                                            <span
                                                style="font-size:13px;font-family:'JetBrains Mono',monospace;min-width:40px;">90%</span>
                                        </div>
                                        <label style="font-size:13px;">Disk Threshold</label>
                                        <div style="display:flex;align-items:center;gap:8px;">
                                            <input type="range" id="alerting-disk" min="50" max="100" value="90"
                                                style="width:120px;"
                                                oninput="this.nextElementSibling.textContent=this.value+'%'">
                                            <span
                                                style="font-size:13px;font-family:'JetBrains Mono',monospace;min-width:40px;">90%</span>
                                        </div>
                                    </div>
                                </div>

                                <h4 style="margin:16px 0 12px 0;font-size:14px;color:var(--accent-light);">‚è±Ô∏è Check
                                    Interval</h4>
                                <div class="form-group" style="margin-bottom:16px;">
                                    <label style="font-size:13px;">How often to check all nodes for threshold
                                        alerts</label>
                                    <select id="alerting-check-interval" class="form-control" style="max-width:240px;">
                                        <option value="30">Every 30 seconds</option>
                                        <option value="60" selected>Every 1 minute</option>
                                        <option value="120">Every 2 minutes</option>
                                        <option value="300">Every 5 minutes</option>
                                        <option value="600">Every 10 minutes</option>
                                    </select>
                                    <small style="color:var(--text-muted);">Lower intervals = more responsive, higher
                                        intervals = less load on nodes</small>
                                </div>

                                <h4 style="margin:0 0 12px 0;font-size:14px;color:var(--accent-light);">üîî Events</h4>
                                <div style="display:grid;gap:10px;">
                                    <label
                                        style="display:flex;align-items:center;gap:8px;font-size:13px;cursor:pointer;">
                                        <input type="checkbox" id="alerting-evt-offline" checked
                                            style="width:16px;height:16px;"> Node goes offline
                                    </label>
                                    <label
                                        style="display:flex;align-items:center;gap:8px;font-size:13px;cursor:pointer;">
                                        <input type="checkbox" id="alerting-evt-restored" checked
                                            style="width:16px;height:16px;"> Node restored
                                    </label>
                                    <label
                                        style="display:flex;align-items:center;gap:8px;font-size:13px;cursor:pointer;">
                                        <input type="checkbox" id="alerting-evt-cpu" checked
                                            style="width:16px;height:16px;"> High CPU alert
                                    </label>
                                    <label
                                        style="display:flex;align-items:center;gap:8px;font-size:13px;cursor:pointer;">
                                        <input type="checkbox" id="alerting-evt-memory" checked
                                            style="width:16px;height:16px;"> High memory alert
                                    </label>
                                    <label
                                        style="display:flex;align-items:center;gap:8px;font-size:13px;cursor:pointer;">
                                        <input type="checkbox" id="alerting-evt-disk" checked
                                            style="width:16px;height:16px;"> High disk alert
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div style="margin-top:20px;display:flex;gap:12px;">
                            <button class="btn btn-primary" onclick="saveAlertingConfig()">üíæ Save Settings</button>
                            <button class="btn btn-sm" onclick="testAlerting()">üß™ Send Test Alert</button>
                        </div>
                    </div>

                    <!-- ‚îÄ‚îÄ‚îÄ AI Agent Tab ‚îÄ‚îÄ‚îÄ -->
                    <div id="settings-tab-ai" class="settings-tab-panel">
                        <!-- Status Banner -->
                        <div id="ai-status-banner" style="padding:16px;border-radius:12px;margin-bottom:20px;
                             background:var(--bg-input);border:1px solid var(--border);">
                            <div style="display:flex;align-items:center;gap:12px;">
                                <span style="font-size:32px;">üê∫</span>
                                <div>
                                    <div style="font-weight:600;font-size:14px;" id="ai-status-text">Checking status...
                                    </div>
                                    <div style="font-size:12px;color:var(--text-muted);" id="ai-status-detail">
                                        Loading...
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">
                            <!-- Left Column: Provider & Keys -->
                            <div>
                                <h4 style="margin:0 0 16px 0;font-size:14px;color:var(--accent-light);">üîë LLM Provider
                                </h4>
                                <div class="form-group" style="margin-bottom:16px;">
                                    <label>Provider</label>
                                    <select id="ai-provider" class="form-control" onchange="onAiProviderChange()">
                                        <option value="claude">Claude (Anthropic)</option>
                                        <option value="gemini">Gemini (Google)</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin-bottom:16px;">
                                    <label>Claude API Key</label>
                                    <input type="password" id="ai-claude-key" class="form-control"
                                        placeholder="sk-ant-...">
                                </div>
                                <div class="form-group" style="margin-bottom:16px;">
                                    <label>Gemini API Key</label>
                                    <input type="password" id="ai-gemini-key" class="form-control"
                                        placeholder="AIza...">
                                </div>
                                <div class="form-group" style="margin-bottom:16px;">
                                    <label>Model</label>
                                    <select id="ai-model" class="form-control">
                                        <option value="">Select a provider and enter API key first</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin-bottom:16px;">
                                    <label>Health Check Interval</label>
                                    <select id="ai-check-interval" class="form-control">
                                        <option value="15">Every 15 minutes</option>
                                        <option value="30">Every 30 minutes</option>
                                        <option value="60" selected>Every hour</option>
                                        <option value="360">Every 6 hours</option>
                                        <option value="1440">Daily</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Right Column: Email & Alerts -->
                            <div>
                                <h4 style="margin:0 0 16px 0;font-size:14px;color:var(--accent-light);">üìß Email Alerts
                                </h4>
                                <div class="form-group" style="margin-bottom:16px;">
                                    <label style="display:flex;align-items:center;gap:8px;">
                                        <input type="checkbox" id="ai-email-enabled"> Enable email alerts
                                    </label>
                                </div>
                                <div id="ai-email-fields">
                                    <div class="form-group" style="margin-bottom:12px;">
                                        <label>Send alerts to</label>
                                        <input type="email" id="ai-email-to" class="form-control"
                                            placeholder="admin@example.com">
                                    </div>
                                    <div class="form-group" style="margin-bottom:12px;">
                                        <label>SMTP Host</label>
                                        <input type="text" id="ai-smtp-host" class="form-control"
                                            placeholder="smtp.gmail.com">
                                    </div>
                                    <div class="form-group" style="margin-bottom:12px;">
                                        <label>SMTP Port</label>
                                        <input type="number" id="ai-smtp-port" class="form-control" value="587">
                                    </div>
                                    <div class="form-group" style="margin-bottom:12px;">
                                        <label>SMTP User</label>
                                        <input type="text" id="ai-smtp-user" class="form-control">
                                    </div>
                                    <div class="form-group" style="margin-bottom:12px;">
                                        <label>SMTP Password</label>
                                        <input type="password" id="ai-smtp-pass" class="form-control">
                                    </div>
                                    <div class="form-group" style="margin-bottom:12px;">
                                        <label>SMTP Encryption</label>
                                        <select id="ai-smtp-tls" class="form-control">
                                            <option value="starttls">STARTTLS (port 587)</option>
                                            <option value="tls">SSL/TLS (port 465)</option>
                                            <option value="none">None</option>
                                        </select>
                                    </div>
                                </div>

                                <h4 style="margin:20px 0 12px 0;font-size:14px;color:var(--accent-light);">üìä Recent
                                    Alerts
                                </h4>
                                <div id="ai-alerts-list" style="max-height:200px;overflow-y:auto;font-size:12px;">
                                    <div style="color:var(--text-muted);padding:12px;">No alerts yet</div>
                                </div>
                            </div>
                        </div>

                        <div style="margin-top:20px;display:flex;gap:12px;">
                            <button class="btn btn-primary" onclick="saveAiConfig()">üíæ Save Settings</button>
                            <button class="btn btn-sm" onclick="testAiConnection()">üß™ Test Connection</button>
                            <button class="btn btn-sm" onclick="sendTestEmail()">üìß Send Test Email</button>
                        </div>
                    </div>

                    <!-- ‚îÄ‚îÄ‚îÄ Config Backup Tab ‚îÄ‚îÄ‚îÄ -->
                    <div id="settings-tab-backup" class="settings-tab-panel">
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;">
                            <!-- Export -->
                            <div
                                style="background:var(--bg-input);border-radius:12px;padding:20px;border:1px solid var(--border);">
                                <h4 style="margin:0 0 8px 0;font-size:15px;">üì§ Export Config</h4>
                                <p style="font-size:13px;color:var(--text-muted);margin:0 0 16px 0;">
                                    Download all cluster nodes, AI settings, storage config, backup schedules,
                                    and IP mappings as a single JSON file.
                                </p>
                                <button class="btn btn-primary" onclick="exportConfig()" id="btn-export-config">
                                    üì• Download Config
                                </button>
                            </div>
                            <!-- Import -->
                            <div
                                style="background:var(--bg-input);border-radius:12px;padding:20px;border:1px solid var(--border);">
                                <h4 style="margin:0 0 8px 0;font-size:15px;">üì• Import Config</h4>
                                <p style="font-size:13px;color:var(--text-muted);margin:0 0 16px 0;">
                                    Upload a previously exported config file to restore cluster links,
                                    settings, and schedules on this server.
                                </p>
                                <input type="file" id="config-import-file" accept=".json" style="display:none;"
                                    onchange="importConfigFile(this)">
                                <button class="btn btn-primary"
                                    onclick="document.getElementById('config-import-file').click()">
                                    üì§ Upload & Import
                                </button>
                            </div>
                        </div>

                        <div
                            style="margin-top:20px;padding:16px;background:var(--bg-secondary);border-radius:8px;border:1px solid var(--border);">
                            <h4 style="margin:0 0 8px;font-size:14px;color:var(--text-muted);">‚ÑπÔ∏è What's included</h4>
                            <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;font-size:13px;">
                                <div>‚úÖ Cluster node links</div>
                                <div>‚úÖ AI agent config</div>
                                <div>‚úÖ Storage config</div>
                                <div>‚úÖ Backup schedules</div>
                                <div>‚úÖ IP mappings</div>
                                <div>‚úÖ PBS config</div>
                            </div>
                            <p style="font-size:12px;color:var(--text-muted);margin:8px 0 0;">
                                ‚ö†Ô∏è Does not include: login credentials, join tokens, TLS certificates, or container/VM
                                data.
                            </p>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Storage Manager ‚ïê‚ïê‚ïê -->
        <div id="page-storage" class="page-view" style="display:none;">
            <div class="card">
                <div class="card-header"
                    style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px;">
                    <h3>üíæ Storage Manager</h3>
                    <div style="display:flex; gap:8px;">
                        <button class="btn btn-sm"
                            style="background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border);"
                            onclick="showImportRcloneModal()">üì• Import rclone.conf</button>
                        <button class="btn btn-sm btn-primary" onclick="showCreateMountModal()">+ Add Mount</button>
                    </div>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Source</th>
                                <th>Mount Point</th>
                                <th>Status</th>
                                <th>Options</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="storage-mounts-table"></tbody>
                    </table>
                    <p id="storage-empty"
                        style="display:none; text-align:center; padding:20px; color: var(--text-muted);">
                        No storage mounts configured. Click <strong>+ Add Mount</strong> to add S3, NFS, directory,
                        or WolfDisk storage.
                    </p>
                </div>
            </div>
            <!-- ZFS Pools (shown if ZFS available) -->
            <div id="zfs-section" class="card" style="margin-top:20px; display:none;">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>üóÑÔ∏è ZFS Pools</h3>
                    <button class="btn btn-sm" onclick="loadZfsStatus()"
                        style="background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border); font-size:11px;">‚Üª
                        Refresh</button>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Pool</th>
                                <th>Size</th>
                                <th>Used</th>
                                <th>Free</th>
                                <th>Health</th>
                                <th>Frag</th>
                                <th>Capacity</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="zfs-pools-table"></tbody>
                    </table>
                    <!-- Expandable dataset/snapshot section -->
                    <div id="zfs-detail-section" style="margin-top:16px;"></div>
                </div>
            </div>

            <!-- Disk Partitions (always shown) -->
            <div id="disk-info-section" class="card" style="margin-top:20px;">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>üíø Node Disk Layout</h3>
                    <button class="btn btn-sm" onclick="loadDiskInfo()"
                        style="background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border); font-size:11px;">‚Üª
                        Refresh</button>
                </div>
                <div class="card-body">
                    <table class="data-table" id="disk-info-table">
                        <thead>
                            <tr>
                                <th>Device</th>
                                <th>Type</th>
                                <th>Model / Disk</th>
                                <th>Filesystem</th>
                                <th>Size</th>
                                <th>Mount Point(s)</th>
                                <th>Free Space</th>
                            </tr>
                        </thead>
                        <tbody id="disk-info-tbody">
                            <tr>
                                <td colspan="7" style="text-align:center; color:var(--text-muted); padding:20px;">
                                    Loading disk layout‚Ä¶</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê File Manager ‚ïê‚ïê‚ïê -->
        <div id="page-files" class="page-view" style="display:none;">
            <div class="card">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>üìÇ File Manager</h3>
                    <div style="display:flex; gap:8px;">
                        <button class="btn btn-sm btn-primary" onclick="showNewFolderModal()"
                            style="font-size:12px; padding:4px 12px;">+ New Folder</button>
                        <button class="btn btn-sm" onclick="triggerFileUpload()"
                            style="font-size:12px; padding:4px 12px; background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border);">üì§
                            Upload</button>
                    </div>
                </div>
                <div class="card-body">
                    <!-- Breadcrumb navigation -->
                    <div id="file-breadcrumb"
                        style="display:flex; align-items:center; gap:4px; padding:8px 0; font-size:14px; flex-wrap:wrap; margin-bottom:8px;">
                    </div>
                    <!-- Search -->
                    <div style="margin-bottom:12px;">
                        <input type="text" id="file-search-input" placeholder="üîç Search files and folders..."
                            oninput="filterFileList(this.value)"
                            style="width:100%; max-width:400px; padding:6px 12px; font-size:14px; border:1px solid var(--border); border-radius:6px; background:var(--bg-secondary); color:var(--text-primary); outline:none;">
                    </div>
                    <!-- Multi-select toolbar -->
                    <div id="file-selection-bar"
                        style="display:none; align-items:center; gap:12px; padding:8px 12px; margin-bottom:8px; background:var(--bg-tertiary); border-radius:6px; border:1px solid var(--accent);">
                        <span class="sel-count" style="font-size:13px; font-weight:600; color:var(--accent);"></span>
                        <button class="btn btn-sm"
                            style="font-size:12px;padding:4px 10px;background:var(--bg-secondary);color:var(--text-primary);border:1px solid var(--border);"
                            onclick="bulkChmod()">üîí Set Permissions</button>
                        <button class="btn btn-sm"
                            style="font-size:12px;padding:4px 10px;background:rgba(239,68,68,0.1);color:#ef4444;border:1px solid rgba(239,68,68,0.3);"
                            onclick="bulkDeleteFiles()">üóëÔ∏è Delete Selected</button>
                    </div>
                    <!-- File listing table -->
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width:30px;"><input type="checkbox" onchange="toggleSelectAll(this)"
                                        title="Select all"></th>
                                <th style="width:38%;">Name</th>
                                <th>Size</th>
                                <th>Modified</th>
                                <th>Permissions</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="file-list-table"></tbody>
                    </table>
                    <p id="file-empty" style="display:none; text-align:center; padding:20px; color:var(--text-muted);">
                        This directory is empty.
                    </p>
                </div>
            </div>
            <input type="file" id="file-upload-input" multiple style="display:none;" onchange="uploadFiles(this.files)">
        </div>

        <!-- ‚ïê‚ïê‚ïê PVE Resources (Proxmox VMs & Containers) ‚ïê‚ïê‚ïê -->
        <div id="page-pve-resources" class="page-view" style="display:none;">
            <div id="pve-resources-content">
                <div style="text-align:center; padding:40px; color:var(--text-muted);">Select a Proxmox node to view
                    resources.</div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê WolfNet Management ‚ïê‚ïê‚ïê -->
        <div id="page-wolfnet" class="page-view" style="display:none;">
            <!-- WolfNet Status Banner -->
            <div class="stats-grid" style="margin-bottom:20px;" id="wolfnet-stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Status</span>
                        <div class="stat-icon" id="wn-status-icon"
                            style="background:var(--success-bg); color:var(--success);">‚óè</div>
                    </div>
                    <div class="stat-value" id="wn-status-val">‚Äî</div>
                    <div class="stat-sub" id="wn-enabled-val"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Interface</span>
                    </div>
                    <div class="stat-value" id="wn-interface-val" style="font-size:18px;">‚Äî</div>
                    <div class="stat-sub" id="wn-ip-val"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Connected Peers</span>
                    </div>
                    <div class="stat-value" id="wn-connected-val">0</div>
                    <div class="stat-sub" id="wn-total-peers-val"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Actions</span>
                    </div>
                    <div class="stat-value" style="font-size:13px;">
                        <div style="display:flex; gap:6px; flex-wrap:wrap;">
                            <button class="btn btn-sm btn-success" onclick="wolfnetServiceAction('start')"
                                id="wn-btn-start">‚ñ∂ Start</button>
                            <button class="btn btn-sm" onclick="wolfnetServiceAction('restart')" id="wn-btn-restart"
                                style="background:var(--bg-tertiary); border:1px solid var(--border); color:var(--text-primary);">üîÑ
                                Restart</button>
                            <button class="btn btn-sm btn-danger" onclick="wolfnetServiceAction('stop')"
                                id="wn-btn-stop">‚èπ Stop</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Peers Table -->
            <div class="card" style="margin-bottom:20px;">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>üåê Peers</h3>
                    <div style="display:flex; gap:8px;">
                        <button class="btn btn-sm" onclick="loadWolfNet()"
                            style="background:var(--bg-tertiary); border:1px solid var(--border); color:var(--text-primary); font-size:11px;">‚Üª
                            Refresh</button>
                        <button class="btn btn-sm btn-primary" onclick="showAddPeerModal()" style="font-size:12px;">+
                            Add Peer</button>
                    </div>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>WolfNet IP</th>
                                <th>Endpoint</th>
                                <th>Status</th>
                                <th>Traffic</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="wolfnet-peers-table"></tbody>
                    </table>
                    <p id="wolfnet-peers-empty"
                        style="display:none; text-align:center; padding:20px; color:var(--text-muted);">
                        No peers configured. Click <strong>+ Add Peer</strong> to connect to another WolfNet node.
                    </p>
                </div>
            </div>


            <!-- Settings Cards -->
            <div class="card" style="margin-bottom:20px;">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>‚öôÔ∏è Network Settings</h3>
                    <button class="btn btn-primary btn-sm" onclick="saveWolfNetSettings()">üíæ Save &amp;
                        Restart</button>
                </div>
                <div class="card-body">
                    <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:16px;">
                        <div class="form-group">
                            <label
                                style="font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Interface</label>
                            <input type="text" id="wn-cfg-interface" class="form-control" placeholder="wolfnet0"
                                style="font-family:var(--font-mono); font-size:13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size:12px; color:var(--text-secondary); margin-bottom:4px;">WolfNet
                                IP Address</label>
                            <input type="text" id="wn-cfg-address" class="form-control" placeholder="10.10.10.1"
                                style="font-family:var(--font-mono); font-size:13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Subnet
                                Mask</label>
                            <input type="number" id="wn-cfg-subnet" class="form-control" value="24" min="8" max="30"
                                style="font-family:var(--font-mono); font-size:13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Listen
                                Port</label>
                            <input type="number" id="wn-cfg-port" class="form-control" value="9600"
                                style="font-family:var(--font-mono); font-size:13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size:12px; color:var(--text-secondary); margin-bottom:4px;">MTU</label>
                            <input type="number" id="wn-cfg-mtu" class="form-control" value="1400"
                                style="font-family:var(--font-mono); font-size:13px;">
                        </div>
                        <div class="form-group">
                            <label
                                style="font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Options</label>
                            <div style="display:flex; gap:12px; padding-top:6px;">
                                <label
                                    style="display:flex; align-items:center; gap:4px; font-size:12px; cursor:pointer;">
                                    <input type="checkbox" id="wn-cfg-gateway"> Gateway
                                </label>
                                <label
                                    style="display:flex; align-items:center; gap:4px; font-size:12px; cursor:pointer;">
                                    <input type="checkbox" id="wn-cfg-discovery" checked> Discovery
                                </label>
                            </div>
                        </div>
                    </div>
                    <div id="wn-node-identity"
                        style="margin-top:16px; padding:12px; background:var(--bg-primary); border:1px solid var(--border); border-radius:8px; display:none;">
                        <h4 style="font-size:12px; color:var(--text-secondary); margin-bottom:8px;">üîë This Node's
                            Identity</h4>
                        <div style="display:grid; grid-template-columns: auto 1fr; gap:4px 12px; font-size:12px;">
                            <span style="color:var(--text-muted);">Hostname:</span>
                            <span id="wn-local-hostname" style="font-family:var(--font-mono);"></span>
                            <span style="color:var(--text-muted);">Public Key:</span>
                            <span id="wn-local-pubkey"
                                style="font-family:var(--font-mono); word-break:break-all;"></span>
                        </div>
                    </div>
                    <details style="margin-top:16px;">
                        <summary style="cursor:pointer; font-size:12px; color:var(--text-muted); user-select:none;">
                            üìÑ Raw Configuration (/etc/wolfnet/config.toml)</summary>
                        <textarea id="wolfnet-config-editor" class="config-editor" spellcheck="false"
                            style="min-height:200px; margin-top:8px;"></textarea>
                    </details>
                </div>
            </div>
        </div>

        <!-- Add WolfNet Peer Modal -->
        <div class="modal-overlay" id="add-peer-modal">
            <div class="modal" style="max-width: 580px; width: 95%;">
                <div class="modal-header">
                    <h3>üîó Add WolfNet Peer</h3>
                    <button class="modal-close" onclick="closeAddPeerModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <!-- Mode tabs -->
                    <div
                        style="display:flex; gap:0; margin-bottom:20px; border:1px solid var(--border); border-radius:8px; overflow:hidden;">
                        <button id="peer-tab-lan" class="btn" onclick="setPeerMode('lan')"
                            style="flex:1; border:none; border-radius:0; font-size:13px; padding:10px; background:var(--accent-primary); color:white;">
                            üè† LAN Peer
                        </button>
                        <button id="peer-tab-internet" class="btn" onclick="setPeerMode('internet')"
                            style="flex:1; border:none; border-radius:0; font-size:13px; padding:10px; background:var(--bg-tertiary); color:var(--text-secondary);">
                            üåç Internet Peer
                        </button>
                    </div>

                    <!-- LAN Peer mode -->
                    <div id="peer-mode-lan">
                        <p style="font-size:13px; color:var(--text-secondary); margin-bottom:16px;">
                            Add a peer on your <strong>local network</strong>. Both machines must be able to reach
                            each other directly.
                            The peer will be auto-discovered if discovery is enabled.
                        </p>
                        <div class="form-group">
                            <label>Peer Name <span style="color:var(--danger)">*</span></label>
                            <input type="text" id="peer-name" class="form-control" placeholder="e.g. office-server">
                        </div>
                        <div class="form-group">
                            <label>WolfNet IP <span style="color:var(--danger)">*</span></label>
                            <input type="text" id="peer-ip" class="form-control" placeholder="e.g. 10.10.10.3">
                            <small style="color:var(--text-muted);">The peer's IP on the WolfNet overlay (e.g.
                                10.10.10.2, 10.10.10.3, etc.)</small>
                        </div>
                        <div class="form-group">
                            <label>Endpoint <small style="color:var(--text-muted);">(optional)</small></label>
                            <input type="text" id="peer-endpoint" class="form-control"
                                placeholder="e.g. 192.168.1.50:9600">
                            <small style="color:var(--text-muted);">Local IP:port ‚Äî leave empty for auto-discovery
                                on LAN</small>
                        </div>
                        <div class="form-group">
                            <label>Public Key <small style="color:var(--text-muted);">(optional)</small></label>
                            <input type="text" id="peer-public-key" class="form-control"
                                placeholder="base64 public key">
                            <small style="color:var(--text-muted);">If known, paste the peer's WolfNet public
                                key</small>
                        </div>
                    </div>

                    <!-- Internet Peer mode -->
                    <div id="peer-mode-internet" style="display:none;">
                        <p style="font-size:13px; color:var(--text-secondary); margin-bottom:16px;">
                            Connect a peer <strong>over the internet</strong>. Generate an invite token, then run
                            the join command on the remote machine.
                        </p>
                        <div id="invite-loading" style="text-align:center; padding:20px;">
                            <span style="font-size:24px;">‚è≥</span>
                            <p style="color:var(--text-muted); margin-top:8px;">Generating invite token...</p>
                        </div>
                        <div id="invite-result" style="display:none;">
                            <div
                                style="background:var(--bg-primary); border:1px solid var(--border); border-radius:8px; padding:16px; margin-bottom:16px;">
                                <div
                                    style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                                    <span style="font-size:12px; font-weight:600; color:var(--text-secondary);">üìã
                                        Run this on the remote machine:</span>
                                    <button class="btn btn-sm" onclick="copyInviteCommand()" style="font-size:11px;">üìã
                                        Copy</button>
                                </div>
                                <pre id="invite-command"
                                    style="font-family:var(--font-mono); font-size:11px; white-space:pre-wrap; word-break:break-all; margin:0; color:var(--accent-primary); background:var(--bg-secondary); padding:10px; border-radius:6px;"></pre>
                            </div>
                            <div
                                style="background:rgba(59,130,246,0.08); border:1px solid rgba(59,130,246,0.2); border-radius:8px; padding:12px; margin-bottom:12px;">
                                <h4 style="font-size:12px; color:#ef4444; margin-bottom:8px;">‚ÑπÔ∏è How it works</h4>
                                <ol
                                    style="font-size:12px; color:var(--text-secondary); margin:0; padding-left:16px; line-height:1.8;">
                                    <li>Copy the command above and run it on the remote machine</li>
                                    <li>It will output a <strong>reverse token</strong> ‚Äî copy that</li>
                                    <li>Run the reverse token command on <strong>this</strong> machine</li>
                                    <li>Restart WolfNet on both machines</li>
                                </ol>
                            </div>
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px; font-size:12px;">
                                <div style="padding:8px; background:var(--bg-tertiary); border-radius:6px;">
                                    <span style="color:var(--text-muted);">Your Public IP:</span><br>
                                    <strong id="invite-public-ip">‚Äî</strong>
                                </div>
                                <div style="padding:8px; background:var(--bg-tertiary); border-radius:6px;">
                                    <span style="color:var(--text-muted);">Your Endpoint:</span><br>
                                    <strong id="invite-endpoint">‚Äî</strong>
                                </div>
                            </div>
                        </div>
                        <div id="invite-error" style="display:none;">
                            <div
                                style="background:rgba(239,68,68,0.1); border:1px solid rgba(239,68,68,0.2); border-radius:8px; padding:16px; text-align:center;">
                                <span style="font-size:24px;">‚ùå</span>
                                <p id="invite-error-msg" style="color:#ef4444; margin-top:8px;"></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" id="peer-modal-footer-lan">
                    <button class="btn" onclick="closeAddPeerModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="addWolfNetPeer()">Add Peer</button>
                </div>
                <div class="modal-footer" id="peer-modal-footer-internet" style="display:none;">
                    <button class="btn btn-primary" onclick="closeAddPeerModal()">Done</button>
                </div>
            </div>
        </div>

        <!-- WolfNet Join Command Modal (shown after adding LAN peer) -->
        <div class="modal-overlay" id="wolfnet-join-modal">
            <div class="modal" style="max-width: 640px; width: 95%;">
                <div class="modal-header">
                    <h3>‚úÖ Peer Added ‚Äî Remote Setup</h3>
                    <button class="modal-close" onclick="closeJoinModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <p style="margin-bottom:12px; color:var(--text-secondary);">
                        The peer has been added to this node. Now configure the <strong>remote machine</strong>
                        to connect back. Add this to <code>/etc/wolfnet/config.toml</code> on the remote peer:
                    </p>
                    <div
                        style="background:var(--bg-primary); border:1px solid var(--border); border-radius:8px; padding:12px; margin-bottom:16px;">
                        <div
                            style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                            <span style="font-size:11px; color:var(--text-muted);">Peer config block for the remote
                                machine:</span>
                            <button class="btn btn-sm" onclick="copyJoinConfig()" style="font-size:11px;">üìã
                                Copy</button>
                        </div>
                        <pre id="wolfnet-join-config"
                            style="font-family:var(--font-mono); font-size:12px; white-space:pre-wrap; word-break:break-all; margin:0; color:var(--accent-primary);"></pre>
                    </div>
                    <p style="font-size:12px; color:var(--text-muted);">
                        Then run <code>sudo systemctl restart wolfnet</code> on the remote machine.
                    </p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" onclick="closeJoinModal()">Done</button>
                </div>
            </div>
        </div>



        <!-- ‚ïê‚ïê‚ïê Networking ‚ïê‚ïê‚ïê -->
        <div id="page-networking" class="page-view" style="display:none;">
            <!-- WolfNet Card -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>üîó WolfNet Overlay</h3>
                    <div id="wolfnet-actions"></div>
                </div>
                <div class="card-body" id="wolfnet-status-body">
                    <p style="color:var(--text-muted);">Loading WolfNet status...</p>
                </div>
            </div>

            <!-- Public IP Mappings Card -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header"
                    style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px;">
                    <h3>üåç Public IP Mappings</h3>
                    <button class="btn btn-sm btn-primary" onclick="showCreateMappingModal()" style="font-size:12px;">+
                        Add Mapping</button>
                </div>
                <div class="card-body">
                    <p style="font-size:12px; color:var(--text-muted); margin-bottom:12px;">
                        Map a public IP address to a WolfNet IP so containers, VMs, or LXC instances are reachable from
                        the internet.
                        WolfStack automatically manages the iptables DNAT/SNAT rules.
                    </p>
                    <div id="ip-mappings-grid" style="display:grid; grid-template-columns:repeat(2, 1fr); gap:12px;">
                    </div>
                    <p id="ip-mappings-empty"
                        style="display:none; text-align:center; padding:20px; color:var(--text-muted);">
                        No IP mappings configured. Click <strong>+ Add Mapping</strong> to route a public IP to a
                        WolfNet container or VM.
                    </p>
                </div>
            </div>

            <!-- Network Interfaces Card -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header"
                    style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px;">
                    <h3>üåê Network Interfaces</h3>
                    <button class="btn btn-sm btn-primary" onclick="showCreateVlanModal()">+ Add VLAN</button>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Interface</th>
                                <th>State</th>
                                <th>Addresses</th>
                                <th>MAC</th>
                                <th>Speed</th>
                                <th>MTU</th>
                                <th>Driver</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="net-interfaces-table"></tbody>
                    </table>
                </div>
            </div>

            <!-- DNS Card -->
            <div class="card">
                <div class="card-header">
                    <h3>üî§ DNS Configuration</h3>
                </div>
                <div class="card-body" id="dns-config-body">
                    <p style="color:var(--text-muted);">Loading DNS configuration...</p>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Help & Documentation ‚ïê‚ïê‚ïê -->
        <div id="page-docs" class="page-view" style="display:none;">
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header">
                    <h3>üìñ WolfStack Documentation</h3>
                    <div style="font-size: 12px; color: var(--text-muted);">Setup guides, troubleshooting, and reference
                    </div>
                </div>
                <div class="card-body" style="padding:24px; line-height:1.7;">
                    <h4 style="margin-bottom:12px; color:var(--accent-light);">What is WolfStack?</h4>
                    <p style="color:var(--text-secondary); margin-bottom:16px;">WolfStack is a unified server management
                        dashboard for managing containers, VMs, networking, storage, and more across multiple servers ‚Äî
                        all from a single web interface.
                        It supports both standalone Linux servers and Proxmox VE clusters.</p>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">‚ö° Quick Start</h4>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">Get your cluster up and running in
                        minutes:</p>
                    <ol style="color:var(--text-secondary); padding-left:20px; margin-bottom:16px;">
                        <li><strong>Install WolfStack on each server</strong> ‚Äî run this on every machine you want to
                            manage:
                            <pre
                                style="background:var(--bg-tertiary); padding:12px; border-radius:6px; overflow-x:auto; margin:8px 0 12px; color:var(--text);"><code>curl -sSL https://raw.githubusercontent.com/wolfsoftwaresystemsltd/WolfStack/master/setup.sh | sudo bash</code></pre>
                        </li>
                        <li><strong>Get the token from each server</strong> ‚Äî after installation, each server displays
                            its cluster token. You can also retrieve it later by running <code
                                style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">wolfstack --show-token</code>
                            on that server.</li>
                        <li><strong>Open the web UI</strong> on <strong>one</strong> server ‚Äî navigate to <code
                                style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">http://your-server-ip:8553</code>
                            in your browser and log in. You only need to log in to one server ‚Äî this will be your
                            management dashboard.</li>
                        <li><strong>Add your other nodes</strong> ‚Äî click the <strong>+ Add Server</strong> button in
                            the
                            sidebar and enter the address and token for each additional server or Proxmox server.</li>
                        <li><strong>Once you have added all the nodes, update WolfNet connections</strong> ‚Äî go into
                            your cluster settings and click
                            <strong>üîó Update WolfNet Connections</strong> to automatically set up peer-to-peer
                            networking between all your nodes.
                        </li>
                    </ol>
                    <p style="color:var(--text-secondary); font-size:12px; margin-bottom:12px;"><strong>Note:</strong>
                        You can add multiple WolfStack or Proxmox clusters to WolfStack's dashboard for a one-stop
                        server management shop.</p>
                    <div
                        style="background:rgba(16,185,129,0.08); border:1px solid rgba(16,185,129,0.2); border-radius:8px; padding:12px; margin-bottom:8px;">
                        <p style="color:#10b981; margin:0; font-size:13px;"><strong>‚úÖ That's it!</strong> Your nodes
                            will appear in the sidebar with live metrics, and you can manage containers, networking,
                            storage, and more from a single dashboard.</p>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-bottom:16px;">
                <div class="card-header">
                    <h3><span
                            style="display:inline-block;width:20px;height:20px;vertical-align:middle;margin-right:4px;"><svg
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
                                <rect x="3" y="2" width="18" height="6" rx="1" />
                                <rect x="3" y="10" width="18" height="6" rx="1" />
                                <rect x="3" y="18" width="18" height="4" rx="1" />
                                <circle cx="7" cy="5" r="1" fill="currentColor" />
                                <circle cx="7" cy="13" r="1" fill="currentColor" />
                                <circle cx="7" cy="20" r="1" fill="currentColor" />
                            </svg></span> Proxmox VE Integration</h3>
                    <div style="font-size: 12px; color: var(--text-muted);">How to connect and monitor Proxmox clusters
                    </div>
                </div>
                <div class="card-body" style="padding:24px; line-height:1.7;">
                    <h4 style="margin-bottom:12px; color:var(--accent-light);">Step 1: Create an API Token in Proxmox
                    </h4>
                    <ol style="color:var(--text-secondary); padding-left:20px; margin-bottom:16px;">
                        <li>Log into your Proxmox web UI (e.g. <code
                                style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">https://your-pve-host:8006</code>)
                        </li>
                        <li>Navigate to <strong>Datacenter ‚Üí Permissions ‚Üí API Tokens ‚Üí Add</strong></li>
                        <li>Set <strong>User</strong> to <code
                                style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">root@pam</code>
                            (or a dedicated monitoring user)</li>
                        <li>Choose a <strong>Token ID</strong> (e.g. <code
                                style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">wolfstack</code>)
                        </li>
                        <li>Uncheck <strong>Privilege Separation</strong> for full access</li>
                        <li><strong>Copy the Token ID and Secret</strong> ‚Äî Proxmox only shows the secret once!</li>
                    </ol>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Step 2: Set API Token Permissions</h4>
                    <div
                        style="background:var(--bg-tertiary); border:1px solid var(--border); border-radius:8px; padding:16px; margin-bottom:16px;">
                        <p style="color:var(--warning); font-weight:600; margin-bottom:8px;">‚ö†Ô∏è Important: Your API
                            token needs the correct permissions to read node status.</p>
                        <p style="color:var(--text-secondary); margin-bottom:12px;">Without these permissions, Proxmox
                            nodes will appear <strong>offline</strong> in WolfStack.</p>

                        <p style="color:var(--text); font-weight:600; margin-bottom:8px;">Option A: Via Proxmox Web UI
                        </p>
                        <ol style="color:var(--text-secondary); padding-left:20px; margin-bottom:12px;">
                            <li>Go to <strong>Datacenter ‚Üí Permissions ‚Üí Add ‚Üí API Token Permission</strong></li>
                            <li>Set <strong>Path</strong> to <code
                                    style="background:var(--bg-secondary);padding:2px 6px;border-radius:4px;">/</code>
                            </li>
                            <li>Select your <strong>API Token</strong> (e.g. <code
                                    style="background:var(--bg-secondary);padding:2px 6px;border-radius:4px;">root@pam!wolfstack</code>)
                            </li>
                            <li>Set <strong>Role</strong> to <code
                                    style="background:var(--bg-secondary);padding:2px 6px;border-radius:4px;">PVEAuditor</code>
                            </li>
                            <li>Check <strong>Propagate</strong> and click <strong>Add</strong></li>
                        </ol>

                        <p style="color:var(--text); font-weight:600; margin-bottom:8px;">Option B: Via Command Line
                            (SSH into Proxmox)</p>
                        <pre
                            style="background:var(--bg-secondary); padding:12px; border-radius:6px; overflow-x:auto; margin-bottom:12px; color:var(--text);"><code>pveum aclmod / -token 'root@pam!wolfstack' -role PVEAuditor</code></pre>

                        <p style="color:var(--text); font-weight:600; margin-bottom:8px;">Custom Role (Minimal
                            Permissions)</p>
                        <pre
                            style="background:var(--bg-secondary); padding:12px; border-radius:6px; overflow-x:auto; color:var(--text);"><code>pveum role add WolfStackMonitor -privs "Sys.Audit,VM.Audit,Datastore.Audit"
pveum aclmod / -token 'root@pam!wolfstack' -role WolfStackMonitor</code></pre>
                    </div>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Step 3: Add to WolfStack</h4>
                    <ol style="color:var(--text-secondary); padding-left:20px; margin-bottom:16px;">
                        <li>Click <strong>+ Add Server</strong> in the sidebar</li>
                        <li>Select <strong>Proxmox VE</strong> tab</li>
                        <li>Enter your <strong>Cluster Name</strong> (display name, e.g. "Production")</li>
                        <li>Enter <strong>Server Address</strong> (IP or hostname only, no <code
                                style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">https://</code>)
                        </li>
                        <li>Enter <strong>PVE Node Name</strong> (as shown in Proxmox sidebar, e.g. <code
                                style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">pve1</code>)
                        </li>
                        <li>Paste your <strong>Token ID</strong> and <strong>Token Secret</strong></li>
                        <li>Leave <strong>TLS Fingerprint</strong> blank (self-signed certs are accepted automatically)
                        </li>
                    </ol>
                    <p style="color:var(--text-secondary);">WolfStack will auto-discover all nodes in the cluster and
                        add them to the sidebar with live metrics.</p>
                </div>
            </div>

            <div class="card" style="margin-bottom:16px;">
                <div class="card-header">
                    <h3>üìã Container Cloning &amp; Migration</h3>
                    <div style="font-size: 12px; color: var(--text-muted);">How to clone and migrate LXC containers
                        between nodes</div>
                </div>
                <div class="card-body" style="padding:24px; line-height:1.7;">
                    <h4 style="margin-bottom:12px; color:var(--accent-light);">Cloning a Container</h4>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">Clone creates a full copy of an existing
                        container. You can clone locally or to another node in the cluster.</p>
                    <ol style="color:var(--text-secondary); padding-left:20px; margin-bottom:16px;">
                        <li>Right-click or use the ‚öô menu on a container and select <strong>Clone</strong></li>
                        <li>Enter a <strong>New Name</strong> for the cloned container</li>
                        <li>Choose a <strong>Target Node</strong> ‚Äî local or any node in the cluster</li>
                        <li>Select <strong>Storage</strong> from the dropdown (shows available Proxmox storage or
                            filesystem paths with free space)</li>
                        <li>Click <strong>Clone</strong> ‚Äî a progress modal shows real-time status</li>
                    </ol>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Migrating a Container</h4>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">Migration moves a container from one node
                        to another, removing the original after successful transfer.</p>
                    <ol style="color:var(--text-secondary); padding-left:20px; margin-bottom:16px;">
                        <li>Right-click or use the ‚öô menu on a container and select <strong>Migrate</strong></li>
                        <li>Select the <strong>Target Node</strong> from the dropdown, or choose <strong>External
                                Cluster</strong> for cross-cluster migration</li>
                        <li>Click <strong>Migrate</strong> to start</li>
                    </ol>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Migration Progress</h4>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">Migration shows a detailed step-by-step
                        progress panel with five phases:</p>
                    <div
                        style="background:var(--bg-tertiary); border:1px solid var(--border); border-radius:8px; padding:16px; margin-bottom:16px;">
                        <div
                            style="display:flex; flex-direction:column; gap:6px; font-size:13px; color:var(--text-secondary);">
                            <div>‚èπÔ∏è <strong>Stopping container</strong> ‚Äî gracefully stops the running container</div>
                            <div>üì¶ <strong>Creating archive</strong> ‚Äî exports the container to a tar/vzdump archive
                            </div>
                            <div>üì§ <strong>Transferring</strong> ‚Äî uploads the archive to the target node</div>
                            <div>üì• <strong>Importing</strong> ‚Äî creates the container on the target node from the
                                archive</div>
                            <div>üßπ <strong>Cleaning up</strong> ‚Äî removes the source container after successful import
                            </div>
                        </div>
                    </div>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">Each step shows a spinning indicator when
                        active, ‚úÖ when complete, or ‚ùå if it fails. An elapsed timer keeps you informed of the total
                        duration.</p>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Cross-Cluster Migration</h4>
                    <p style="color:var(--text-secondary);">To migrate to a different WolfStack cluster, select
                        <strong>External Cluster</strong> in the target dropdown and provide the remote server's URL and
                        API token. The container will be exported, uploaded to the external server, and imported there.
                    </p>
                </div>
            </div>

            <div class="card" style="margin-bottom:16px;">
                <div class="card-header">
                    <h3>‚¨ÜÔ∏è Node Settings &amp; Remote Upgrades</h3>
                    <div style="font-size: 12px; color: var(--text-muted);">Managing individual nodes and keeping
                        WolfStack up to date</div>
                </div>
                <div class="card-body" style="padding:24px; line-height:1.7;">
                    <h4 style="margin-bottom:12px; color:var(--accent-light);">Node Settings</h4>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">Click the ‚öôÔ∏è gear icon next to any node
                        in the sidebar to open <strong>Node Settings</strong>. Here you can:</p>
                    <ul style="color:var(--text-secondary); padding-left:20px; margin-bottom:16px;">
                        <li>View and edit the node's <strong>hostname</strong>, <strong>address</strong>, and
                            <strong>port</strong>
                        </li>
                        <li>Change the <strong>cluster name</strong> to move a node between cluster groups</li>
                        <li>Update <strong>PVE Token</strong> and <strong>TLS Fingerprint</strong> for Proxmox nodes
                        </li>
                        <li>See the installed and latest <strong>WolfStack version</strong></li>
                    </ul>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Version Checking</h4>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">Node Settings automatically checks the
                        installed WolfStack version against the latest release on GitHub:</p>
                    <div
                        style="background:var(--bg-tertiary); border:1px solid var(--border); border-radius:8px; padding:16px; margin-bottom:16px;">
                        <div
                            style="display:flex; flex-direction:column; gap:8px; font-size:13px; color:var(--text-secondary);">
                            <div>‚úÖ <strong>Up to date</strong> ‚Äî installed version matches or exceeds the latest release
                            </div>
                            <div>‚¨ÜÔ∏è <strong>Update available</strong> ‚Äî a newer version is available on GitHub</div>
                            <div>‚ùì <strong>Unknown</strong> ‚Äî version could not be detected (upgrade button still
                                available)</div>
                        </div>
                    </div>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Remote Upgrades</h4>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">When an update is available (or version
                        is unknown), an <strong>Upgrade</strong> button appears. Clicking it:</p>
                    <ol style="color:var(--text-secondary); padding-left:20px; margin-bottom:16px;">
                        <li>Opens a terminal console window connected to the target node</li>
                        <li>Runs the WolfStack upgrade script: <code
                                style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">curl -sSL https://raw.githubusercontent.com/wolfsoftwaresystemsltd/WolfStack/master/setup.sh | sudo bash</code>
                        </li>
                        <li>Shows live output as the upgrade progresses</li>
                        <li>Displays a restart message when the service restarts</li>
                    </ol>
                    <p style="color:var(--text-secondary);">After the upgrade completes, <strong>refresh your
                            browser</strong> and log in again. The version in the footer will reflect the new version.
                    </p>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Update Banner</h4>
                    <p style="color:var(--text-secondary);">WolfStack also checks for updates automatically every 6
                        hours. When a newer version is detected, a banner appears at the top of the page. Clicking the
                        upgrade button in the banner runs the same upgrade process on the currently selected node.</p>
                </div>
            </div>

            <div class="card" style="margin-bottom:16px;">
                <div class="card-header">
                    <h3>üîß Troubleshooting</h3>
                    <div style="font-size: 12px; color: var(--text-muted);">Common issues and solutions</div>
                </div>
                <div class="card-body" style="padding:24px; line-height:1.7;">
                    <h4 style="margin-bottom:12px; color:var(--accent-light);">Proxmox nodes showing offline</h4>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">This usually means the API token lacks
                        permissions. Check the logs:</p>
                    <pre
                        style="background:var(--bg-tertiary); padding:12px; border-radius:6px; overflow-x:auto; margin-bottom:12px; color:var(--text);"><code>sudo journalctl -u wolfstack -f | grep -i proxmox</code></pre>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">If you see <code
                            style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">403 Permission check failed (Sys.Audit)</code>,
                        follow the <strong>Proxmox VE Integration ‚Üí Step 2</strong> above.</p>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Ghost / duplicate nodes in sidebar</h4>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">WolfStack auto-cleans ghost nodes on
                        restart. If duplicates persist, restart the service:</p>
                    <pre
                        style="background:var(--bg-tertiary); padding:12px; border-radius:6px; overflow-x:auto; margin-bottom:12px; color:var(--text);"><code>sudo systemctl restart wolfstack</code></pre>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Remote WolfStack nodes not connecting
                    </h4>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">Ensure port <code
                            style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">8553</code> is
                        accessible from this server and that both nodes run the same version. Check cluster secret
                        matches.</p>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Container creation fails on Proxmox node
                    </h4>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">If creating a container on a Proxmox node
                        fails with template errors, try refreshing the page and switching to the correct node before
                        clicking <strong>Create</strong>. The template list is cached per node ‚Äî switching nodes will
                        fetch the correct templates (Proxmox <code
                            style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">pveam</code>
                        templates vs standalone LXC templates).</p>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Proxmox containers not connecting to
                        WolfNet</h4>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">Proxmox LXC containers use <code
                            style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">lxcbr0</code> for
                        WolfNet connectivity (not <code
                            style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">vmbr0</code>). If a
                        container can't reach WolfNet IPs:</p>
                    <ol style="color:var(--text-secondary); padding-left:20px; margin-bottom:16px;">
                        <li>Check the container's network config: <code
                                style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">pct config &lt;VMID&gt;</code>
                        </li>
                        <li>Verify it uses <code
                                style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">bridge=lxcbr0</code>
                            if WolfNet is enabled</li>
                        <li>Ensure <code
                                style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">lxcbr0</code>
                            is present: <code
                                style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">ip link show lxcbr0</code>
                        </li>
                    </ol>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Migration hangs or fails</h4>
                    <p style="color:var(--text-secondary); margin-bottom:8px;">Migration requires network connectivity
                        between nodes. Check:</p>
                    <ul style="color:var(--text-secondary); padding-left:20px; margin-bottom:16px;">
                        <li>Both nodes can reach each other on port <code
                                style="background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;">8553</code> (or
                            configured port)</li>
                        <li>The target node has enough disk space for the container archive</li>
                        <li>Large containers may take several minutes ‚Äî the progress panel shows elapsed time</li>
                    </ul>

                    <h4 style="margin:24px 0 12px; color:var(--accent-light);">Node version shows "unknown" in settings
                    </h4>
                    <p style="color:var(--text-secondary);">This means WolfStack couldn't detect the version on the
                        remote node, usually because the node is a Proxmox host without WolfStack installed, or the API
                        proxy isn't reachable. You can still click the <strong>Install / Upgrade</strong> button to
                        install or update WolfStack on that node.</p>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>üîó Useful Links</h3>
                </div>
                <div class="card-body" style="padding:24px;">
                    <div style="display:grid; grid-template-columns:repeat(auto-fill, minmax(240px, 1fr)); gap:12px;">
                        <a href="https://github.com/wolfsoftwaresystemsltd/WolfStack" target="_blank" rel="noopener"
                            style="display:flex;align-items:center;gap:10px;padding:12px 16px;background:var(--bg-tertiary);border:1px solid var(--border);border-radius:8px;color:var(--text);text-decoration:none;transition:border-color 0.2s;">
                            <span style="font-size:20px;">üì¶</span>
                            <div>
                                <div style="font-weight:600;font-size:13px;">GitHub Repository</div>
                                <div style="font-size:11px;color:var(--text-muted);">Source code & releases</div>
                            </div>
                        </a>
                        <a href="https://wolf.uk.com/" target="_blank" rel="noopener"
                            style="display:flex;align-items:center;gap:10px;padding:12px 16px;background:var(--bg-tertiary);border:1px solid var(--border);border-radius:8px;color:var(--text);text-decoration:none;transition:border-color 0.2s;">
                            <span style="font-size:20px;">üê∫</span>
                            <div>
                                <div style="font-weight:600;font-size:13px;">Wolf Software Systems</div>
                                <div style="font-size:11px;color:var(--text-muted);">Company website</div>
                            </div>
                        </a>
                        <a href="https://pve.proxmox.com/pve-docs/api-viewer/" target="_blank" rel="noopener"
                            style="display:flex;align-items:center;gap:10px;padding:12px 16px;background:var(--bg-tertiary);border:1px solid var(--border);border-radius:8px;color:var(--text);text-decoration:none;transition:border-color 0.2s;">
                            <span style="font-size:20px;"><span
                                    style="display:inline-block;width:20px;height:20px;"><svg viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="1.8">
                                        <rect x="3" y="2" width="18" height="6" rx="1" />
                                        <rect x="3" y="10" width="18" height="6" rx="1" />
                                        <rect x="3" y="18" width="18" height="4" rx="1" />
                                        <circle cx="7" cy="5" r="1" fill="currentColor" />
                                        <circle cx="7" cy="13" r="1" fill="currentColor" />
                                        <circle cx="7" cy="20" r="1" fill="currentColor" />
                                    </svg></span></span>
                            <div>
                                <div style="font-weight:600;font-size:13px;">Proxmox API Docs</div>
                                <div style="font-size:11px;color:var(--text-muted);">PVE REST API reference</div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create VLAN Modal -->
        <div class="modal-overlay" id="create-vlan-modal">
            <div class="modal" style="max-width: 480px; width: 95%;">
                <div class="modal-header">
                    <h3>üè∑Ô∏è Create VLAN</h3>
                    <button class="modal-close" onclick="closeCreateVlanModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Parent Interface</label>
                        <select id="vlan-parent" class="form-control"></select>
                    </div>
                    <div class="form-group">
                        <label>VLAN ID</label>
                        <input type="number" id="vlan-id" class="form-control" min="1" max="4094"
                            placeholder="e.g. 100">
                    </div>
                    <div class="form-group">
                        <label>Name (optional ‚Äî defaults to parent.vlanid)</label>
                        <input type="text" id="vlan-name" class="form-control" placeholder="e.g. mgmt-vlan">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeCreateVlanModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="createVlan()">Create VLAN</button>
                </div>
            </div>
        </div>

        <!-- Add IP Modal -->
        <div class="modal-overlay" id="add-ip-modal">
            <div class="modal" style="max-width: 480px; width: 95%;">
                <div class="modal-header">
                    <h3>‚ûï Add IP Address</h3>
                    <button class="modal-close" onclick="closeAddIpModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="add-ip-interface">
                    <div class="form-group">
                        <label>Interface: <strong id="add-ip-iface-name"></strong></label>
                    </div>
                    <div class="form-group">
                        <label>IP Address</label>
                        <input type="text" id="add-ip-address" class="form-control" placeholder="e.g. 192.168.1.100">
                    </div>
                    <div class="form-group">
                        <label>Prefix Length (CIDR)</label>
                        <input type="number" id="add-ip-prefix" class="form-control" value="24" min="1" max="128">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeAddIpModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="addIpAddress()">Add IP</button>
                </div>
            </div>
        </div>

        <!-- Create IP Mapping Modal -->
        <div class="modal-overlay" id="create-mapping-modal">
            <div class="modal" style="max-width: 860px; width: 95%;">
                <div class="modal-header">
                    <h3>üåç Create IP Mapping</h3>
                    <button class="modal-close" onclick="closeCreateMappingModal()">&times;</button>
                </div>
                <div class="modal-body"
                    style="display:grid; grid-template-columns:1fr 1fr; gap:20px; align-items:start;">
                    <!-- LEFT: Guide -->
                    <div>
                        <div
                            style="background:rgba(59,130,246,0.08); border:1px solid rgba(59,130,246,0.2); border-radius:8px; padding:14px; margin-bottom:12px;">
                            <h4 style="font-size:13px; color:var(--text-primary); margin-bottom:8px;">üìñ What does this
                                do?</h4>
                            <p style="font-size:12px; color:var(--text-secondary); margin:0 0 10px 0; line-height:1.6;">
                                IP Mapping creates <strong>iptables NAT rules</strong> that forward traffic from a
                                <strong>public IP</strong> on this server to a <strong>WolfNet IP</strong>
                                belonging to a Docker container, LXC container, or VM.
                            </p>
                            <div style="font-size:12px; color:var(--text-secondary); line-height:1.7;">
                                <strong>Step by step:</strong>
                                <ol style="margin:4px 0 0 16px; padding:0;">
                                    <li>Choose the <strong>Public IP</strong> ‚Äî the external IP users connect to</li>
                                    <li>Choose the <strong>WolfNet IP</strong> ‚Äî the container/VM receiving traffic</li>
                                    <li><em>Optionally</em> restrict to specific <strong>ports</strong> (e.g. 80,443)
                                    </li>
                                    <li>Select <strong>TCP</strong> or <strong>UDP</strong> when ports are specified
                                    </li>
                                </ol>
                            </div>
                        </div>
                        <div
                            style="background:rgba(239,68,68,0.08); border:1px solid rgba(239,68,68,0.2); border-radius:6px; padding:10px; font-size:11px; color:#ef4444; line-height:1.6; margin-bottom:12px;">
                            ‚ö†Ô∏è <strong>Safety:</strong> Critical ports are blocked (SSH 22, Proxmox 8006/8443,
                            WolfStack 8552, etc.) and any port currently in use on this server will be rejected
                            to prevent you from breaking services.
                        </div>
                        <div id="mapping-port-warnings"></div>
                    </div>

                    <!-- RIGHT: Form fields -->
                    <div>
                        <div class="form-group" style="margin-bottom:12px;">
                            <label>Public IP <span style="color:var(--danger)">*</span></label>
                            <div style="display:flex; gap:6px;">
                                <select id="mapping-public-ip-select" class="form-control"
                                    onchange="onMappingPublicIpSelect()" style="flex:1;">
                                    <option value="">‚Äî Select ‚Äî</option>
                                </select>
                                <input type="text" id="mapping-public-ip" class="form-control"
                                    placeholder="e.g. 203.0.113.4"
                                    style="flex:1; font-family:var(--font-mono); font-size:13px;">
                            </div>
                            <small style="color:var(--text-muted);">External IP on this server</small>
                        </div>

                        <div class="form-group" style="margin-bottom:12px;">
                            <label>WolfNet IP <span style="color:var(--danger)">*</span></label>
                            <div style="display:flex; gap:6px;">
                                <select id="mapping-wolfnet-ip-select" class="form-control"
                                    onchange="onMappingWolfnetIpSelect()" style="flex:1;">
                                    <option value="">‚Äî Select ‚Äî</option>
                                </select>
                                <input type="text" id="mapping-wolfnet-ip" class="form-control"
                                    placeholder="e.g. 10.10.10.104"
                                    style="flex:1; font-family:var(--font-mono); font-size:13px;">
                            </div>
                            <small style="color:var(--text-muted);">Container/VM to receive traffic</small>
                        </div>

                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-bottom:12px;">
                            <div class="form-group">
                                <label>Ports <small style="color:var(--text-muted);">(optional)</small></label>
                                <input type="text" id="mapping-ports" class="form-control" placeholder="e.g. 80,443"
                                    oninput="onMappingPortsInput()"
                                    style="font-family:var(--font-mono); font-size:13px;">
                                <small style="color:var(--text-muted);">Blank = all</small>
                            </div>
                            <div class="form-group">
                                <label>Protocol</label>
                                <select id="mapping-protocol" class="form-control">
                                    <option value="all">All (TCP + UDP)</option>
                                    <option value="tcp">TCP only</option>
                                    <option value="udp">UDP only</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Label <small style="color:var(--text-muted);">(optional)</small></label>
                            <input type="text" id="mapping-label" class="form-control"
                                placeholder="e.g. Web server, Game server">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeCreateMappingModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="createIpMapping()">Create Mapping</button>
                </div>
            </div>
        </div>

        <!-- Mount Progress Modal -->
        <div class="modal-overlay" id="mount-progress-modal">
            <div class="modal" style="max-width: 420px; width: 90%;">
                <div class="modal-header">
                    <h3 id="mount-progress-title">üíæ Mounting Storage</h3>
                </div>
                <div class="modal-body" style="text-align: center; padding: 32px 24px;">
                    <div id="mount-progress-spinner" style="font-size: 48px; margin-bottom: 16px;">‚è≥</div>
                    <div id="mount-progress-status" style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">
                        Connecting...</div>
                    <div id="mount-progress-detail"
                        style="font-size: 13px; color: var(--text-muted); word-break: break-word;"></div>
                </div>
                <div class="modal-footer" id="mount-progress-footer" style="display: none;">
                    <button class="btn btn-primary" onclick="closeMountProgress()">OK</button>
                </div>
            </div>
        </div>

        <!-- Create Storage Mount Modal -->
        <div class="modal-overlay" id="create-mount-modal">
            <div class="modal" style="max-width: 640px; width: 95%;">
                <div class="modal-header">
                    <h3>Add Storage Mount</h3>
                    <button class="modal-close" onclick="closeMountModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label>Name</label>
                            <input type="text" class="form-control" id="mount-name" placeholder="My S3 backup">
                        </div>
                        <div class="form-group">
                            <label>Type</label>
                            <select class="form-control" id="mount-type" onchange="onMountTypeChange()">
                                <option value="s3">‚òÅÔ∏è S3 / Object Storage</option>
                                <option value="nfs">üóÑÔ∏è NFS Share</option>
                                <option value="directory">üìÅ Directory (bind mount)</option>
                                <option value="wolfdisk">üê∫ WolfDisk</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Mount Point</label>
                            <input type="text" class="form-control" id="mount-point"
                                placeholder="/mnt/wolfstack/my-mount">
                            <small style="color:var(--text-muted); font-size:11px;">Leave blank for auto</small>
                        </div>

                        <!-- S3 Fields -->
                        <div id="s3-fields" style="grid-column: 1 / -1;">
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                                <div class="form-group">
                                    <label>Provider</label>
                                    <select class="form-control" id="s3-provider">
                                        <option value="AWS">Amazon S3</option>
                                        <option value="Cloudflare">Cloudflare R2</option>
                                        <option value="DigitalOcean">DigitalOcean Spaces</option>
                                        <option value="Wasabi">Wasabi</option>
                                        <option value="Backblaze">Backblaze B2</option>
                                        <option value="Minio">MinIO</option>
                                        <option value="Other">Other S3-compatible</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Bucket</label>
                                    <input type="text" class="form-control" id="s3-bucket" placeholder="my-bucket">
                                </div>
                                <div class="form-group">
                                    <label>Access Key ID</label>
                                    <input type="text" class="form-control" id="s3-access-key" placeholder="AKIA...">
                                </div>
                                <div class="form-group">
                                    <label>Secret Access Key</label>
                                    <input type="password" class="form-control" id="s3-secret-key" placeholder="secret">
                                </div>
                                <div class="form-group">
                                    <label>Region</label>
                                    <input type="text" class="form-control" id="s3-region" placeholder="us-east-1">
                                </div>
                                <div class="form-group">
                                    <label>Endpoint (optional)</label>
                                    <input type="text" class="form-control" id="s3-endpoint"
                                        placeholder="https://s3.example.com">
                                    <small style="color:var(--text-muted); font-size:11px;">For non-AWS
                                        providers</small>
                                </div>
                            </div>
                        </div>

                        <!-- NFS Fields -->
                        <div id="nfs-fields" style="grid-column: 1 / -1; display:none;">
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label>NFS Source</label>
                                    <input type="text" class="form-control" id="nfs-source"
                                        placeholder="192.168.1.100:/data/share">
                                    <small style="color:var(--text-muted); font-size:11px;">Format:
                                        server:/export/path</small>
                                </div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label>NFS Options</label>
                                    <input type="text" class="form-control" id="nfs-options" value="rw,soft,timeo=50"
                                        placeholder="rw,soft,timeo=50">
                                </div>
                            </div>
                        </div>

                        <!-- Directory Fields -->
                        <div id="dir-fields" style="grid-column: 1 / -1; display:none;">
                            <div class="form-group">
                                <label>Source Directory</label>
                                <input type="text" class="form-control" id="dir-source" placeholder="/data/shared">
                            </div>
                        </div>

                        <!-- WolfDisk Fields -->
                        <div id="wolfdisk-fields" style="grid-column: 1 / -1; display:none;">
                            <div class="form-group">
                                <label>WolfDisk Path</label>
                                <input type="text" class="form-control" id="wolfdisk-source"
                                    placeholder="/wolfdisk/data">
                                <small style="color:var(--text-muted); font-size:11px;">Path on the WolfDisk
                                    filesystem</small>
                            </div>
                        </div>

                        <!-- Global / Auto Mount options -->
                        <div class="form-group"
                            style="grid-column: 1 / -1; display:flex; gap:20px; padding-top:8px; border-top:1px solid var(--border);">
                            <label style="display:flex; align-items:center; gap:6px; cursor:pointer; font-size:13px;">
                                <input type="checkbox" id="mount-global"> üåê Global Mount
                                <small style="color:var(--text-muted); font-size:11px;">(replicate to all cluster
                                    nodes)</small>
                            </label>
                            <label style="display:flex; align-items:center; gap:6px; cursor:pointer; font-size:13px;">
                                <input type="checkbox" id="mount-auto" checked> ‚ö° Auto-mount on boot
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeMountModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="createStorageMount()">Create & Mount</button>
                </div>
            </div>
        </div>

        <!-- Import rclone.conf Modal -->
        <div class="modal-overlay" id="import-rclone-modal">
            <div class="modal" style="max-width: 600px; width: 95%;">
                <div class="modal-header">
                    <h3>üì• Import rclone.conf</h3>
                    <button class="modal-close" onclick="closeImportRcloneModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <p style="font-size:13px; color:var(--text-secondary); margin-bottom:12px;">
                        Paste your <code>rclone.conf</code> contents below. All S3-compatible remotes will be
                        imported as storage mounts.
                    </p>
                    <textarea id="rclone-config-paste" class="form-control" rows="12"
                        style="font-family: var(--font-mono); font-size:12px; resize:vertical;" placeholder="[myremote]
type = s3
provider = AWS
access_key_id = AKIA...
secret_access_key = ...
region = us-east-1"></textarea>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeImportRcloneModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="importRcloneConfig()">Import</button>
                </div>
            </div>
        </div>

        <!-- Edit Storage Mount Modal -->
        <div class="modal-overlay" id="edit-mount-modal">
            <div class="modal" style="max-width: 640px; width: 95%;">
                <div class="modal-header">
                    <h3>‚öôÔ∏è Edit Storage Mount</h3>
                    <button class="modal-close" onclick="closeEditMountModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="edit-mount-id">
                    <input type="hidden" id="edit-mount-type-value">
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label>Name</label>
                            <input type="text" class="form-control" id="edit-mount-name">
                        </div>
                        <div class="form-group">
                            <label>Type</label>
                            <input type="text" class="form-control" id="edit-mount-type-display" disabled
                                style="opacity:0.7; cursor:not-allowed;">
                        </div>
                        <div class="form-group">
                            <label>Mount Point</label>
                            <input type="text" class="form-control" id="edit-mount-point"
                                placeholder="/mnt/wolfstack/my-mount">
                        </div>

                        <!-- S3 Edit Fields -->
                        <div id="edit-s3-fields" style="grid-column: 1 / -1; display:none;">
                            <div
                                style="display:grid; grid-template-columns:1fr 1fr; gap:12px; padding:12px; background:var(--bg-secondary); border:1px solid var(--border); border-radius:8px;">
                                <div
                                    style="grid-column:1/-1; font-weight:600; font-size:13px; color:var(--text-primary); margin-bottom:4px;">
                                    ‚òÅÔ∏è S3 Configuration</div>
                                <div class="form-group">
                                    <label>Provider</label>
                                    <select class="form-control" id="edit-s3-provider">
                                        <option value="AWS">Amazon S3</option>
                                        <option value="Cloudflare">Cloudflare R2</option>
                                        <option value="DigitalOcean">DigitalOcean Spaces</option>
                                        <option value="Wasabi">Wasabi</option>
                                        <option value="Backblaze">Backblaze B2</option>
                                        <option value="Minio">MinIO</option>
                                        <option value="Other">Other S3-compatible</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Bucket</label>
                                    <input type="text" class="form-control" id="edit-s3-bucket" placeholder="my-bucket">
                                </div>
                                <div class="form-group">
                                    <label>Access Key ID</label>
                                    <input type="text" class="form-control" id="edit-s3-access-key"
                                        placeholder="AKIA...">
                                </div>
                                <div class="form-group">
                                    <label>Secret Access Key</label>
                                    <input type="password" class="form-control" id="edit-s3-secret-key"
                                        placeholder="Leave blank to keep unchanged">
                                </div>
                                <div class="form-group">
                                    <label>Region</label>
                                    <input type="text" class="form-control" id="edit-s3-region" placeholder="us-east-1">
                                </div>
                                <div class="form-group">
                                    <label>Endpoint (optional)</label>
                                    <input type="text" class="form-control" id="edit-s3-endpoint"
                                        placeholder="https://s3.example.com">
                                    <small style="color:var(--text-muted); font-size:11px;">For non-AWS
                                        providers</small>
                                </div>
                            </div>
                        </div>

                        <!-- NFS Edit Fields -->
                        <div id="edit-nfs-fields" style="grid-column: 1 / -1; display:none;">
                            <div
                                style="display:grid; grid-template-columns:1fr 1fr; gap:12px; padding:12px; background:var(--bg-secondary); border:1px solid var(--border); border-radius:8px;">
                                <div
                                    style="grid-column:1/-1; font-weight:600; font-size:13px; color:var(--text-primary); margin-bottom:4px;">
                                    üóÑÔ∏è NFS Configuration</div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label>NFS Source</label>
                                    <input type="text" class="form-control" id="edit-nfs-source"
                                        placeholder="192.168.1.100:/data/share">
                                    <small style="color:var(--text-muted); font-size:11px;">Format:
                                        server:/export/path</small>
                                </div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label>NFS Options</label>
                                    <input type="text" class="form-control" id="edit-nfs-options"
                                        placeholder="rw,soft,timeo=50">
                                </div>
                            </div>
                        </div>

                        <!-- Directory Edit Fields -->
                        <div id="edit-dir-fields" style="grid-column: 1 / -1; display:none;">
                            <div
                                style="padding:12px; background:var(--bg-secondary); border:1px solid var(--border); border-radius:8px;">
                                <div
                                    style="font-weight:600; font-size:13px; color:var(--text-primary); margin-bottom:8px;">
                                    üìÅ Directory Configuration</div>
                                <div class="form-group">
                                    <label>Source Directory</label>
                                    <input type="text" class="form-control" id="edit-dir-source"
                                        placeholder="/data/shared">
                                </div>
                            </div>
                        </div>

                        <!-- WolfDisk Edit Fields -->
                        <div id="edit-wolfdisk-fields" style="grid-column: 1 / -1; display:none;">
                            <div
                                style="padding:12px; background:var(--bg-secondary); border:1px solid var(--border); border-radius:8px;">
                                <div
                                    style="font-weight:600; font-size:13px; color:var(--text-primary); margin-bottom:8px;">
                                    üê∫ WolfDisk Configuration</div>
                                <div class="form-group">
                                    <label>WolfDisk Path</label>
                                    <input type="text" class="form-control" id="edit-wolfdisk-source"
                                        placeholder="/wolfdisk/data">
                                </div>
                            </div>
                        </div>

                        <!-- Global / Auto Mount options -->
                        <div class="form-group"
                            style="grid-column: 1 / -1; display:flex; gap:20px; padding-top:8px; border-top:1px solid var(--border);">
                            <label style="display:flex; align-items:center; gap:6px; cursor:pointer; font-size:13px;">
                                <input type="checkbox" id="edit-mount-global"> üåê Global Mount
                                <small style="color:var(--text-muted); font-size:11px;">(replicate to all cluster
                                    nodes)</small>
                            </label>
                            <label style="display:flex; align-items:center; gap:6px; cursor:pointer; font-size:13px;">
                                <input type="checkbox" id="edit-mount-auto"> ‚ö° Auto-mount on boot
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeEditMountModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="saveStorageMountEdit()">üíæ Save Changes</button>
                </div>
            </div>
        </div>


        <div class="modal-overlay" id="create-vm-modal">
            <div class="modal" style="max-width: 720px; width: 95%;">
                <div class="modal-header">
                    <h3>Create Virtual Machine</h3>
                    <button class="modal-close" onclick="closeVmCreate()">&times;</button>
                </div>
                <!-- Tab Nav -->
                <div style="display:flex; border-bottom:1px solid var(--border); background:var(--bg-secondary);">
                    <button class="vm-tab-btn active" data-tab="1" onclick="switchVmTab(1)"
                        style="flex:1; padding:10px 16px; border:none; background:none; color:var(--text-primary); font-size:13px; font-weight:600; cursor:pointer; border-bottom:2px solid transparent; transition:all .2s;">
                        <span style="margin-right:4px;">‚öôÔ∏è</span> General
                    </button>
                    <button class="vm-tab-btn" data-tab="2" onclick="switchVmTab(2)"
                        style="flex:1; padding:10px 16px; border:none; background:none; color:var(--text-muted); font-size:13px; font-weight:600; cursor:pointer; border-bottom:2px solid transparent; transition:all .2s;">
                        <span style="margin-right:4px;">üíæ</span> Disks
                    </button>
                    <button class="vm-tab-btn" data-tab="3" onclick="switchVmTab(3)"
                        style="flex:1; padding:10px 16px; border:none; background:none; color:var(--text-muted); font-size:13px; font-weight:600; cursor:pointer; border-bottom:2px solid transparent; transition:all .2s;">
                        <span style="margin-right:4px;">üåê</span> Network &amp; Boot
                    </button>
                </div>
                <div class="modal-body" style="min-height:280px;">
                    <!-- ‚ïê‚ïê‚ïê Tab 1: General ‚ïê‚ïê‚ïê -->
                    <div class="vm-tab-page" id="vm-tab-1">
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                            <div class="form-group" style="grid-column: 1 / -1;">
                                <label>Name</label>
                                <input type="text" class="form-control" id="new-vm-name" placeholder="my-vm">
                            </div>
                            <div class="form-group">
                                <label>CPUs</label>
                                <input type="number" class="form-control" id="new-vm-cpus" value="1" min="1">
                            </div>
                            <div class="form-group">
                                <label>Memory (MB)</label>
                                <input type="number" class="form-control" id="new-vm-memory" value="1024" min="256">
                            </div>
                        </div>
                    </div>

                    <!-- ‚ïê‚ïê‚ïê Tab 2: Disks ‚ïê‚ïê‚ïê -->
                    <div class="vm-tab-page" id="vm-tab-2" style="display:none;">
                        <!-- OS Disk (always present) -->
                        <div
                            style="padding:10px; background:var(--bg-secondary); border:1px solid var(--border); border-radius:8px; margin-bottom:8px;">
                            <div style="display:flex; align-items:center; gap:8px; margin-bottom:8px;">
                                <span
                                    style="font-weight:600; font-size:13px; color:var(--accent-light); min-width:60px;">OS
                                    Disk</span>
                                <span style="font-size:11px; color:var(--text-muted);">Primary boot disk
                                    (virtio)</span>
                            </div>
                            <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:8px;">
                                <div>
                                    <label
                                        style="display:block; font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Storage</label>
                                    <select id="new-vm-storage" class="form-control" style="font-size:13px;">
                                        <option value="">/var/lib/wolfstack/vms (default)</option>
                                    </select>
                                </div>
                                <div>
                                    <label
                                        style="display:block; font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Disk
                                        Size (GiB)</label>
                                    <input type="number" class="form-control" id="new-vm-disk" value="32" min="1"
                                        style="font-size:13px;">
                                </div>
                                <div>
                                    <label
                                        style="display:block; font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Bus</label>
                                    <select id="new-vm-os-bus" class="form-control" style="font-size:13px;">
                                        <option value="virtio" selected>VirtIO (fastest)</option>
                                        <option value="ide">IDE (Windows compatible)</option>
                                        <option value="sata">SATA</option>
                                    </select>
                                </div>
                            </div>
                            <div id="vm-bus-warning"
                                style="display:none; margin-top:6px; padding:6px 10px; background:var(--warning-bg, rgba(245,158,11,0.1)); border:1px solid var(--warning, #f59e0b); border-radius:6px; font-size:11px; color:var(--warning, #f59e0b);">
                                ‚ö†Ô∏è Windows doesn't include VirtIO drivers. Use <strong>IDE</strong> for Windows, or
                                attach VirtIO drivers ISO on the Boot tab.
                            </div>
                        </div>

                        <!-- Extra Disks Container (scrollable) -->
                        <div id="vm-extra-disks-container" style="max-height:240px; overflow-y:auto;"></div>

                        <button class="btn btn-sm" onclick="addVmDiskRow()"
                            style="margin-top:8px; font-size:12px; display:flex; align-items:center; gap:4px;">
                            ‚ûï Add Disk
                        </button>
                    </div>

                    <!-- ‚ïê‚ïê‚ïê Tab 3: Network & Boot ‚ïê‚ïê‚ïê -->
                    <div class="vm-tab-page" id="vm-tab-3" style="display:none;">
                        <div class="form-group">
                            <label>Installation ISO (Optional)</label>
                            <input type="text" class="form-control" id="new-vm-iso"
                                placeholder="/var/lib/wolfstack/isos/ubuntu.iso">
                            <small style="color:var(--text-muted);">Path to an OS installer ISO on the host</small>
                        </div>
                        <div class="form-group" style="margin-top:12px;">
                            <label>VirtIO Drivers ISO (Optional)</label>
                            <input type="text" class="form-control" id="new-vm-drivers-iso"
                                placeholder="/var/lib/wolfstack/isos/virtio-win.iso">
                            <small style="color:var(--text-muted);">Needed for Windows to see VirtIO disks. Download
                                from
                                <a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/virtio-win.iso"
                                    target="_blank" style="color:var(--accent-light);">fedorapeople.org</a></small>
                        </div>
                        <div class="form-group" style="margin-top:12px;">
                            <label>Network Adapter</label>
                            <select id="new-vm-net-model" class="form-control" style="font-size:13px;">
                                <option value="virtio">VirtIO (fastest, Linux)</option>
                                <option value="e1000">Intel e1000 (Windows compatible)</option>
                                <option value="rtl8139">Realtek RTL8139</option>
                            </select>
                            <small style="color:var(--text-muted);">Windows needs Intel e1000 ‚Äî VirtIO network
                                requires drivers</small>
                        </div>
                        <div class="form-group" style="margin-top:12px;">
                            <label>WolfNet IP (Optional)</label>
                            <input type="text" class="form-control" id="new-vm-wolfnet-ip"
                                placeholder="Auto-assign or e.g. 10.10.10.120">
                            <small style="color:var(--text-muted);">Leave blank for user-mode networking, or enter
                                an IP for WolfNet TAP networking</small>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="display:flex; justify-content:space-between;">
                    <div>
                        <button class="btn" id="vm-tab-back-btn" onclick="switchVmTab('prev')" style="display:none;">‚Üê
                            Back</button>
                    </div>
                    <div style="display:flex; gap:8px;">
                        <button class="btn" onclick="closeVmCreate()">Cancel</button>
                        <button class="btn btn-primary" id="vm-tab-next-btn" onclick="switchVmTab('next')">Next
                            ‚Üí</button>
                        <button class="btn btn-primary" id="vm-tab-create-btn" onclick="createVm()"
                            style="display:none;">Create</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Container Detail Modal ‚ïê‚ïê‚ïê -->
        <div class="modal-overlay" id="container-detail-modal">
            <div class="modal" style="max-width: 960px; width: 95%;">
                <div class="modal-header">
                    <h3 id="container-detail-title">Container Detail</h3>
                    <button class="modal-close" onclick="closeContainerDetail()">&times;</button>
                </div>
                <div class="modal-body" id="container-detail-body">
                </div>
            </div>
        </div>
        </div>
    </main>

    <!-- Add Server Modal -->
    <div class="modal-overlay" id="add-server-modal">
        <div class="modal" style="max-width: 640px; width: 95%;">
            <div class="modal-header">
                <h3>Add Server</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Node Type</label>
                    <select class="form-control" id="new-server-type" onchange="updateServerForm()">
                        <option value="wolfstack">üê∫ WolfStack</option>
                        <option value="proxmox">&#x1F5A5; Proxmox VE</option>
                    </select>
                </div>
                <div class="form-group" id="ws-cluster-field">
                    <label>Cluster Name</label>
                    <input type="text" class="form-control" id="new-server-cluster-name"
                        placeholder="WolfStack (default)">
                    <small style="color: var(--text-muted);">Optional: Group nodes in the sidebar</small>
                </div>
                <div class="form-group" id="ws-join-token-field">
                    <label>Join Token</label>
                    <input type="text" class="form-control" id="new-server-join-token"
                        placeholder="Paste the remote server's join token"
                        style="font-family: monospace; font-size: 13px;">
                    <small style="color: var(--text-muted);">Get this from the remote server's dashboard ‚Üí Settings ‚Üí
                        Join Token</small>
                </div>
                <div class="form-group">
                    <label>Server Address</label>
                    <input type="text" class="form-control" id="new-server-address"
                        placeholder="10.10.10.1 or hostname">
                    <small style="color: var(--text-muted);">IP or hostname only ‚Äî do not include https://</small>
                </div>
                <div class="form-group">
                    <label id="new-server-port-label">Port (default: 8553)</label>
                    <input type="number" class="form-control" id="new-server-port" value="8553">
                </div>
                <!-- Proxmox-specific fields -->
                <div id="pve-fields" style="display:none;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0 16px;">
                        <div class="form-group">
                            <label>Cluster Name</label>
                            <input type="text" class="form-control" id="new-pve-cluster-name"
                                placeholder="My Proxmox Cluster">
                            <small style="color: var(--text-muted);">Display name for the sidebar</small>
                        </div>
                        <div class="form-group">
                            <label>PVE Node Name</label>
                            <input type="text" class="form-control" id="new-pve-node-name"
                                placeholder="pve1 (as shown in Proxmox sidebar)">
                            <small style="color: var(--text-muted);">Others auto-discovered</small>
                        </div>
                        <div class="form-group">
                            <label>Token ID</label>
                            <input type="text" class="form-control" id="new-pve-token-id"
                                placeholder="root@pam!wolfstack">
                            <small style="color: var(--text-muted);">Datacenter ‚Üí Permissions ‚Üí API Tokens</small>
                        </div>
                        <div class="form-group">
                            <label>Token Secret</label>
                            <input type="text" class="form-control" id="new-pve-token-secret"
                                placeholder="a2e0dcfb-f3eb-4674-965d-0dda7974ba73">
                            <small style="color: var(--text-muted);">Shown only once when creating</small>
                        </div>
                        <div class="form-group" style="grid-column: span 2;">
                            <label>TLS Fingerprint (optional)</label>
                            <input type="text" class="form-control" id="new-pve-fingerprint"
                                placeholder="Leave blank for self-signed certs">
                        </div>
                        <div
                            style="grid-column: span 2; background:rgba(234,179,8,0.1); border:1px solid rgba(234,179,8,0.25); border-radius:8px; padding:14px; margin-top:4px;">
                            <div style="font-weight:600; font-size:13px; color:var(--warning); margin-bottom:6px;">‚ö†Ô∏è
                                API Token Permissions Required</div>
                            <p style="font-size:12px; color:var(--text-secondary); margin:0 0 8px;">Your token needs
                                <strong>PVEAuditor</strong> role to read node status, VMs, and containers. Without it,
                                nodes will show as offline.
                            </p>
                            <p style="font-size:12px; color:var(--text-secondary); margin:0 0 4px;"><strong>Web
                                    UI:</strong> Datacenter ‚Üí Permissions ‚Üí Add ‚Üí API Token Permission ‚Üí Path: <code
                                    style="background:var(--bg-tertiary);padding:1px 4px;border-radius:3px;font-size:11px;">/</code>
                                ‚Üí Role: <code
                                    style="background:var(--bg-tertiary);padding:1px 4px;border-radius:3px;font-size:11px;">PVEAuditor</code>
                                ‚Üí Propagate ‚úÖ</p>
                            <p style="font-size:12px; color:var(--text-secondary); margin:0;"><strong>CLI:</strong>
                                <code
                                    style="background:var(--bg-tertiary);padding:1px 4px;border-radius:3px;font-size:11px;">pveum aclmod / -token 'root@pam!wolfstack' -role PVEAuditor</code>
                            </p>
                        </div>
                    </div>
                </div>
                <p id="wolfstack-hint" style="font-size: 12px; color: var(--text-muted);">
                    If using WolfNet, enter the WolfNet IP (e.g. 10.10.10.x).
                    Otherwise, enter the server's regular IP or hostname.
                </p>
                <div id="ws-own-token-display"
                    style="background:var(--bg-tertiary); border:1px solid var(--border); border-radius:8px; padding:12px; margin-top:8px;">
                    <div style="font-size:12px; color:var(--text-muted); margin-bottom:6px;">üîë This server's join
                        token:</div>
                    <div style="display:flex; align-items:center; gap:8px;">
                        <code id="own-join-token"
                            style="flex:1; font-size:12px; word-break:break-all; color:var(--accent-primary);">Loading...</code>
                        <button onclick="copyOwnJoinToken()" class="btn-sm"
                            style="padding:4px 10px; background:var(--accent-primary); color:white; border:none; border-radius:4px; cursor:pointer; font-size:11px; white-space:nowrap;">üìã
                            Copy</button>
                    </div>
                    <small style="color: var(--text-muted); font-size:11px;">Share this token with other WolfStack
                        admins so they can add this server.</small>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeModal()">Cancel</button>
                <button class="btn btn-primary" onclick="addServer()">Add Server</button>
            </div>
        </div>
        <!-- Console Modal -->
        <div id="console-modal"
            style="position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);z-index:9999;display:none;align-items:center;justify-content:center;">
            <div
                style="width:90%;max-width:960px;height:80vh;display:flex;flex-direction:column;background:var(--bg-card,#1a1a2e);border:1px solid var(--border,#333);border-radius:12px;overflow:hidden;box-shadow:0 25px 50px rgba(0,0,0,0.5);">
                <div
                    style="padding:12px 20px;border-bottom:1px solid var(--border,#333);display:flex;align-items:center;justify-content:space-between;background:var(--bg-secondary,#16162a);">
                    <h3 id="console-title" style="margin:0;font-size:15px;">üíª Console</h3>
                    <button onclick="closeConsole()"
                        style="background:none;border:none;color:var(--text-primary,#fff);font-size:24px;cursor:pointer;padding:0 8px;">&times;</button>
                </div>
                <div style="flex:1;padding:4px;background:#0a0a0a;overflow:hidden;">
                    <div id="terminal-container" style="width:100%;height:100%;"></div>
                </div>
            </div>
        </div>

        <!-- Generic Confirm/Prompt Modal -->
        <div class="modal-overlay" id="wolf-dialog-modal">
            <div class="modal" style="max-width:460px;width:90%;">
                <div class="modal-header">
                    <h3 id="wolf-dialog-title">Confirm</h3>
                    <button class="modal-close" onclick="wolfDialogCancel()">&times;</button>
                </div>
                <div class="modal-body">
                    <p id="wolf-dialog-message"
                        style="font-size:14px;line-height:1.6;margin:0;color:var(--text-secondary);"></p>
                    <div id="wolf-dialog-input-wrap" style="display:none;margin-top:16px;">
                        <input type="text" id="wolf-dialog-input" class="form-control" autocomplete="off">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn" id="wolf-dialog-cancel-btn" onclick="wolfDialogCancel()">Cancel</button>
                    <button class="btn btn-primary" id="wolf-dialog-ok-btn" onclick="wolfDialogOk()">Confirm</button>
                </div>
            </div>
        </div>

        <!-- Toast Container -->
        <div class="toast-container" id="toast-container"></div>

        <script src="/js/app.js"></script>
        <script>
            // Check auth on page load
            fetch('/api/auth/check')
                .then(r => r.json())
                .then(data => {
                    if (!data.authenticated) {
                        window.location.href = '/login.html';
                    }
                })
                .catch(() => {
                    window.location.href = '/login.html';
                });

            async function handleLogout() {
                await fetch('/api/auth/logout', { method: 'POST' });
                window.location.href = '/login.html';
            }
        </script>
        <script>
            // Create AI Chat Bubble & Panel dynamically on document.body
            // to ensure they're not trapped inside any overflow:hidden ancestor
            (function () {
                // Inject pulse animation
                var styleEl = document.createElement('style');
                styleEl.textContent = '@keyframes ai-pulse{0%,100%{box-shadow:0 0 8px rgba(220,38,38,0.4),0 4px 20px rgba(0,0,0,0.4);}50%{box-shadow:0 0 24px rgba(220,38,38,0.8),0 4px 20px rgba(0,0,0,0.4);}}';
                document.head.appendChild(styleEl);

                // Bubble
                var bubble = document.createElement('div');
                bubble.id = 'ai-chat-bubble';
                bubble.title = 'Chat with AI Assistant';
                bubble.onclick = function () { toggleAiChat(); };
                bubble.style.cssText = 'position:fixed;bottom:24px;right:24px;width:56px;height:56px;border-radius:50%;' +
                    'background:linear-gradient(135deg,#dc2626,#f87171);color:#fff;' +
                    'display:none;align-items:center;justify-content:center;font-size:16px;font-weight:800;' +
                    'cursor:pointer;z-index:9999;animation:ai-pulse 2s ease-in-out infinite;' +
                    'transition:transform 0.2s;letter-spacing:1px;';
                bubble.textContent = 'AI';
                document.body.appendChild(bubble);

                // Panel
                var panel = document.createElement('div');
                panel.id = 'ai-chat-panel';
                panel.style.cssText = 'display:none;position:fixed;bottom:90px;right:24px;width:420px;height:540px;' +
                    'background:var(--bg-secondary,#1a1a2e);border:1px solid var(--border,#333);border-radius:16px;' +
                    'box-shadow:0 8px 40px rgba(0,0,0,0.5);z-index:9998;overflow:hidden;flex-direction:column;';
                panel.innerHTML =
                    '<div style="padding:16px 20px;background:linear-gradient(135deg,#dc2626,#f87171);display:flex;justify-content:space-between;align-items:center;">' +
                    '<div style="display:flex;align-items:center;gap:8px;">' +
                    '<span style="font-size:16px;font-weight:800;letter-spacing:1px;">AI</span>' +
                    '<div><div style="font-weight:600;color:#fff;font-size:14px;">WolfStack AI</div>' +
                    '<div id="ai-chat-status" style="font-size:11px;color:rgba(255,255,255,0.7);">Ready</div></div>' +
                    '</div>' +
                    '<div style="display:flex;gap:6px;">' +
                    '<button onclick="openAiSettings()" style="background:rgba(255,255,255,0.2);border:none;color:#fff;border-radius:8px;padding:6px 10px;cursor:pointer;font-size:12px;" title="AI Settings">‚öôÔ∏è</button>' +
                    '<button onclick="toggleAiChat()" style="background:rgba(255,255,255,0.2);border:none;color:#fff;border-radius:8px;padding:6px 10px;cursor:pointer;font-size:16px;" title="Close">‚úï</button>' +
                    '</div>' +
                    '</div>' +
                    '<div id="ai-chat-messages" style="flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:12px;">' +
                    '<div style="background:var(--bg-tertiary,#252540);border-radius:12px;padding:12px 16px;max-width:85%;align-self:flex-start;font-size:13px;line-height:1.5;color:var(--text,#eee);">' +
                    'üëã Hi! I\'m your WolfStack AI assistant. I can answer questions about your servers AND run commands across your cluster. Ask me anything!' +
                    '</div>' +
                    '</div>' +
                    '<div style="padding:12px 16px;border-top:1px solid var(--border,#333);display:flex;gap:8px;">' +
                    '<input type="text" id="ai-chat-input" placeholder="Ask something..." onkeydown="if(event.key===\'Enter\')sendAiMessage()" style="flex:1;padding:10px 14px;border-radius:10px;border:1px solid var(--border,#333);background:var(--bg-primary,#0f0f1a);color:var(--text,#eee);font-size:13px;outline:none;">' +
                    '<button onclick="sendAiMessage()" id="ai-send-btn" style="padding:10px 16px;border-radius:10px;border:none;background:#dc2626;color:#fff;cursor:pointer;font-size:13px;font-weight:600;transition:opacity 0.2s;">Send</button>' +
                    '</div>';
                document.body.appendChild(panel);

                // Show bubble only if AI is configured
                fetch('/api/ai/config').then(function (r) { return r.json(); }).then(function (cfg) {
                    if ((cfg.has_claude_key || cfg.has_gemini_key) && cfg.model) {
                        bubble.style.display = 'flex';
                    }
                }).catch(function () { });
            })();
        </script>

</body>

</html>