<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WolfStack ‚Äî Server Management</title>
    <meta name="description" content="WolfStack server management dashboard for the Wolf software suite">
    <link rel="icon" type="image/svg+xml" href="https://wolf.uk.com/wp-content/uploads/2026/01/Group-9.svg">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/xterm.min.css">
    <style>
        /* Map Styles */
        #world-map {
            background: var(--bg-card);
            border: 1px solid var(--border);
            z-index: 1;
        }

        .leaflet-container {
            background: var(--bg-card) !important;
            font-family: 'Inter', sans-serif;
        }

        .leaflet-popup-content-wrapper,
        .leaflet-popup-tip {
            background: var(--bg-secondary) !important;
            color: var(--text-primary) !important;
            box-shadow: var(--shadow-md) !important;
            border: 1px solid var(--border);
        }

        .leaflet-popup-close-button {
            color: var(--text-muted) !important;
        }
    </style>
</head>

<body>
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
        <div class="sidebar-logo">
            <div class="logo-icon"><img src="https://wolf.uk.com/wp-content/uploads/2026/01/Group-9.svg" alt="Wolf"
                    style="width:36px;height:36px;"></div>
            <div>
                <h1>WolfStack</h1>
                <span class="version">v6.4.2</span>
            </div>
        </div>
        <nav class="sidebar-nav">
            <div class="nav-section">
                <a class="nav-item active" data-page="datacenter" onclick="selectView('datacenter')">
                    <span class="icon">üè¢</span> Datacenter
                </a>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">Servers</div>
                <div id="server-tree">
                    <div style="padding: 8px 16px; color: var(--text-muted); font-size: 12px;">Loading...</div>
                </div>
            </div>
        </nav>
        <div class="sidebar-footer">
            <div id="update-banner" style="display:none;margin-bottom:8px;padding:8px 12px;border-radius:8px;
                 background:rgba(234,179,8,0.15);border:1px solid rgba(234,179,8,0.3);font-size:12px;
                 color:var(--text);text-align:center;cursor:pointer;"
                onclick="window.open('https://github.com/wolfsoftwaresystemsltd/WolfStack/releases','_blank')">
                üîî <span id="update-banner-text">Update available</span>
            </div>
            <button class="btn btn-sm" onclick="selectView('ai-settings')" style="width: 100%; margin-bottom: 8px;">
                ü§ñ AI Agent
            </button>
            <button class="btn btn-sm" onclick="openAddServerModal()" style="width: 100%; margin-bottom: 8px;">
                + Add Server
            </button>
            <button class="btn btn-sm" onclick="handleLogout()" style="width: 100%; margin-bottom: 12px;">
                üö™ Sign Out
            </button>
            <div class="copyright">
                &copy; 2026 <a href="https://wolf.uk.com/" target="_blank" rel="noopener">Wolf Software Systems Ltd</a>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Top Bar -->
        <header class="top-bar">
            <h2 id="page-title">Dashboard</h2>
            <div class="top-bar-actions">
                <span id="hostname-display" style="color: var(--text-secondary); font-size: 13px;"></span>
            </div>
        </header>

        <!-- Page Content -->
        <div class="page-content">
            <!-- ‚ïê‚ïê‚ïê Datacenter Overview ‚ïê‚ïê‚ïê -->
            <div id="page-datacenter" class="page-view">

                <!-- World Map -->
                <div class="card" style="margin-bottom: 24px; overflow: hidden;">
                    <div class="card-header">
                        <h3>üåç Global Infrastructure</h3>
                        <div style="font-size: 12px; color: var(--text-muted);">Live Server Locations</div>
                    </div>
                    <div id="world-map" style="height: 380px; width: 100%; border: none; border-radius: 0;"></div>
                </div>

                <div class="stats-grid" style="margin-bottom: 20px;">
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Total Servers</span>
                            <div class="stat-icon" style="background: var(--accent-glow); color: var(--accent-light);">
                                üñ•Ô∏è</div>
                        </div>
                        <div class="stat-value" id="dc-total-servers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Online</span>
                            <div class="stat-icon" style="background: var(--success-bg); color: var(--success);">‚úì</div>
                        </div>
                        <div class="stat-value" id="dc-online-servers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Offline</span>
                            <div class="stat-icon" style="background: var(--danger-bg); color: var(--danger);">‚úó</div>
                        </div>
                        <div class="stat-value" id="dc-offline-servers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Components</span>
                            <div class="stat-icon" style="background: var(--info-bg); color: var(--info);">üì¶</div>
                        </div>
                        <div class="stat-value" id="dc-total-components">0</div>
                    </div>
                </div>

                <!-- Server cards grid -->
                <div id="datacenter-servers" class="grid-2" style="gap: 20px;"></div>
            </div>

            <!-- ‚ïê‚ïê‚ïê Dashboard Page (per-server) ‚ïê‚ïê‚ïê -->
            <div id="page-dashboard" class="page-view" style="display:none;">

                <!-- System Details (Neofetch) -->
                <div class="card"
                    style="margin-bottom: 24px; background: linear-gradient(145deg, var(--card-bg), var(--bg-secondary)); border: 1px solid var(--border-color);">
                    <div style="display: flex; gap: 40px; align-items: flex-start; flex-wrap: wrap;">
                        <!-- Logo (ASCII-ish) -->
                        <!-- Logo (Text) -->
                        <div
                            style="flex-shrink: 0; display: flex; flex-direction: column; align-items: flex-start; justify-content: center; padding-right: 20px;">
                            <h1
                                style="color: var(--success); margin: 0; font-size: 32px; font-weight: 800; letter-spacing: -1px; line-height: 1; font-family: 'Inter', sans-serif;">
                                WolfStack</h1>
                            <div
                                style="color: var(--success); font-size: 16px; font-weight: 600; margin-top: 6px; opacity: 0.9; letter-spacing: 0.5px;">
                                v6.1.8</div>
                        </div>

                        <!-- Details -->
                        <div
                            style="flex-grow: 1; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;">
                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">os</span>
                                    <span id="neo-os" style="color: var(--text-primary);">...</span>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">host</span>
                                    <span id="neo-host" style="color: var(--text-primary);">...</span>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">kernel</span>
                                    <span id="neo-kernel" style="color: var(--text-primary);">...</span>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">uptime</span>
                                    <span id="neo-uptime" style="color: var(--text-primary);">...</span>
                                </div>
                            </div>

                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">cpu</span>
                                    <span id="neo-cpu"
                                        style="color: var(--text-primary); text-align: right; word-break: break-word;">...</span>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">memory</span>
                                    <span id="neo-memory" style="color: var(--text-primary);">...</span>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">shell</span>
                                    <span id="neo-shell" style="color: var(--text-primary);">wolf-agent</span>
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; border-bottom: 1px dashed var(--border-color); padding-bottom: 4px;">
                                    <span style="color: var(--accent); font-weight: 600;">public ip</span>
                                    <span id="neo-ip" style="color: var(--text-primary);">...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Server Header -->
                <div class="card"
                    style="margin-bottom: 24px; background: linear-gradient(135deg, rgba(26,31,53,0.9), rgba(13,18,37,0.95)); border-color: var(--border-light);">
                    <div class="card-body"
                        style="display: flex; align-items: center; justify-content: space-between; padding: 24px 32px;">
                        <div style="display: flex; align-items: center; gap: 20px;">
                            <div
                                style="width: 64px; height: 64px; background: var(--gradient-main); border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 32px; box-shadow: var(--shadow-glow);">
                                üñ•Ô∏è
                            </div>
                            <div>
                                <h2 style="font-size: 24px; margin-bottom: 4px; color: var(--text-primary); font-weight: 700;"
                                    id="server-header-hostname">Server</h2>
                                <div style="display: flex; gap: 16px; font-size: 13px; color: var(--text-secondary);">
                                    <span id="server-header-ip">127.0.0.1</span>
                                    <span>‚Ä¢</span>
                                    <span id="server-header-os">Linux</span>
                                    <span>‚Ä¢</span>
                                    <span id="server-header-uptime">Up: ‚Äî</span>
                                </div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 12px;">
                            <button class="btn btn-primary" onclick="selectView('terminal')">
                                <span class="icon">üíª</span> Terminal
                            </button>
                            <button class="btn" onclick="location.reload()">
                                <span class="icon">üîÑ</span> Refresh
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Main Metrics Grid -->
                <div class="grid-2" style="margin-bottom: 24px;">
                    <!-- CPU Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3>CPU Usage</h3>
                            <div class="stat-icon" style="background: var(--accent-glow); color: var(--accent-light);">‚ö°
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="display: flex; align-items: baseline; gap: 8px; margin-bottom: 8px;">
                                <div class="stat-value" id="cpu-value">‚Äî</div>
                                <div class="stat-sub" style="font-size: 14px;">Total Load</div>
                            </div>
                            <div class="progress-bar" style="height: 12px; margin-bottom: 16px;">
                                <div class="fill accent" id="cpu-bar" style="width: 0%"></div>
                            </div>
                            <div
                                style="font-size: 12px; color: var(--text-muted); padding-top: 12px; border-top: 1px solid var(--border);">
                                <span id="cpu-model">Unknown CPU</span>
                            </div>
                        </div>
                    </div>

                    <!-- Memory Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3>Memory Usage</h3>
                            <div class="stat-icon" style="background: var(--success-bg); color: var(--success);">üß†
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="display: flex; align-items: baseline; gap: 8px; margin-bottom: 8px;">
                                <div class="stat-value" id="mem-value">‚Äî</div>
                                <div class="stat-sub" style="font-size: 14px;">Used</div>
                            </div>
                            <div class="progress-bar" style="height: 12px; margin-bottom: 16px;">
                                <div class="fill success" id="mem-bar" style="width: 0%"></div>
                            </div>
                            <div
                                style="font-size: 12px; color: var(--text-muted); padding-top: 12px; border-top: 1px solid var(--border);">
                                <span id="mem-detail">‚Äî / ‚Äî</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid-2" style="margin-bottom: 24px;">
                    <!-- Disk Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3>Disk Usage (Root)</h3>
                            <div class="stat-icon" style="background: var(--warning-bg); color: var(--warning);">üíæ
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="display: flex; align-items: baseline; gap: 8px; margin-bottom: 8px;">
                                <div class="stat-value" id="disk-value">‚Äî</div>
                                <div class="stat-sub" style="font-size: 14px;">Used</div>
                            </div>
                            <div class="progress-bar" style="height: 12px; margin-bottom: 16px;">
                                <div class="fill warning" id="disk-bar" style="width: 0%"></div>
                            </div>
                            <div
                                style="font-size: 12px; color: var(--text-muted); padding-top: 12px; border-top: 1px solid var(--border);">
                                <span id="disk-detail">‚Äî / ‚Äî</span>
                            </div>
                        </div>
                    </div>

                    <!-- Network Card (No Bar) -->
                    <div class="card">
                        <div class="card-header">
                            <h3>Network Traffic</h3>
                            <div class="stat-icon" style="background: var(--info-bg); color: var(--info);">üåê</div>
                        </div>
                        <div class="card-body">
                            <div style="display: flex; align-items: baseline; gap: 8px; margin-bottom: 8px;">
                                <div class="stat-value" id="net-value">‚Äî</div>
                                <div class="stat-sub" style="font-size: 14px;">Total I/O</div>
                            </div>
                            <div style="height: 12px; margin-bottom: 16px;"></div> <!-- Spacer -->
                            <div
                                style="font-size: 12px; color: var(--text-muted); padding-top: 12px; border-top: 1px solid var(--border);">
                                <span id="net-detail">Rx: ‚Äî | Tx: ‚Äî</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Storage Table -->
                <div class="card">
                    <div class="card-header">
                        <h3>Filesystems</h3>
                    </div>
                    <div class="card-body" style="overflow-x: auto;">
                        <!-- Performance History -->
                        <h3 style="margin-bottom: 16px; margin-top: 32px; font-size: 16px; font-weight: 600;">
                            Performance History</h3>
                        <!-- Time Range Selector -->
                        <div id="time-range-selector" style="display: flex; gap: 6px; margin-bottom: 16px;">
                            <button class="btn btn-sm time-range-btn active" data-range="150"
                                onclick="setTimeRange(150)">5m</button>
                            <button class="btn btn-sm time-range-btn" data-range="300"
                                onclick="setTimeRange(300)">10m</button>
                        </div>
                        <div style="display: grid; gap: 20px; margin-bottom: 32px;">
                            <!-- CPU History -->
                            <div class="card chart-card" id="cpu-chart-card">
                                <div class="card-header"
                                    style="display:flex; justify-content:space-between; align-items:center;">
                                    <h3>CPU History</h3>
                                    <span id="cpu-live-value" class="chart-live-value"
                                        style="font-size:20px; font-weight:700; color:rgba(99,102,241,1); font-family:'JetBrains Mono',monospace;">‚Äî</span>
                                </div>
                                <div class="card-body" style="padding: 0; min-height: 200px; position: relative;">
                                    <canvas id="cpu-chart-canvas"
                                        style="width: 100%; height: 100%; display: block;"></canvas>
                                </div>
                            </div>
                            <!-- Memory History -->
                            <div class="card chart-card" id="mem-chart-card">
                                <div class="card-header"
                                    style="display:flex; justify-content:space-between; align-items:center;">
                                    <h3>Memory History</h3>
                                    <span id="mem-live-value" class="chart-live-value"
                                        style="font-size:20px; font-weight:700; color:rgba(16,185,129,1); font-family:'JetBrains Mono',monospace;">‚Äî</span>
                                </div>
                                <div class="card-body" style="padding: 0; min-height: 200px; position: relative;">
                                    <canvas id="mem-chart-canvas"
                                        style="width: 100%; height: 100%; display: block;"></canvas>
                                </div>
                            </div>
                            <!-- Network I/O History -->
                            <div class="card chart-card" id="net-chart-card">
                                <div class="card-header"
                                    style="display:flex; justify-content:space-between; align-items:center;">
                                    <h3>Network I/O</h3>
                                    <span id="net-live-value" class="chart-live-value"
                                        style="font-size:16px; font-weight:600; color:var(--info); font-family:'JetBrains Mono',monospace;">‚Äî</span>
                                </div>
                                <div class="card-body" style="padding: 0; min-height: 200px; position: relative;">
                                    <canvas id="net-chart-canvas"
                                        style="width: 100%; height: 100%; display: block;"></canvas>
                                </div>
                            </div>
                            <!-- Disk/Net History -->
                            <div class="card chart-card" id="disk-chart-card">
                                <div class="card-header"
                                    style="display:flex; justify-content:space-between; align-items:center;">
                                    <h3>Disk I/O History</h3>
                                    <div id="disk-chart-legend" style="display: flex; gap: 10px; font-size: 11px;">
                                    </div>
                                </div>
                                <div class="card-body" style="padding: 0; min-height: 200px; position: relative;">
                                    <canvas id="disk-chart-canvas"
                                        style="width: 100%; height: 100%; display: block;"></canvas>
                                </div>
                            </div>
                        </div>
                        <!-- Chart Tooltip (shared) -->
                        <div id="chart-tooltip"
                            style="display:none; position:fixed; z-index:1000; pointer-events:none; background:rgba(10,14,26,0.92); border:1px solid var(--border-light); border-radius:8px; padding:8px 12px; font-size:12px; font-family:'JetBrains Mono',monospace; color:var(--text-primary); box-shadow:0 4px 20px rgba(0,0,0,0.5); backdrop-filter:blur(8px);">
                        </div>

                        <!-- Storage Table (Moved) -->
                        <h3 style="margin-bottom: 16px; font-size: 16px; font-weight: 600;">Storage Usage</h3>
                        <div class="card">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Mount</th>
                                        <th>Type</th>
                                        <th>Used</th>
                                        <th>Available</th>
                                        <th>Total</th>
                                        <th>Usage</th>
                                    </tr>
                                </thead>
                                <tbody id="disk-table"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>





        </div>

        <!-- ‚ïê‚ïê‚ïê Components Page ‚ïê‚ïê‚ïê -->
        <div id="page-components" class="page-view" style="display:none;">
            <div class="components-grid" id="components-grid"></div>

            <!-- Install Scripts Section -->
            <div class="card" style="margin-top: 24px;">
                <div class="card-header">
                    <h3>üì• Install Scripts</h3>
                </div>
                <div class="card-body">
                    <p style="color: var(--text-muted); font-size: 13px; margin-bottom: 16px;">
                        Run these commands on any server or inside a container to install Wolf components.
                    </p>
                    <div style="display: grid; gap: 10px;">
                        <div
                            style="display: flex; align-items: center; gap: 12px; padding: 10px 14px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px;">
                            <span style="font-size: 18px; width: 28px; text-align: center;">üåê</span>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 13px;">WolfNet</div>
                                <code
                                    style="font-size: 11px; color: var(--text-muted); word-break: break-all;">curl -sSL https://raw.githubusercontent.com/wolfsoftwaresystemsltd/WolfScale/main/wolfnet/setup.sh | sudo bash</code>
                            </div>
                            <button class="btn btn-sm" onclick="copyInstallCmd('wolfnet')"
                                title="Copy command">üìã</button>
                        </div>
                        <div
                            style="display: flex; align-items: center; gap: 12px; padding: 10px 14px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px;">
                            <span style="font-size: 18px; width: 28px; text-align: center;">üõ°Ô∏è</span>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 13px;">WolfProxy</div>
                                <code
                                    style="font-size: 11px; color: var(--text-muted); word-break: break-all;">curl -sSL https://raw.githubusercontent.com/wolfsoftwaresystemsltd/WolfProxy/main/setup.sh | sudo bash</code>
                            </div>
                            <button class="btn btn-sm" onclick="copyInstallCmd('wolfproxy')"
                                title="Copy command">üìã</button>
                        </div>
                        <div
                            style="display: flex; align-items: center; gap: 12px; padding: 10px 14px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px;">
                            <span style="font-size: 18px; width: 28px; text-align: center;">üì°</span>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 13px;">WolfServe</div>
                                <code
                                    style="font-size: 11px; color: var(--text-muted); word-break: break-all;">curl -sSL https://raw.githubusercontent.com/wolfsoftwaresystemsltd/WolfServe/main/setup.sh | sudo bash</code>
                            </div>
                            <button class="btn btn-sm" onclick="copyInstallCmd('wolfserve')"
                                title="Copy command">üìã</button>
                        </div>
                        <div
                            style="display: flex; align-items: center; gap: 12px; padding: 10px 14px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px;">
                            <span style="font-size: 18px; width: 28px; text-align: center;">üíæ</span>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 13px;">WolfDisk</div>
                                <code
                                    style="font-size: 11px; color: var(--text-muted); word-break: break-all;">curl -sSL https://raw.githubusercontent.com/wolfsoftwaresystemsltd/WolfScale/main/setup.sh | sudo bash</code>
                            </div>
                            <button class="btn btn-sm" onclick="copyInstallCmd('wolfdisk')"
                                title="Copy command">üìã</button>
                        </div>
                        <div
                            style="display: flex; align-items: center; gap: 12px; padding: 10px 14px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px;">
                            <span style="font-size: 18px; width: 28px; text-align: center;">‚öñÔ∏è</span>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; font-size: 13px;">WolfScale</div>
                                <code
                                    style="font-size: 11px; color: var(--text-muted); word-break: break-all;">curl -sSL https://raw.githubusercontent.com/wolfsoftwaresystemsltd/WolfScale/main/setup_lb.sh | sudo bash</code>
                            </div>
                            <button class="btn btn-sm" onclick="copyInstallCmd('wolfscale')"
                                title="Copy command">üìã</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Component Detail Page ‚ïê‚ïê‚ïê -->
        <div id="page-component-detail" class="page-view" style="display:none;">
            <div style="margin-bottom: 16px;">
                <button class="btn btn-sm" onclick="navigateTo('components')" id="back-to-components">
                    ‚Üê Back to Components
                </button>
            </div>

            <div class="stats-grid" style="margin-bottom: 20px;">
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Status</span>
                        <div class="stat-icon" id="detail-status-icon"
                            style="background: var(--success-bg); color: var(--success);">‚óè</div>
                    </div>
                    <div class="stat-value" id="detail-status">‚Äî</div>
                    <div class="stat-sub" id="detail-active-since"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Memory</span>
                    </div>
                    <div class="stat-value" id="detail-memory">‚Äî</div>
                    <div class="stat-sub">current usage</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">PID</span>
                    </div>
                    <div class="stat-value" id="detail-pid">‚Äî</div>
                    <div class="stat-sub">main process ID</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Restarts</span>
                    </div>
                    <div class="stat-value" id="detail-restarts">‚Äî</div>
                    <div class="stat-sub">since last enable</div>
                </div>
            </div>

            <!-- Actions bar -->
            <div class="card" style="margin-bottom: 20px;">
                <div class="card-body" style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                    <span id="detail-component-icon" style="font-size: 24px;"></span>
                    <div style="flex: 1;">
                        <h3 id="detail-component-name" style="margin: 0;"></h3>
                        <div id="detail-component-desc" style="color: var(--text-muted); font-size: 13px;">
                        </div>
                    </div>
                    <button class="btn btn-success btn-sm" id="detail-btn-start"
                        onclick="detailServiceAction('start')">Start</button>
                    <button class="btn btn-sm" id="detail-btn-restart"
                        onclick="detailServiceAction('restart')">Restart</button>
                    <button class="btn btn-danger btn-sm" id="detail-btn-stop"
                        onclick="detailServiceAction('stop')">Stop</button>
                </div>
            </div>

            <!-- Config Editor -->
            <div class="card" style="margin-bottom: 20px;" id="detail-config-section">
                <div class="card-header">
                    <h3>Configuration</h3>
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <span id="detail-config-path"
                            style="font-size: 12px; color: var(--text-muted); font-family: 'JetBrains Mono', monospace;"></span>
                        <button class="btn btn-primary btn-sm" onclick="saveConfig()">üíæ Save</button>
                    </div>
                </div>
                <div class="card-body">
                    <textarea id="detail-config-editor" class="config-editor" spellcheck="false"></textarea>
                </div>
            </div>

            <!-- Logs -->
            <div class="card">
                <div class="card-header">
                    <h3>Journal Logs</h3>
                    <button class="btn btn-sm" onclick="refreshComponentDetail(currentComponent)">‚Üª
                        Refresh</button>
                </div>
                <div class="card-body">
                    <div id="detail-logs" class="log-viewer"></div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Services Page ‚ïê‚ïê‚ïê -->
        <div id="page-services" class="page-view" style="display:none;">
            <div class="card">
                <div class="card-header">
                    <h3>System Services</h3>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Service</th>
                                <th>Status</th>
                                <th>Enabled</th>
                                <th>Version</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="services-table"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Backups Page ‚ïê‚ïê‚ïê -->
        <div id="page-backups" class="page-view" style="display:none;">
            <!-- Backup Targets Card -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header"
                    style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px;">
                    <h3>üõ°Ô∏è Backup Manager</h3>
                    <div style="display:flex; gap:8px; align-items:center;">
                        <select id="backup-storage-select" class="form-control"
                            style="width:auto; min-width:220px; padding:5px 10px; font-size:12px;">
                            <option value="local:/var/lib/wolfstack/backups">üìÅ Local ‚Äî /var/lib/wolfstack/backups
                            </option>
                        </select>
                        <button class="btn btn-sm btn-primary" onclick="backupSelected()">‚ö° Backup Now</button>
                        <button class="btn btn-sm"
                            style="background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border);"
                            onclick="showScheduleSelectedModal()">üìÖ Schedule</button>
                    </div>
                </div>
                <div class="card-body">
                    <div style="margin-bottom:8px; display:flex; align-items:center; gap:12px;">
                        <label
                            style="font-size:13px; color:var(--text-secondary); cursor:pointer; display:flex; align-items:center; gap:6px;">
                            <input type="checkbox" id="backup-select-all"
                                onchange="toggleAllBackupTargets(this.checked)"> Select All
                        </label>
                        <span id="backup-selected-count" style="font-size:12px; color:var(--text-muted);">0
                            selected</span>
                    </div>
                    <div id="backup-targets-list"
                        style="display:grid; grid-template-columns:repeat(auto-fill, minmax(280px, 1fr)); gap:8px;">
                        <p style="text-align:center; padding:20px; color:var(--text-muted); grid-column:1/-1;">Loading
                            targets...</p>
                    </div>
                </div>
            </div>

            <!-- Backup History Card -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header">
                    <h3>üìã Backup History</h3>
                </div>
                <div class="card-body" style="overflow-x:auto;">
                    <table class="data-table" style="width:100%;">
                        <thead>
                            <tr>
                                <th>Target</th>
                                <th>Type</th>
                                <th>Storage</th>
                                <th>Size</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th style="text-align:right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="backups-table"></tbody>
                    </table>
                    <p id="backups-empty"
                        style="display:none; text-align:center; padding:20px; color: var(--text-muted);">
                        No backups yet. Select items above and click <strong>‚ö° Backup Now</strong>.
                    </p>
                </div>
            </div>

            <!-- Schedules Card -->
            <div class="card">
                <div class="card-header">
                    <h3>üìÖ Backup Schedules</h3>
                </div>
                <div class="card-body" style="overflow-x:auto;">
                    <table class="data-table" style="width:100%;">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Frequency</th>
                                <th>Time (UTC)</th>
                                <th>Targets</th>
                                <th>Storage</th>
                                <th>Retention</th>
                                <th>Enabled</th>
                                <th style="text-align:right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="schedules-table"></tbody>
                    </table>
                    <p id="schedules-empty"
                        style="display:none; text-align:center; padding:20px; color: var(--text-muted);">
                        No schedules configured. Select targets and click <strong>üìÖ Schedule</strong>.
                    </p>
                </div>
            </div>

            <!-- PBS Configuration Card -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>üì¶ Proxmox Backup Server</h3>
                    <div style="display:flex; gap:8px; align-items:center;">
                        <span id="pbs-status-badge" style="font-size:12px; padding:3px 10px; border-radius:10px;
                            background:var(--bg-tertiary); color:var(--text-muted);">Checking‚Ä¶</span>
                        <button class="btn btn-sm btn-primary" onclick="savePbsConfig()">üíæ Save</button>
                        <button class="btn btn-sm"
                            style="background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border);"
                            onclick="testPbsConnection()">üîå Test</button>
                    </div>
                </div>
                <div class="card-body">
                    <!-- Saved credentials summary (shown when config is saved) -->
                    <div id="pbs-config-saved" style="display:none;">
                        <div
                            style="display:grid; grid-template-columns:repeat(auto-fill, minmax(200px, 1fr)); gap:8px; margin-bottom:12px;">
                            <div><span style="font-size:11px; color:var(--text-muted);">Server</span><br><strong
                                    id="pbs-saved-server">‚Äî</strong></div>
                            <div><span style="font-size:11px; color:var(--text-muted);">Datastore</span><br><strong
                                    id="pbs-saved-datastore">‚Äî</strong></div>
                            <div><span style="font-size:11px; color:var(--text-muted);">User</span><br><strong
                                    id="pbs-saved-user">‚Äî</strong></div>
                            <div><span style="font-size:11px; color:var(--text-muted);">Auth</span><br><strong
                                    id="pbs-saved-auth">‚Äî</strong></div>
                        </div>
                        <button class="btn btn-sm" onclick="showPbsConfigForm()"
                            style="background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border);">‚úèÔ∏è
                            Edit Configuration</button>
                    </div>
                    <!-- Editable form (hidden after save) -->
                    <div id="pbs-config-form">
                        <div
                            style="display:grid; grid-template-columns:repeat(auto-fill, minmax(280px, 1fr)); gap:12px;">
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">Server</label>
                                <input type="text" id="pbs-server" class="form-control"
                                    placeholder="pbs.example.com:8007">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">Datastore</label>
                                <input type="text" id="pbs-datastore" class="form-control" placeholder="backups">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">Username</label>
                                <input type="text" id="pbs-user" class="form-control" placeholder="backup@pbs">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">Password <span
                                        style="color:var(--text-muted);">(or use API token below)</span></label>
                                <input type="password" id="pbs-password" class="form-control" placeholder="password">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">API Token Name <span
                                        style="color:var(--text-muted);">(optional)</span></label>
                                <input type="text" id="pbs-token-name" class="form-control" placeholder="wolfstack">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">API Token Secret <span
                                        style="color:var(--text-muted);">(optional)</span></label>
                                <input type="password" id="pbs-token-secret" class="form-control"
                                    placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">Namespace <span
                                        style="color:var(--text-muted);">(optional)</span></label>
                                <input type="text" id="pbs-namespace" class="form-control" placeholder="">
                            </div>
                            <div class="form-group">
                                <label style="font-size:12px; color:var(--text-secondary);">Fingerprint <span
                                        style="color:var(--text-muted);">(optional, for self-signed
                                        certs)</span></label>
                                <input type="text" id="pbs-fingerprint" class="form-control"
                                    placeholder="SHA-256 fingerprint">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PBS Snapshots Browser -->
            <div class="card" id="pbs-snapshots-card" style="display:none;">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>üóÇÔ∏è PBS Snapshots</h3>
                    <button class="btn btn-sm"
                        style="background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border);"
                        onclick="loadPbsSnapshots()">üîÑ Refresh</button>
                </div>
                <div class="card-body" style="overflow-x:auto;">
                    <table class="data-table" style="width:100%;">
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Name</th>
                                <th>Date</th>
                                <th>Size</th>
                                <th style="text-align:right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="pbs-snapshots-table"></tbody>
                    </table>
                    <p id="pbs-snapshots-empty"
                        style="display:none; text-align:center; padding:20px; color:var(--text-muted);">
                        No snapshots found on PBS server.
                    </p>
                </div>
            </div>
        </div>

        <!-- Schedule Modal (only needs name, frequency, time, retention ‚Äî targets come from checked items) -->
        <div id="create-schedule-modal" class="modal-overlay">
            <div class="modal" style="max-width:480px;">
                <div class="modal-header">
                    <h3>üìÖ Schedule Backup</h3>
                    <button class="modal-close" onclick="closeModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Schedule Name</label>
                        <input type="text" id="schedule-name" class="form-control" placeholder="Nightly Backup">
                    </div>
                    <div class="form-group">
                        <label>Frequency</label>
                        <select id="schedule-frequency" class="form-control">
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly">Monthly</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Time (UTC, HH:MM)</label>
                        <input type="text" id="schedule-time" class="form-control" placeholder="02:00" value="02:00">
                    </div>
                    <div class="form-group">
                        <label>Retention (keep N backups, 0 = unlimited)</label>
                        <input type="number" id="schedule-retention" class="form-control" value="7" min="0">
                    </div>
                    <p id="schedule-selected-summary" style="font-size:12px; color:var(--text-muted);"></p>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="createSchedule()">üìÖ Create Schedule</button>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Certificates Page ‚ïê‚ïê‚ïê -->
        <div id="page-certificates" class="page-view" style="display:none;">
            <div class="card">
                <div class="card-header">
                    <h3>SSL Certificates</h3>
                </div>
                <div class="card-body">
                    <div class="form-group">
                        <label>Domain Name</label>
                        <input type="text" class="form-control" id="cert-domain" placeholder="example.com">
                    </div>
                    <button class="btn btn-primary" onclick="requestCertificate()">
                        üîí Request Certificate (Let's Encrypt)
                    </button>
                    <p style="margin-top: 12px; font-size: 13px; color: var(--text-muted);">
                        Uses Certbot to obtain a free SSL certificate from Let's Encrypt.
                        Port 80 must be accessible from the internet.
                    </p>
                </div>
            </div>
        </div>



        <!-- ‚ïê‚ïê‚ïê Docker Containers Page ‚ïê‚ïê‚ïê -->
        <div id="page-containers" class="page-view" style="display:none;">
            <!-- Docker Runtime Status -->
            <div id="docker-runtime-banner" class="card" style="margin-bottom: 20px;">
                <div class="card-body" style="display: flex; align-items: center; justify-content: space-between;">
                    <div>
                        <span style="font-size: 20px;">üê≥</span>
                        <strong>Docker</strong>
                        <span id="docker-version" style="color: var(--text-muted); margin-left: 8px;"></span>
                        <span id="docker-status-badge" class="badge" style="margin-left: 8px;">Checking...</span>
                    </div>
                    <button id="docker-install-btn" class="btn btn-primary btn-sm" style="display:none;"
                        onclick="installRuntime('docker')">
                        Install Docker
                    </button>
                </div>
            </div>

            <!-- Docker Container Stats Summary -->
            <div id="docker-stats-summary" class="stats-grid" style="margin-bottom: 20px;"></div>

            <!-- Docker Containers List -->
            <div class="card">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>Docker Containers</h3>
                    <button class="btn btn-sm btn-primary" onclick="showDockerCreate()" style="font-size:12px;">+
                        Create Container</button>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Image</th>
                                <th>Status</th>
                                <th>IP Address</th>
                                <th>CPU</th>
                                <th>Memory</th>
                                <th>Ports</th>
                                <th>Autostart</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="docker-containers-table"></tbody>
                    </table>
                    <p id="docker-empty"
                        style="display:none; text-align:center; padding:20px; color: var(--text-muted);">
                        No containers found. Click <strong>+ Create Container</strong> to search Docker Hub and
                        deploy.
                    </p>
                </div>
            </div>

            <!-- Docker Images -->
            <div class="card" style="margin-top: 20px;">
                <div class="card-header">
                    <h3>Docker Images</h3>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Repository</th>
                                <th>Tag</th>
                                <th>ID</th>
                                <th>Size</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="docker-images-table"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê LXC Containers Page ‚ïê‚ïê‚ïê -->
        <div id="page-lxc" class="page-view" style="display:none;">
            <!-- LXC Runtime Status -->
            <div id="lxc-runtime-banner" class="card" style="margin-bottom: 20px;">
                <div class="card-body" style="display: flex; align-items: center; justify-content: space-between;">
                    <div>
                        <span style="font-size: 20px;">üì¶</span>
                        <strong>LXC</strong>
                        <span id="lxc-version" style="color: var(--text-muted); margin-left: 8px;"></span>
                        <span id="lxc-status-badge" class="badge" style="margin-left: 8px;">Checking...</span>
                    </div>
                    <button id="lxc-install-btn" class="btn btn-primary btn-sm" style="display:none;"
                        onclick="installRuntime('lxc')">
                        Install LXC
                    </button>
                </div>
            </div>

            <!-- LXC Containers List -->
            <div class="card">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>LXC Containers</h3>
                    <button class="btn btn-sm btn-primary" onclick="showLxcCreate()" style="font-size:12px;">+
                        Create Container</button>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>State</th>
                                <th>IP Address</th>
                                <th>CPU</th>
                                <th>Memory</th>
                                <th>Autostart</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="lxc-containers-table"></tbody>
                    </table>
                    <p id="lxc-empty" style="display:none; text-align:center; padding:20px; color: var(--text-muted);">
                        No LXC containers found. Click <strong>+ Create Container</strong> to browse available
                        templates.
                    </p>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Virtual Machines Page ‚ïê‚ïê‚ïê -->
        <div id="page-vms" class="page-view" style="display:none;">
            <div class="card">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>Virtual Machines (KVM/QEMU)</h3>
                    <button class="btn btn-sm btn-primary" onclick="showVmCreate()">+ Create VM</button>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Status</th>
                                <th>CPU/RAM</th>
                                <th>Disk</th>
                                <th>WolfNet IP</th>
                                <th>VNC</th>
                                <th>Autostart</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="vms-table"></tbody>
                    </table>
                    <p id="vms-empty" style="display:none; text-align:center; padding:20px; color: var(--text-muted);">
                        No virtual machines found. Click <strong>+ Create VM</strong> to start one.
                    </p>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê AI Agent Settings ‚ïê‚ïê‚ïê -->
        <div id="page-ai-settings" class="page-view" style="display:none;">
            <div class="card">
                <div class="card-header">
                    <h3>ü§ñ AI Agent Settings</h3>
                    <div style="font-size: 12px; color: var(--text-muted);">Configure your AI monitoring assistant</div>
                </div>
                <div class="card-body" style="padding:24px;">
                    <!-- Status Banner -->
                    <div id="ai-status-banner" style="padding:16px;border-radius:12px;margin-bottom:20px;
                         background:var(--bg-tertiary);border:1px solid var(--border);">
                        <div style="display:flex;align-items:center;gap:12px;">
                            <span style="font-size:32px;">üê∫</span>
                            <div>
                                <div style="font-weight:600;font-size:14px;" id="ai-status-text">Checking status...
                                </div>
                                <div style="font-size:12px;color:var(--text-muted);" id="ai-status-detail">Loading...
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">
                        <!-- Left Column: Provider & Keys -->
                        <div>
                            <h4 style="margin:0 0 16px 0;font-size:14px;color:var(--accent-light);">üîë LLM Provider</h4>
                            <div class="form-group" style="margin-bottom:16px;">
                                <label>Provider</label>
                                <select id="ai-provider" class="form-control" onchange="onAiProviderChange()">
                                    <option value="claude">Claude (Anthropic)</option>
                                    <option value="gemini">Gemini (Google)</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-bottom:16px;">
                                <label>Claude API Key</label>
                                <input type="password" id="ai-claude-key" class="form-control" placeholder="sk-ant-...">
                            </div>
                            <div class="form-group" style="margin-bottom:16px;">
                                <label>Gemini API Key</label>
                                <input type="password" id="ai-gemini-key" class="form-control" placeholder="AIza...">
                            </div>
                            <div class="form-group" style="margin-bottom:16px;">
                                <label>Model</label>
                                <select id="ai-model" class="form-control">
                                    <option value="">Select a provider and enter API key first</option>
                                </select>
                            </div>
                            <div class="form-group" style="margin-bottom:16px;">
                                <label>Health Check Interval</label>
                                <select id="ai-check-interval" class="form-control">
                                    <option value="15">Every 15 minutes</option>
                                    <option value="30">Every 30 minutes</option>
                                    <option value="60" selected>Every hour</option>
                                    <option value="360">Every 6 hours</option>
                                    <option value="1440">Daily</option>
                                </select>
                            </div>
                        </div>

                        <!-- Right Column: Email & Alerts -->
                        <div>
                            <h4 style="margin:0 0 16px 0;font-size:14px;color:var(--accent-light);">üìß Email Alerts</h4>
                            <div class="form-group" style="margin-bottom:16px;">
                                <label style="display:flex;align-items:center;gap:8px;">
                                    <input type="checkbox" id="ai-email-enabled"> Enable email alerts
                                </label>
                            </div>
                            <div id="ai-email-fields">
                                <div class="form-group" style="margin-bottom:12px;">
                                    <label>Send alerts to</label>
                                    <input type="email" id="ai-email-to" class="form-control"
                                        placeholder="admin@example.com">
                                </div>
                                <div class="form-group" style="margin-bottom:12px;">
                                    <label>SMTP Host</label>
                                    <input type="text" id="ai-smtp-host" class="form-control"
                                        placeholder="smtp.gmail.com">
                                </div>
                                <div class="form-group" style="margin-bottom:12px;">
                                    <label>SMTP Port</label>
                                    <input type="number" id="ai-smtp-port" class="form-control" value="587">
                                </div>
                                <div class="form-group" style="margin-bottom:12px;">
                                    <label>SMTP User</label>
                                    <input type="text" id="ai-smtp-user" class="form-control">
                                </div>
                                <div class="form-group" style="margin-bottom:12px;">
                                    <label>SMTP Password</label>
                                    <input type="password" id="ai-smtp-pass" class="form-control">
                                </div>
                            </div>

                            <h4 style="margin:20px 0 12px 0;font-size:14px;color:var(--accent-light);">üìä Recent Alerts
                            </h4>
                            <div id="ai-alerts-list" style="max-height:200px;overflow-y:auto;font-size:12px;">
                                <div style="color:var(--text-muted);padding:12px;">No alerts yet</div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top:20px;display:flex;gap:12px;">
                        <button class="btn btn-primary" onclick="saveAiConfig()">üíæ Save Settings</button>
                        <button class="btn btn-sm" onclick="testAiConnection()">üß™ Test Connection</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Storage Manager ‚ïê‚ïê‚ïê -->
        <div id="page-storage" class="page-view" style="display:none;">
            <div class="card">
                <div class="card-header"
                    style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px;">
                    <h3>üíæ Storage Manager</h3>
                    <div style="display:flex; gap:8px;">
                        <button class="btn btn-sm"
                            style="background:var(--bg-tertiary); color:var(--text-primary); border:1px solid var(--border);"
                            onclick="showImportRcloneModal()">üì• Import rclone.conf</button>
                        <button class="btn btn-sm btn-primary" onclick="showCreateMountModal()">+ Add Mount</button>
                    </div>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Source</th>
                                <th>Mount Point</th>
                                <th>Status</th>
                                <th>Options</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="storage-mounts-table"></tbody>
                    </table>
                    <p id="storage-empty"
                        style="display:none; text-align:center; padding:20px; color: var(--text-muted);">
                        No storage mounts configured. Click <strong>+ Add Mount</strong> to add S3, NFS, directory,
                        or WolfDisk storage.
                    </p>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê WolfNet Management ‚ïê‚ïê‚ïê -->
        <div id="page-wolfnet" class="page-view" style="display:none;">
            <!-- WolfNet Status Banner -->
            <div class="stats-grid" style="margin-bottom:20px;" id="wolfnet-stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Status</span>
                        <div class="stat-icon" id="wn-status-icon"
                            style="background:var(--success-bg); color:var(--success);">‚óè</div>
                    </div>
                    <div class="stat-value" id="wn-status-val">‚Äî</div>
                    <div class="stat-sub" id="wn-enabled-val"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Interface</span>
                    </div>
                    <div class="stat-value" id="wn-interface-val" style="font-size:18px;">‚Äî</div>
                    <div class="stat-sub" id="wn-ip-val"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Connected Peers</span>
                    </div>
                    <div class="stat-value" id="wn-connected-val">0</div>
                    <div class="stat-sub" id="wn-total-peers-val"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Actions</span>
                    </div>
                    <div class="stat-value" style="font-size:13px;">
                        <div style="display:flex; gap:6px; flex-wrap:wrap;">
                            <button class="btn btn-sm btn-success" onclick="wolfnetServiceAction('start')"
                                id="wn-btn-start">‚ñ∂ Start</button>
                            <button class="btn btn-sm" onclick="wolfnetServiceAction('restart')" id="wn-btn-restart"
                                style="background:var(--bg-tertiary); border:1px solid var(--border); color:var(--text-primary);">üîÑ
                                Restart</button>
                            <button class="btn btn-sm btn-danger" onclick="wolfnetServiceAction('stop')"
                                id="wn-btn-stop">‚èπ Stop</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Peers Table -->
            <div class="card" style="margin-bottom:20px;">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>üåê Peers</h3>
                    <div style="display:flex; gap:8px;">
                        <button class="btn btn-sm" onclick="loadWolfNet()"
                            style="background:var(--bg-tertiary); border:1px solid var(--border); color:var(--text-primary); font-size:11px;">‚Üª
                            Refresh</button>
                        <button class="btn btn-sm btn-primary" onclick="showAddPeerModal()" style="font-size:12px;">+
                            Add Peer</button>
                    </div>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>WolfNet IP</th>
                                <th>Endpoint</th>
                                <th>Status</th>
                                <th>Traffic</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="wolfnet-peers-table"></tbody>
                    </table>
                    <p id="wolfnet-peers-empty"
                        style="display:none; text-align:center; padding:20px; color:var(--text-muted);">
                        No peers configured. Click <strong>+ Add Peer</strong> to connect to another WolfNet node.
                    </p>
                </div>
            </div>


            <!-- Settings Cards -->
            <div class="card" style="margin-bottom:20px;">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>‚öôÔ∏è Network Settings</h3>
                    <button class="btn btn-primary btn-sm" onclick="saveWolfNetSettings()">üíæ Save &amp;
                        Restart</button>
                </div>
                <div class="card-body">
                    <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:16px;">
                        <div class="form-group">
                            <label
                                style="font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Interface</label>
                            <input type="text" id="wn-cfg-interface" class="form-control" placeholder="wolfnet0"
                                style="font-family:var(--font-mono); font-size:13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size:12px; color:var(--text-secondary); margin-bottom:4px;">WolfNet
                                IP Address</label>
                            <input type="text" id="wn-cfg-address" class="form-control" placeholder="10.10.10.1"
                                style="font-family:var(--font-mono); font-size:13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Subnet
                                Mask</label>
                            <input type="number" id="wn-cfg-subnet" class="form-control" value="24" min="8" max="30"
                                style="font-family:var(--font-mono); font-size:13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Listen
                                Port</label>
                            <input type="number" id="wn-cfg-port" class="form-control" value="9600"
                                style="font-family:var(--font-mono); font-size:13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size:12px; color:var(--text-secondary); margin-bottom:4px;">MTU</label>
                            <input type="number" id="wn-cfg-mtu" class="form-control" value="1400"
                                style="font-family:var(--font-mono); font-size:13px;">
                        </div>
                        <div class="form-group">
                            <label
                                style="font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Options</label>
                            <div style="display:flex; gap:12px; padding-top:6px;">
                                <label
                                    style="display:flex; align-items:center; gap:4px; font-size:12px; cursor:pointer;">
                                    <input type="checkbox" id="wn-cfg-gateway"> Gateway
                                </label>
                                <label
                                    style="display:flex; align-items:center; gap:4px; font-size:12px; cursor:pointer;">
                                    <input type="checkbox" id="wn-cfg-discovery" checked> Discovery
                                </label>
                            </div>
                        </div>
                    </div>
                    <div id="wn-node-identity"
                        style="margin-top:16px; padding:12px; background:var(--bg-primary); border:1px solid var(--border); border-radius:8px; display:none;">
                        <h4 style="font-size:12px; color:var(--text-secondary); margin-bottom:8px;">üîë This Node's
                            Identity</h4>
                        <div style="display:grid; grid-template-columns: auto 1fr; gap:4px 12px; font-size:12px;">
                            <span style="color:var(--text-muted);">Hostname:</span>
                            <span id="wn-local-hostname" style="font-family:var(--font-mono);"></span>
                            <span style="color:var(--text-muted);">Public Key:</span>
                            <span id="wn-local-pubkey"
                                style="font-family:var(--font-mono); word-break:break-all;"></span>
                        </div>
                    </div>
                    <details style="margin-top:16px;">
                        <summary style="cursor:pointer; font-size:12px; color:var(--text-muted); user-select:none;">
                            üìÑ Raw Configuration (/etc/wolfnet/config.toml)</summary>
                        <textarea id="wolfnet-config-editor" class="config-editor" spellcheck="false"
                            style="min-height:200px; margin-top:8px;"></textarea>
                    </details>
                </div>
            </div>
        </div>

        <!-- Add WolfNet Peer Modal -->
        <div class="modal-overlay" id="add-peer-modal">
            <div class="modal" style="max-width: 580px; width: 95%;">
                <div class="modal-header">
                    <h3>üîó Add WolfNet Peer</h3>
                    <button class="modal-close" onclick="closeAddPeerModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <!-- Mode tabs -->
                    <div
                        style="display:flex; gap:0; margin-bottom:20px; border:1px solid var(--border); border-radius:8px; overflow:hidden;">
                        <button id="peer-tab-lan" class="btn" onclick="setPeerMode('lan')"
                            style="flex:1; border:none; border-radius:0; font-size:13px; padding:10px; background:var(--accent-primary); color:white;">
                            üè† LAN Peer
                        </button>
                        <button id="peer-tab-internet" class="btn" onclick="setPeerMode('internet')"
                            style="flex:1; border:none; border-radius:0; font-size:13px; padding:10px; background:var(--bg-tertiary); color:var(--text-secondary);">
                            üåç Internet Peer
                        </button>
                    </div>

                    <!-- LAN Peer mode -->
                    <div id="peer-mode-lan">
                        <p style="font-size:13px; color:var(--text-secondary); margin-bottom:16px;">
                            Add a peer on your <strong>local network</strong>. Both machines must be able to reach
                            each other directly.
                            The peer will be auto-discovered if discovery is enabled.
                        </p>
                        <div class="form-group">
                            <label>Peer Name <span style="color:var(--danger)">*</span></label>
                            <input type="text" id="peer-name" class="form-control" placeholder="e.g. office-server">
                        </div>
                        <div class="form-group">
                            <label>WolfNet IP <span style="color:var(--danger)">*</span></label>
                            <input type="text" id="peer-ip" class="form-control" placeholder="e.g. 10.10.10.3">
                            <small style="color:var(--text-muted);">The peer's IP on the WolfNet overlay (e.g.
                                10.10.10.2, 10.10.10.3, etc.)</small>
                        </div>
                        <div class="form-group">
                            <label>Endpoint <small style="color:var(--text-muted);">(optional)</small></label>
                            <input type="text" id="peer-endpoint" class="form-control"
                                placeholder="e.g. 192.168.1.50:9600">
                            <small style="color:var(--text-muted);">Local IP:port ‚Äî leave empty for auto-discovery
                                on LAN</small>
                        </div>
                        <div class="form-group">
                            <label>Public Key <small style="color:var(--text-muted);">(optional)</small></label>
                            <input type="text" id="peer-public-key" class="form-control"
                                placeholder="base64 public key">
                            <small style="color:var(--text-muted);">If known, paste the peer's WolfNet public
                                key</small>
                        </div>
                    </div>

                    <!-- Internet Peer mode -->
                    <div id="peer-mode-internet" style="display:none;">
                        <p style="font-size:13px; color:var(--text-secondary); margin-bottom:16px;">
                            Connect a peer <strong>over the internet</strong>. Generate an invite token, then run
                            the join command on the remote machine.
                        </p>
                        <div id="invite-loading" style="text-align:center; padding:20px;">
                            <span style="font-size:24px;">‚è≥</span>
                            <p style="color:var(--text-muted); margin-top:8px;">Generating invite token...</p>
                        </div>
                        <div id="invite-result" style="display:none;">
                            <div
                                style="background:var(--bg-primary); border:1px solid var(--border); border-radius:8px; padding:16px; margin-bottom:16px;">
                                <div
                                    style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
                                    <span style="font-size:12px; font-weight:600; color:var(--text-secondary);">üìã
                                        Run this on the remote machine:</span>
                                    <button class="btn btn-sm" onclick="copyInviteCommand()" style="font-size:11px;">üìã
                                        Copy</button>
                                </div>
                                <pre id="invite-command"
                                    style="font-family:var(--font-mono); font-size:11px; white-space:pre-wrap; word-break:break-all; margin:0; color:var(--accent-primary); background:var(--bg-secondary); padding:10px; border-radius:6px;"></pre>
                            </div>
                            <div
                                style="background:rgba(59,130,246,0.08); border:1px solid rgba(59,130,246,0.2); border-radius:8px; padding:12px; margin-bottom:12px;">
                                <h4 style="font-size:12px; color:#3b82f6; margin-bottom:8px;">‚ÑπÔ∏è How it works</h4>
                                <ol
                                    style="font-size:12px; color:var(--text-secondary); margin:0; padding-left:16px; line-height:1.8;">
                                    <li>Copy the command above and run it on the remote machine</li>
                                    <li>It will output a <strong>reverse token</strong> ‚Äî copy that</li>
                                    <li>Run the reverse token command on <strong>this</strong> machine</li>
                                    <li>Restart WolfNet on both machines</li>
                                </ol>
                            </div>
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px; font-size:12px;">
                                <div style="padding:8px; background:var(--bg-tertiary); border-radius:6px;">
                                    <span style="color:var(--text-muted);">Your Public IP:</span><br>
                                    <strong id="invite-public-ip">‚Äî</strong>
                                </div>
                                <div style="padding:8px; background:var(--bg-tertiary); border-radius:6px;">
                                    <span style="color:var(--text-muted);">Your Endpoint:</span><br>
                                    <strong id="invite-endpoint">‚Äî</strong>
                                </div>
                            </div>
                        </div>
                        <div id="invite-error" style="display:none;">
                            <div
                                style="background:rgba(239,68,68,0.1); border:1px solid rgba(239,68,68,0.2); border-radius:8px; padding:16px; text-align:center;">
                                <span style="font-size:24px;">‚ùå</span>
                                <p id="invite-error-msg" style="color:#ef4444; margin-top:8px;"></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" id="peer-modal-footer-lan">
                    <button class="btn" onclick="closeAddPeerModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="addWolfNetPeer()">Add Peer</button>
                </div>
                <div class="modal-footer" id="peer-modal-footer-internet" style="display:none;">
                    <button class="btn btn-primary" onclick="closeAddPeerModal()">Done</button>
                </div>
            </div>
        </div>

        <!-- WolfNet Join Command Modal (shown after adding LAN peer) -->
        <div class="modal-overlay" id="wolfnet-join-modal">
            <div class="modal" style="max-width: 640px; width: 95%;">
                <div class="modal-header">
                    <h3>‚úÖ Peer Added ‚Äî Remote Setup</h3>
                    <button class="modal-close" onclick="closeJoinModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <p style="margin-bottom:12px; color:var(--text-secondary);">
                        The peer has been added to this node. Now configure the <strong>remote machine</strong>
                        to connect back. Add this to <code>/etc/wolfnet/config.toml</code> on the remote peer:
                    </p>
                    <div
                        style="background:var(--bg-primary); border:1px solid var(--border); border-radius:8px; padding:12px; margin-bottom:16px;">
                        <div
                            style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                            <span style="font-size:11px; color:var(--text-muted);">Peer config block for the remote
                                machine:</span>
                            <button class="btn btn-sm" onclick="copyJoinConfig()" style="font-size:11px;">üìã
                                Copy</button>
                        </div>
                        <pre id="wolfnet-join-config"
                            style="font-family:var(--font-mono); font-size:12px; white-space:pre-wrap; word-break:break-all; margin:0; color:var(--accent-primary);"></pre>
                    </div>
                    <p style="font-size:12px; color:var(--text-muted);">
                        Then run <code>sudo systemctl restart wolfnet</code> on the remote machine.
                    </p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" onclick="closeJoinModal()">Done</button>
                </div>
            </div>
        </div>



        <!-- ‚ïê‚ïê‚ïê Networking ‚ïê‚ïê‚ïê -->
        <div id="page-networking" class="page-view" style="display:none;">
            <!-- WolfNet Card -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header" style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>üîó WolfNet Overlay</h3>
                    <div id="wolfnet-actions"></div>
                </div>
                <div class="card-body" id="wolfnet-status-body">
                    <p style="color:var(--text-muted);">Loading WolfNet status...</p>
                </div>
            </div>

            <!-- Public IP Mappings Card -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header"
                    style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px;">
                    <h3>üåç Public IP Mappings</h3>
                    <button class="btn btn-sm btn-primary" onclick="showCreateMappingModal()" style="font-size:12px;">+
                        Add Mapping</button>
                </div>
                <div class="card-body">
                    <p style="font-size:12px; color:var(--text-muted); margin-bottom:12px;">
                        Map a public IP address to a WolfNet IP so containers, VMs, or LXC instances are reachable from
                        the internet.
                        WolfStack automatically manages the iptables DNAT/SNAT rules.
                    </p>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Public IP</th>
                                <th>‚Üí WolfNet IP</th>
                                <th>Ports</th>
                                <th>Protocol</th>
                                <th>Label</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ip-mappings-table"></tbody>
                    </table>
                    <p id="ip-mappings-empty"
                        style="display:none; text-align:center; padding:20px; color:var(--text-muted);">
                        No IP mappings configured. Click <strong>+ Add Mapping</strong> to route a public IP to a
                        WolfNet container or VM.
                    </p>
                </div>
            </div>

            <!-- Network Interfaces Card -->
            <div class="card" style="margin-bottom:16px;">
                <div class="card-header"
                    style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px;">
                    <h3>üåê Network Interfaces</h3>
                    <button class="btn btn-sm btn-primary" onclick="showCreateVlanModal()">+ Add VLAN</button>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Interface</th>
                                <th>State</th>
                                <th>Addresses</th>
                                <th>MAC</th>
                                <th>Speed</th>
                                <th>MTU</th>
                                <th>Driver</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="net-interfaces-table"></tbody>
                    </table>
                </div>
            </div>

            <!-- DNS Card -->
            <div class="card">
                <div class="card-header">
                    <h3>üî§ DNS Configuration</h3>
                </div>
                <div class="card-body" id="dns-config-body">
                    <p style="color:var(--text-muted);">Loading DNS configuration...</p>
                </div>
            </div>
        </div>

        <!-- Create VLAN Modal -->
        <div class="modal-overlay" id="create-vlan-modal">
            <div class="modal" style="max-width: 480px; width: 95%;">
                <div class="modal-header">
                    <h3>üè∑Ô∏è Create VLAN</h3>
                    <button class="modal-close" onclick="closeCreateVlanModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Parent Interface</label>
                        <select id="vlan-parent" class="form-control"></select>
                    </div>
                    <div class="form-group">
                        <label>VLAN ID</label>
                        <input type="number" id="vlan-id" class="form-control" min="1" max="4094"
                            placeholder="e.g. 100">
                    </div>
                    <div class="form-group">
                        <label>Name (optional ‚Äî defaults to parent.vlanid)</label>
                        <input type="text" id="vlan-name" class="form-control" placeholder="e.g. mgmt-vlan">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeCreateVlanModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="createVlan()">Create VLAN</button>
                </div>
            </div>
        </div>

        <!-- Add IP Modal -->
        <div class="modal-overlay" id="add-ip-modal">
            <div class="modal" style="max-width: 480px; width: 95%;">
                <div class="modal-header">
                    <h3>‚ûï Add IP Address</h3>
                    <button class="modal-close" onclick="closeAddIpModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="add-ip-interface">
                    <div class="form-group">
                        <label>Interface: <strong id="add-ip-iface-name"></strong></label>
                    </div>
                    <div class="form-group">
                        <label>IP Address</label>
                        <input type="text" id="add-ip-address" class="form-control" placeholder="e.g. 192.168.1.100">
                    </div>
                    <div class="form-group">
                        <label>Prefix Length (CIDR)</label>
                        <input type="number" id="add-ip-prefix" class="form-control" value="24" min="1" max="128">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeAddIpModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="addIpAddress()">Add IP</button>
                </div>
            </div>
        </div>

        <!-- Create IP Mapping Modal -->
        <div class="modal-overlay" id="create-mapping-modal">
            <div class="modal" style="max-width: 560px; width: 95%;">
                <div class="modal-header">
                    <h3>üåç Create IP Mapping</h3>
                    <button class="modal-close" onclick="closeCreateMappingModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div
                        style="background:rgba(59,130,246,0.08); border:1px solid rgba(59,130,246,0.2); border-radius:8px; padding:12px; margin-bottom:16px;">
                        <h4 style="font-size:12px; color:#3b82f6; margin-bottom:6px;">‚ÑπÔ∏è How it works</h4>
                        <p style="font-size:12px; color:var(--text-secondary); margin:0; line-height:1.6;">
                            This maps a <strong>public IP</strong> on this server to a
                            <strong>WolfNet IP</strong> belonging to a container, VM, or LXC instance.
                            All traffic arriving at the public IP will be forwarded to the WolfNet IP via iptables
                            NAT rules.
                        </p>
                    </div>

                    <div class="form-group">
                        <label>Public IP <span style="color:var(--danger)">*</span></label>
                        <div style="display:flex; gap:8px;">
                            <select id="mapping-public-ip-select" class="form-control"
                                onchange="onMappingPublicIpSelect()" style="flex:1;">
                                <option value="">‚Äî Select or enter manually ‚Äî</option>
                            </select>
                            <input type="text" id="mapping-public-ip" class="form-control"
                                placeholder="e.g. 203.0.113.4"
                                style="flex:1; font-family:var(--font-mono); font-size:13px;">
                        </div>
                        <small style="color:var(--text-muted);">A public IP assigned to this server. Auto-detected IPs
                            are shown in the dropdown.</small>
                    </div>

                    <div class="form-group">
                        <label>WolfNet IP <span style="color:var(--danger)">*</span></label>
                        <div style="display:flex; gap:8px;">
                            <select id="mapping-wolfnet-ip-select" class="form-control"
                                onchange="onMappingWolfnetIpSelect()" style="flex:1;">
                                <option value="">‚Äî Select or enter manually ‚Äî</option>
                            </select>
                            <input type="text" id="mapping-wolfnet-ip" class="form-control"
                                placeholder="e.g. 10.10.10.104"
                                style="flex:1; font-family:var(--font-mono); font-size:13px;">
                        </div>
                        <small style="color:var(--text-muted);">The WolfNet IP of the container, VM, or LXC instance
                            that should receive traffic.</small>
                    </div>

                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                        <div class="form-group">
                            <label>Ports <small style="color:var(--text-muted);">(optional)</small></label>
                            <input type="text" id="mapping-ports" class="form-control" placeholder="e.g. 80,443"
                                style="font-family:var(--font-mono); font-size:13px;">
                            <small style="color:var(--text-muted);">Leave blank = all ports</small>
                        </div>
                        <div class="form-group">
                            <label>Protocol</label>
                            <select id="mapping-protocol" class="form-control">
                                <option value="all">All (TCP + UDP)</option>
                                <option value="tcp">TCP only</option>
                                <option value="udp">UDP only</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Label <small style="color:var(--text-muted);">(optional)</small></label>
                        <input type="text" id="mapping-label" class="form-control"
                            placeholder="e.g. Web server, Game server">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeCreateMappingModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="createIpMapping()">Create Mapping</button>
                </div>
            </div>
        </div>

        <!-- Mount Progress Modal -->
        <div class="modal-overlay" id="mount-progress-modal">
            <div class="modal" style="max-width: 420px; width: 90%;">
                <div class="modal-header">
                    <h3 id="mount-progress-title">üíæ Mounting Storage</h3>
                </div>
                <div class="modal-body" style="text-align: center; padding: 32px 24px;">
                    <div id="mount-progress-spinner" style="font-size: 48px; margin-bottom: 16px;">‚è≥</div>
                    <div id="mount-progress-status" style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">
                        Connecting...</div>
                    <div id="mount-progress-detail"
                        style="font-size: 13px; color: var(--text-muted); word-break: break-word;"></div>
                </div>
                <div class="modal-footer" id="mount-progress-footer" style="display: none;">
                    <button class="btn btn-primary" onclick="closeMountProgress()">OK</button>
                </div>
            </div>
        </div>

        <!-- Create Storage Mount Modal -->
        <div class="modal-overlay" id="create-mount-modal">
            <div class="modal" style="max-width: 640px; width: 95%;">
                <div class="modal-header">
                    <h3>Add Storage Mount</h3>
                    <button class="modal-close" onclick="closeMountModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label>Name</label>
                            <input type="text" class="form-control" id="mount-name" placeholder="My S3 backup">
                        </div>
                        <div class="form-group">
                            <label>Type</label>
                            <select class="form-control" id="mount-type" onchange="onMountTypeChange()">
                                <option value="s3">‚òÅÔ∏è S3 / Object Storage</option>
                                <option value="nfs">üóÑÔ∏è NFS Share</option>
                                <option value="directory">üìÅ Directory (bind mount)</option>
                                <option value="wolfdisk">üê∫ WolfDisk</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Mount Point</label>
                            <input type="text" class="form-control" id="mount-point"
                                placeholder="/mnt/wolfstack/my-mount">
                            <small style="color:var(--text-muted); font-size:11px;">Leave blank for auto</small>
                        </div>

                        <!-- S3 Fields -->
                        <div id="s3-fields" style="grid-column: 1 / -1;">
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                                <div class="form-group">
                                    <label>Provider</label>
                                    <select class="form-control" id="s3-provider">
                                        <option value="AWS">Amazon S3</option>
                                        <option value="Cloudflare">Cloudflare R2</option>
                                        <option value="DigitalOcean">DigitalOcean Spaces</option>
                                        <option value="Wasabi">Wasabi</option>
                                        <option value="Backblaze">Backblaze B2</option>
                                        <option value="Minio">MinIO</option>
                                        <option value="Other">Other S3-compatible</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Bucket</label>
                                    <input type="text" class="form-control" id="s3-bucket" placeholder="my-bucket">
                                </div>
                                <div class="form-group">
                                    <label>Access Key ID</label>
                                    <input type="text" class="form-control" id="s3-access-key" placeholder="AKIA...">
                                </div>
                                <div class="form-group">
                                    <label>Secret Access Key</label>
                                    <input type="password" class="form-control" id="s3-secret-key" placeholder="secret">
                                </div>
                                <div class="form-group">
                                    <label>Region</label>
                                    <input type="text" class="form-control" id="s3-region" placeholder="us-east-1">
                                </div>
                                <div class="form-group">
                                    <label>Endpoint (optional)</label>
                                    <input type="text" class="form-control" id="s3-endpoint"
                                        placeholder="https://s3.example.com">
                                    <small style="color:var(--text-muted); font-size:11px;">For non-AWS
                                        providers</small>
                                </div>
                            </div>
                        </div>

                        <!-- NFS Fields -->
                        <div id="nfs-fields" style="grid-column: 1 / -1; display:none;">
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label>NFS Source</label>
                                    <input type="text" class="form-control" id="nfs-source"
                                        placeholder="192.168.1.100:/data/share">
                                    <small style="color:var(--text-muted); font-size:11px;">Format:
                                        server:/export/path</small>
                                </div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label>NFS Options</label>
                                    <input type="text" class="form-control" id="nfs-options" value="rw,soft,timeo=50"
                                        placeholder="rw,soft,timeo=50">
                                </div>
                            </div>
                        </div>

                        <!-- Directory Fields -->
                        <div id="dir-fields" style="grid-column: 1 / -1; display:none;">
                            <div class="form-group">
                                <label>Source Directory</label>
                                <input type="text" class="form-control" id="dir-source" placeholder="/data/shared">
                            </div>
                        </div>

                        <!-- WolfDisk Fields -->
                        <div id="wolfdisk-fields" style="grid-column: 1 / -1; display:none;">
                            <div class="form-group">
                                <label>WolfDisk Path</label>
                                <input type="text" class="form-control" id="wolfdisk-source"
                                    placeholder="/wolfdisk/data">
                                <small style="color:var(--text-muted); font-size:11px;">Path on the WolfDisk
                                    filesystem</small>
                            </div>
                        </div>

                        <!-- Global / Auto Mount options -->
                        <div class="form-group"
                            style="grid-column: 1 / -1; display:flex; gap:20px; padding-top:8px; border-top:1px solid var(--border);">
                            <label style="display:flex; align-items:center; gap:6px; cursor:pointer; font-size:13px;">
                                <input type="checkbox" id="mount-global"> üåê Global Mount
                                <small style="color:var(--text-muted); font-size:11px;">(replicate to all cluster
                                    nodes)</small>
                            </label>
                            <label style="display:flex; align-items:center; gap:6px; cursor:pointer; font-size:13px;">
                                <input type="checkbox" id="mount-auto" checked> ‚ö° Auto-mount on boot
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeMountModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="createStorageMount()">Create & Mount</button>
                </div>
            </div>
        </div>

        <!-- Import rclone.conf Modal -->
        <div class="modal-overlay" id="import-rclone-modal">
            <div class="modal" style="max-width: 600px; width: 95%;">
                <div class="modal-header">
                    <h3>üì• Import rclone.conf</h3>
                    <button class="modal-close" onclick="closeImportRcloneModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <p style="font-size:13px; color:var(--text-secondary); margin-bottom:12px;">
                        Paste your <code>rclone.conf</code> contents below. All S3-compatible remotes will be
                        imported as storage mounts.
                    </p>
                    <textarea id="rclone-config-paste" class="form-control" rows="12"
                        style="font-family: var(--font-mono); font-size:12px; resize:vertical;" placeholder="[myremote]
type = s3
provider = AWS
access_key_id = AKIA...
secret_access_key = ...
region = us-east-1"></textarea>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeImportRcloneModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="importRcloneConfig()">Import</button>
                </div>
            </div>
        </div>

        <!-- Edit Storage Mount Modal -->
        <div class="modal-overlay" id="edit-mount-modal">
            <div class="modal" style="max-width: 640px; width: 95%;">
                <div class="modal-header">
                    <h3>‚öôÔ∏è Edit Storage Mount</h3>
                    <button class="modal-close" onclick="closeEditMountModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="edit-mount-id">
                    <input type="hidden" id="edit-mount-type-value">
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label>Name</label>
                            <input type="text" class="form-control" id="edit-mount-name">
                        </div>
                        <div class="form-group">
                            <label>Type</label>
                            <input type="text" class="form-control" id="edit-mount-type-display" disabled
                                style="opacity:0.7; cursor:not-allowed;">
                        </div>
                        <div class="form-group">
                            <label>Mount Point</label>
                            <input type="text" class="form-control" id="edit-mount-point"
                                placeholder="/mnt/wolfstack/my-mount">
                        </div>

                        <!-- S3 Edit Fields -->
                        <div id="edit-s3-fields" style="grid-column: 1 / -1; display:none;">
                            <div
                                style="display:grid; grid-template-columns:1fr 1fr; gap:12px; padding:12px; background:var(--bg-secondary); border:1px solid var(--border); border-radius:8px;">
                                <div
                                    style="grid-column:1/-1; font-weight:600; font-size:13px; color:var(--text-primary); margin-bottom:4px;">
                                    ‚òÅÔ∏è S3 Configuration</div>
                                <div class="form-group">
                                    <label>Provider</label>
                                    <select class="form-control" id="edit-s3-provider">
                                        <option value="AWS">Amazon S3</option>
                                        <option value="Cloudflare">Cloudflare R2</option>
                                        <option value="DigitalOcean">DigitalOcean Spaces</option>
                                        <option value="Wasabi">Wasabi</option>
                                        <option value="Backblaze">Backblaze B2</option>
                                        <option value="Minio">MinIO</option>
                                        <option value="Other">Other S3-compatible</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Bucket</label>
                                    <input type="text" class="form-control" id="edit-s3-bucket" placeholder="my-bucket">
                                </div>
                                <div class="form-group">
                                    <label>Access Key ID</label>
                                    <input type="text" class="form-control" id="edit-s3-access-key"
                                        placeholder="AKIA...">
                                </div>
                                <div class="form-group">
                                    <label>Secret Access Key</label>
                                    <input type="password" class="form-control" id="edit-s3-secret-key"
                                        placeholder="Leave blank to keep unchanged">
                                </div>
                                <div class="form-group">
                                    <label>Region</label>
                                    <input type="text" class="form-control" id="edit-s3-region" placeholder="us-east-1">
                                </div>
                                <div class="form-group">
                                    <label>Endpoint (optional)</label>
                                    <input type="text" class="form-control" id="edit-s3-endpoint"
                                        placeholder="https://s3.example.com">
                                    <small style="color:var(--text-muted); font-size:11px;">For non-AWS
                                        providers</small>
                                </div>
                            </div>
                        </div>

                        <!-- NFS Edit Fields -->
                        <div id="edit-nfs-fields" style="grid-column: 1 / -1; display:none;">
                            <div
                                style="display:grid; grid-template-columns:1fr 1fr; gap:12px; padding:12px; background:var(--bg-secondary); border:1px solid var(--border); border-radius:8px;">
                                <div
                                    style="grid-column:1/-1; font-weight:600; font-size:13px; color:var(--text-primary); margin-bottom:4px;">
                                    üóÑÔ∏è NFS Configuration</div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label>NFS Source</label>
                                    <input type="text" class="form-control" id="edit-nfs-source"
                                        placeholder="192.168.1.100:/data/share">
                                    <small style="color:var(--text-muted); font-size:11px;">Format:
                                        server:/export/path</small>
                                </div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label>NFS Options</label>
                                    <input type="text" class="form-control" id="edit-nfs-options"
                                        placeholder="rw,soft,timeo=50">
                                </div>
                            </div>
                        </div>

                        <!-- Directory Edit Fields -->
                        <div id="edit-dir-fields" style="grid-column: 1 / -1; display:none;">
                            <div
                                style="padding:12px; background:var(--bg-secondary); border:1px solid var(--border); border-radius:8px;">
                                <div
                                    style="font-weight:600; font-size:13px; color:var(--text-primary); margin-bottom:8px;">
                                    üìÅ Directory Configuration</div>
                                <div class="form-group">
                                    <label>Source Directory</label>
                                    <input type="text" class="form-control" id="edit-dir-source"
                                        placeholder="/data/shared">
                                </div>
                            </div>
                        </div>

                        <!-- WolfDisk Edit Fields -->
                        <div id="edit-wolfdisk-fields" style="grid-column: 1 / -1; display:none;">
                            <div
                                style="padding:12px; background:var(--bg-secondary); border:1px solid var(--border); border-radius:8px;">
                                <div
                                    style="font-weight:600; font-size:13px; color:var(--text-primary); margin-bottom:8px;">
                                    üê∫ WolfDisk Configuration</div>
                                <div class="form-group">
                                    <label>WolfDisk Path</label>
                                    <input type="text" class="form-control" id="edit-wolfdisk-source"
                                        placeholder="/wolfdisk/data">
                                </div>
                            </div>
                        </div>

                        <!-- Global / Auto Mount options -->
                        <div class="form-group"
                            style="grid-column: 1 / -1; display:flex; gap:20px; padding-top:8px; border-top:1px solid var(--border);">
                            <label style="display:flex; align-items:center; gap:6px; cursor:pointer; font-size:13px;">
                                <input type="checkbox" id="edit-mount-global"> üåê Global Mount
                                <small style="color:var(--text-muted); font-size:11px;">(replicate to all cluster
                                    nodes)</small>
                            </label>
                            <label style="display:flex; align-items:center; gap:6px; cursor:pointer; font-size:13px;">
                                <input type="checkbox" id="edit-mount-auto"> ‚ö° Auto-mount on boot
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeEditMountModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="saveStorageMountEdit()">üíæ Save Changes</button>
                </div>
            </div>
        </div>


        <div class="modal-overlay" id="create-vm-modal">
            <div class="modal" style="max-width: 720px; width: 95%;">
                <div class="modal-header">
                    <h3>Create Virtual Machine</h3>
                    <button class="modal-close" onclick="closeVmCreate()">&times;</button>
                </div>
                <!-- Tab Nav -->
                <div style="display:flex; border-bottom:1px solid var(--border); background:var(--bg-secondary);">
                    <button class="vm-tab-btn active" data-tab="1" onclick="switchVmTab(1)"
                        style="flex:1; padding:10px 16px; border:none; background:none; color:var(--text-primary); font-size:13px; font-weight:600; cursor:pointer; border-bottom:2px solid transparent; transition:all .2s;">
                        <span style="margin-right:4px;">‚öôÔ∏è</span> General
                    </button>
                    <button class="vm-tab-btn" data-tab="2" onclick="switchVmTab(2)"
                        style="flex:1; padding:10px 16px; border:none; background:none; color:var(--text-muted); font-size:13px; font-weight:600; cursor:pointer; border-bottom:2px solid transparent; transition:all .2s;">
                        <span style="margin-right:4px;">üíæ</span> Disks
                    </button>
                    <button class="vm-tab-btn" data-tab="3" onclick="switchVmTab(3)"
                        style="flex:1; padding:10px 16px; border:none; background:none; color:var(--text-muted); font-size:13px; font-weight:600; cursor:pointer; border-bottom:2px solid transparent; transition:all .2s;">
                        <span style="margin-right:4px;">üåê</span> Network &amp; Boot
                    </button>
                </div>
                <div class="modal-body" style="min-height:280px;">
                    <!-- ‚ïê‚ïê‚ïê Tab 1: General ‚ïê‚ïê‚ïê -->
                    <div class="vm-tab-page" id="vm-tab-1">
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
                            <div class="form-group" style="grid-column: 1 / -1;">
                                <label>Name</label>
                                <input type="text" class="form-control" id="new-vm-name" placeholder="my-vm">
                            </div>
                            <div class="form-group">
                                <label>CPUs</label>
                                <input type="number" class="form-control" id="new-vm-cpus" value="1" min="1">
                            </div>
                            <div class="form-group">
                                <label>Memory (MB)</label>
                                <input type="number" class="form-control" id="new-vm-memory" value="1024" min="256">
                            </div>
                        </div>
                    </div>

                    <!-- ‚ïê‚ïê‚ïê Tab 2: Disks ‚ïê‚ïê‚ïê -->
                    <div class="vm-tab-page" id="vm-tab-2" style="display:none;">
                        <!-- OS Disk (always present) -->
                        <div
                            style="padding:10px; background:var(--bg-secondary); border:1px solid var(--border); border-radius:8px; margin-bottom:8px;">
                            <div style="display:flex; align-items:center; gap:8px; margin-bottom:8px;">
                                <span
                                    style="font-weight:600; font-size:13px; color:var(--accent-light); min-width:60px;">OS
                                    Disk</span>
                                <span style="font-size:11px; color:var(--text-muted);">Primary boot disk
                                    (virtio)</span>
                            </div>
                            <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:8px;">
                                <div>
                                    <label
                                        style="display:block; font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Storage</label>
                                    <select id="new-vm-storage" class="form-control" style="font-size:13px;">
                                        <option value="">/var/lib/wolfstack/vms (default)</option>
                                    </select>
                                </div>
                                <div>
                                    <label
                                        style="display:block; font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Disk
                                        Size (GiB)</label>
                                    <input type="number" class="form-control" id="new-vm-disk" value="32" min="1"
                                        style="font-size:13px;">
                                </div>
                                <div>
                                    <label
                                        style="display:block; font-size:12px; color:var(--text-secondary); margin-bottom:4px;">Bus</label>
                                    <select id="new-vm-os-bus" class="form-control" style="font-size:13px;">
                                        <option value="virtio" selected>VirtIO (fastest)</option>
                                        <option value="ide">IDE (Windows compatible)</option>
                                        <option value="sata">SATA</option>
                                    </select>
                                </div>
                            </div>
                            <div id="vm-bus-warning"
                                style="display:none; margin-top:6px; padding:6px 10px; background:var(--warning-bg, rgba(245,158,11,0.1)); border:1px solid var(--warning, #f59e0b); border-radius:6px; font-size:11px; color:var(--warning, #f59e0b);">
                                ‚ö†Ô∏è Windows doesn't include VirtIO drivers. Use <strong>IDE</strong> for Windows, or
                                attach VirtIO drivers ISO on the Boot tab.
                            </div>
                        </div>

                        <!-- Extra Disks Container (scrollable) -->
                        <div id="vm-extra-disks-container" style="max-height:240px; overflow-y:auto;"></div>

                        <button class="btn btn-sm" onclick="addVmDiskRow()"
                            style="margin-top:8px; font-size:12px; display:flex; align-items:center; gap:4px;">
                            ‚ûï Add Disk
                        </button>
                    </div>

                    <!-- ‚ïê‚ïê‚ïê Tab 3: Network & Boot ‚ïê‚ïê‚ïê -->
                    <div class="vm-tab-page" id="vm-tab-3" style="display:none;">
                        <div class="form-group">
                            <label>Installation ISO (Optional)</label>
                            <input type="text" class="form-control" id="new-vm-iso"
                                placeholder="/var/lib/wolfstack/isos/ubuntu.iso">
                            <small style="color:var(--text-muted);">Path to an OS installer ISO on the host</small>
                        </div>
                        <div class="form-group" style="margin-top:12px;">
                            <label>VirtIO Drivers ISO (Optional)</label>
                            <input type="text" class="form-control" id="new-vm-drivers-iso"
                                placeholder="/var/lib/wolfstack/isos/virtio-win.iso">
                            <small style="color:var(--text-muted);">Needed for Windows to see VirtIO disks. Download
                                from
                                <a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/virtio-win.iso"
                                    target="_blank" style="color:var(--accent-light);">fedorapeople.org</a></small>
                        </div>
                        <div class="form-group" style="margin-top:12px;">
                            <label>Network Adapter</label>
                            <select id="new-vm-net-model" class="form-control" style="font-size:13px;">
                                <option value="virtio">VirtIO (fastest, Linux)</option>
                                <option value="e1000">Intel e1000 (Windows compatible)</option>
                                <option value="rtl8139">Realtek RTL8139</option>
                            </select>
                            <small style="color:var(--text-muted);">Windows needs Intel e1000 ‚Äî VirtIO network
                                requires drivers</small>
                        </div>
                        <div class="form-group" style="margin-top:12px;">
                            <label>WolfNet IP (Optional)</label>
                            <input type="text" class="form-control" id="new-vm-wolfnet-ip"
                                placeholder="Auto-assign or e.g. 10.10.10.120">
                            <small style="color:var(--text-muted);">Leave blank for user-mode networking, or enter
                                an IP for WolfNet TAP networking</small>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="display:flex; justify-content:space-between;">
                    <div>
                        <button class="btn" id="vm-tab-back-btn" onclick="switchVmTab('prev')" style="display:none;">‚Üê
                            Back</button>
                    </div>
                    <div style="display:flex; gap:8px;">
                        <button class="btn" onclick="closeVmCreate()">Cancel</button>
                        <button class="btn btn-primary" id="vm-tab-next-btn" onclick="switchVmTab('next')">Next
                            ‚Üí</button>
                        <button class="btn btn-primary" id="vm-tab-create-btn" onclick="createVm()"
                            style="display:none;">Create</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚ïê‚ïê‚ïê Container Detail Modal ‚ïê‚ïê‚ïê -->
        <div class="modal-overlay" id="container-detail-modal">
            <div class="modal" style="max-width: 960px; width: 95%;">
                <div class="modal-header">
                    <h3 id="container-detail-title">Container Detail</h3>
                    <button class="modal-close" onclick="closeContainerDetail()">&times;</button>
                </div>
                <div class="modal-body" id="container-detail-body">
                </div>
            </div>
        </div>
        </div>
    </main>

    <!-- Add Server Modal -->
    <div class="modal-overlay" id="add-server-modal">
        <div class="modal">
            <div class="modal-header">
                <h3>Add Server</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Server Address</label>
                    <input type="text" class="form-control" id="new-server-address"
                        placeholder="10.10.10.1 or hostname">
                </div>
                <div class="form-group">
                    <label>Port (default: 8553)</label>
                    <input type="number" class="form-control" id="new-server-port" value="8553">
                </div>
                <p style="font-size: 12px; color: var(--text-muted);">
                    If using WolfNet, enter the WolfNet IP (e.g. 10.10.10.x).
                    Otherwise, enter the server's regular IP or hostname.
                </p>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeModal()">Cancel</button>
                <button class="btn btn-primary" onclick="addServer()">Add Server</button>
            </div>
        </div>
        <!-- Console Modal -->
        <div id="console-modal"
            style="position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);z-index:9999;display:none;align-items:center;justify-content:center;">
            <div
                style="width:90%;max-width:960px;height:80vh;display:flex;flex-direction:column;background:var(--bg-card,#1a1a2e);border:1px solid var(--border,#333);border-radius:12px;overflow:hidden;box-shadow:0 25px 50px rgba(0,0,0,0.5);">
                <div
                    style="padding:12px 20px;border-bottom:1px solid var(--border,#333);display:flex;align-items:center;justify-content:space-between;background:var(--bg-secondary,#16162a);">
                    <h3 id="console-title" style="margin:0;font-size:15px;">üíª Console</h3>
                    <button onclick="closeConsole()"
                        style="background:none;border:none;color:var(--text-primary,#fff);font-size:24px;cursor:pointer;padding:0 8px;">&times;</button>
                </div>
                <div style="flex:1;padding:4px;background:#0a0a0a;overflow:hidden;">
                    <div id="terminal-container" style="width:100%;height:100%;"></div>
                </div>
            </div>
        </div>

        <!-- Toast Container -->
        <div class="toast-container" id="toast-container"></div>

        <script src="/js/app.js"></script>
        <script>
            // Check auth on page load
            fetch('/api/auth/check')
                .then(r => r.json())
                .then(data => {
                    if (!data.authenticated) {
                        window.location.href = '/login.html';
                    }
                })
                .catch(() => {
                    window.location.href = '/login.html';
                });

            async function handleLogout() {
                await fetch('/api/auth/logout', { method: 'POST' });
                window.location.href = '/login.html';
            }
        </script>
        <!-- AI Chat Bubble -->
        <div id="ai-chat-bubble" onclick="toggleAiChat()" title="Chat with AI Assistant" style="position:fixed;bottom:24px;right:24px;width:56px;height:56px;border-radius:50%;
                background:linear-gradient(135deg,var(--accent),var(--accent-light));color:#fff;
                display:flex;align-items:center;justify-content:center;font-size:28px;
                cursor:pointer;z-index:9999;box-shadow:0 4px 20px rgba(0,0,0,0.4);
                transition:transform 0.2s,box-shadow 0.2s;">
            üê∫
        </div>

        <!-- AI Chat Panel -->
        <div id="ai-chat-panel" style="display:none;position:fixed;bottom:90px;right:24px;width:420px;height:540px;
         background:var(--bg-secondary);border:1px solid var(--border);border-radius:16px;
         box-shadow:0 8px 40px rgba(0,0,0,0.5);z-index:9998;overflow:hidden;
         flex-direction:column;">
            <!-- Header -->
            <div style="padding:16px 20px;background:linear-gradient(135deg,var(--accent),var(--accent-light));
             display:flex;justify-content:space-between;align-items:center;">
                <div style="display:flex;align-items:center;gap:8px;">
                    <span style="font-size:24px;">üê∫</span>
                    <div>
                        <div style="font-weight:600;color:#fff;font-size:14px;">WolfStack AI</div>
                        <div id="ai-chat-status" style="font-size:11px;color:rgba(255,255,255,0.7);">Ready</div>
                    </div>
                </div>
                <div style="display:flex;gap:6px;">
                    <button onclick="openAiSettings()"
                        style="background:rgba(255,255,255,0.2);border:none;color:#fff;border-radius:8px;padding:6px 10px;cursor:pointer;font-size:12px;"
                        title="AI Settings">‚öôÔ∏è</button>
                    <button onclick="toggleAiChat()"
                        style="background:rgba(255,255,255,0.2);border:none;color:#fff;border-radius:8px;padding:6px 10px;cursor:pointer;font-size:16px;"
                        title="Close">‚úï</button>
                </div>
            </div>
            <!-- Messages -->
            <div id="ai-chat-messages"
                style="flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:12px;">
                <div class="ai-msg ai-msg-assistant"
                    style="background:var(--bg-tertiary);border-radius:12px;padding:12px 16px;max-width:85%;align-self:flex-start;font-size:13px;line-height:1.5;color:var(--text);">
                    üëã Hi! I'm your WolfStack AI assistant. I know everything about WolfStack, WolfNet, WolfDisk,
                    WolfProxy, and WolfServe. Ask me anything about your servers or need help troubleshooting?
                </div>
            </div>
            <!-- Input -->
            <div style="padding:12px 16px;border-top:1px solid var(--border);display:flex;gap:8px;">
                <input type="text" id="ai-chat-input" placeholder="Ask something..."
                    onkeydown="if(event.key==='Enter')sendAiMessage()" style="flex:1;padding:10px 14px;border-radius:10px;border:1px solid var(--border);
                          background:var(--bg-primary);color:var(--text);font-size:13px;outline:none;">
                <button onclick="sendAiMessage()" id="ai-send-btn" style="padding:10px 16px;border-radius:10px;border:none;
                           background:var(--accent);color:#fff;cursor:pointer;font-size:13px;font-weight:600;
                           transition:opacity 0.2s;">Send</button>
            </div>
        </div>

</body>

</html>